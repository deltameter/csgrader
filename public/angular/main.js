!function(){angular.module("courses",[])}(),function(){angular.module("general",[])}(),function(){angular.module("user",[]).run(["$http","Session",function($http,Session){$http.get("/api/profile").success(function(res){Session.create(res)}).error(function(res){Session.setCurrentUser({})})}])}(),angular.module("angularSlideables",[]).directive("slideable",function(){return{restrict:"C",compile:function(element,attr){var contents=element.html();return element.html('<div class="slideable_content" style="margin:0 !important; padding:0 !important" >'+contents+"</div>"),function(scope,element,attrs){attrs.duration=attrs.duration?attrs.duration:"1s",attrs.easing=attrs.easing?attrs.easing:"ease-in-out",element.css({overflow:"hidden",height:"0px",transitionProperty:"height",transitionDuration:attrs.duration,transitionTimingFunction:attrs.easing})}}}}).directive("slideToggle",function(){return{restrict:"A",link:function(scope,element,attrs){var target,content;attrs.expanded=!1,element.bind("click",function(){if(target||(target=document.querySelector(attrs.slideToggle)),content||(content=target.querySelector(".slideable_content")),attrs.expanded)target.style.height="0px";else{content.style.border="1px solid rgba(0,0,0,0)";var y=content.clientHeight;content.style.border=0,target.style.height=y+"px"}attrs.expanded=!attrs.expanded})}}}),function(){var app=angular.module("grader",["ui.router","general","courses","user"]);app.config(["$locationProvider",function($locationProvider){$locationProvider.html5Mode(!0)}]),app.run(["$rootScope","AuthService","AuthResolver",function($rootScope,AuthService,AuthResolver){$rootScope.$on("$stateChangeStart",function(event,next){AuthResolver.bIsResolved()?(console.log("stateChangeStart resolved"),console.log("auth: "+AuthService.isAuthenticated())):AuthResolver.resolve().then(function(data){console.log("stateChangeStart not resolved"),console.log("auth: "+AuthService.isAuthenticated())})})}])}(),function(){angular.module("user").controller("DashboardController",["$state","$http","CourseService","Session",function($state,$http,CourseService,Session){var root=this;this.newCourse={},this.courses=null,this.user=Session.user;var getCourses=function(){CourseService.getCourses().then(function(res){root.courses=res.data},function(res){})};this.createCourse=function(){CourseService.createCourse(root.newCourse).then(function(res){console.log(res)})},getCourses()}]),angular.module("user").controller("CourseController",["$state","$http","$stateParams","CourseService","Session",function($state,$http,$stateParams,CourseService,Session){var root=this;this.course=null,root.user=Session.user,this.newAssignment={};var getCourse=function(){CourseService.getCourse($stateParams.courseCode).then(function(res){console.log(res),root.course=res.data,root.newAssignment.courseID=res.data._id},function(res){})};this.createAssignment=function(){CourseService.createAssignment($stateParams.courseCode,root.newAssignment).then(function(res){console.log(res)},function(res){})},getCourse()}])}(),function(){angular.module("user").config(["$stateProvider",function($stateProvider){$stateProvider.state("root.main.dashboard",{templateUrl:"/angular/courses/partials/dashboard.html",controller:"DashboardController",controllerAs:"dashboardCtrl"}),$stateProvider.state("root.course",{url:"/course/:courseCode",templateUrl:"/angular/courses/partials/course.html",controller:"CourseController",controllerAs:"courseCtrl"})}])}(),function(){angular.module("courses").factory("CourseService",["$http",function($http){return this.createCourse=function(newCourse){return $http.post("/api/course/create",newCourse)},this.getCourses=function(){return $http.get("/api/profile/courses")},this.getCourse=function(courseCode){return $http.get("/api/course/"+courseCode)},this.createAssignment=function(courseCode,newAssignment){return console.log("hello"),$http.post("/api/course/"+courseCode+"/assignment/create",newAssignment)},this}])}(),function(){angular.module("general").controller("NavController",["$http","AuthService","AuthResolver","$state",function($http,AuthService,AuthResolver,$state){var root=this;this.$state=$state,this.bLoggedIn=null,AuthResolver.bIsResolved()?root.bLoggedIn=AuthService.isAuthenticated():AuthResolver.resolve().then(function(){root.bLoggedIn=AuthService.isAuthenticated()})}])}(),function(){angular.module("general").config(["$stateProvider",function($stateProvider){$stateProvider.state("root",{"abstract":!0,template:"<ui-view/>",resolve:{auth:["AuthResolver",function(AuthResolver){return AuthResolver.bIsResolved()===!0||AuthResolver.resolve()}]}}).state("root.main",{url:"/",template:"<ui-view/>",controller:["$state","AuthService",function($state,AuthService){AuthService.isAuthenticated()?$state.go("root.main.dashboard"):$state.go("root.main.public")}]}).state("root.main.public",{templateUrl:"/angular/general/partials/index.html",controller:function(){console.log("Hit public index")}})}])}(),function(){angular.module("user").controller("LoginController",["$state","$rootScope","AuthService",function($state,$rootScope,AuthService){var root=this;this.authMessage="",this.user={email:"",password:""},this.login=function(){AuthService.login(root.user).then(function(res){$state.go("root.main")},function(res){root.authMessage=res.data.userMessage})}}]),angular.module("user").controller("JoinController",["$state","$rootScope","AuthService",function($state,$rootScope,AuthService){var root=this;this.authMessage="",this.user={firstName:"",lastName:"",retypePassword:"",password:"",email:"",accountType:""},this.signup=function(){AuthService.signup(root.user).then(function(res){$state.go("root.main")},function(res){root.authMessage=res.data.userMessage})}}]),angular.module("user").controller("ProfileController",["$state","Session",function($state,Session){this.user=Session.user}])}(),function(){angular.module("user").config(["$stateProvider",function($stateProvider){$stateProvider.state("root.login",{url:"/login",templateUrl:"/angular/user/partials/login.html",controller:"LoginController",controllerAs:"loginCtrl"}),$stateProvider.state("root.join",{url:"/join",templateUrl:"/angular/user/partials/join.html",controller:"JoinController",controllerAs:"joinCtrl"}),$stateProvider.state("root.profile",{url:"/profile",templateUrl:"/angular/user/partials/profile.html",controller:"ProfileController",controllerAs:"profileCtrl"})}])}(),function(){angular.module("user").factory("AuthService",["$http","Session",function($http,Session){var authService={};return authService.login=function(credentials){return $http.post("/auth/local",credentials).then(function(res){return Session.create(res.data),res.data})},authService.signup=function(newUser){return $http.post("/api/user/join",newUser).then(function(res){return console.log(res.data),Session.create(res.data),res.data},function(res){return res.data})},authService.isAuthenticated=function(){return Session.live()},authService}]),angular.module("user").service("Session",["$rootScope",function($rootScope){var root=this;this.user={},this.live=function(){return Object.keys(root.user).length>0},this.setCurrentUser=function(user){$rootScope.currentUser=user,root.user=user},this.create=function(user){$rootScope.currentUser=user,root.user=user},this.destroy=function(){$rootScope.currentUser=null,root.user=null}}]),angular.module("user").factory("AuthResolver",["$q","$rootScope","$state",function($q,$rootScope,$state){var bIsResolved=!1;return{resolve:function(){var deferred=$q.defer(),unwatch=$rootScope.$watch("currentUser",function(currentUser){angular.isDefined(currentUser)&&(currentUser?deferred.resolve(currentUser):deferred.reject(),bIsResolved=!0,unwatch())});return deferred.promise},bIsResolved:function(){return bIsResolved}}}])}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvdXJzZXMvY291cnNlcy5tb2R1bGUuanMiLCJnZW5lcmFsL2dlbmVyYWwubW9kdWxlLmpzIiwidXNlci91c2VyLm1vZHVsZS5qcyIsIm1pc2Mvc2xpZGVhYmxlLm1vZHVsZS5qcyIsImNvcmUuanMiLCJjb3Vyc2VzL2NvdXJzZXMuY3RybC5qcyIsIm1haW4uanMiLCJjb3Vyc2VzL2NvdXJzZXMuc3RhdGVzLmpzIiwiY291cnNlcy9jb3Vyc2VzLnN2Yy5qcyIsImdlbmVyYWwvZ2VuZXJhbC5jdHJsLmpzIiwiZ2VuZXJhbC9nZW5lcmFsLnN0YXRlcy5qcyIsInVzZXIvdXNlci5jdHJsLmpzIiwidXNlci91c2VyLnN0YXRlcy5qcyIsInVzZXIvdXNlci5zdmMuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsInJ1biIsIiRodHRwIiwiU2Vzc2lvbiIsImdldCIsInN1Y2Nlc3MiLCJyZXMiLCJjcmVhdGUiLCJlcnJvciIsInNldEN1cnJlbnRVc2VyIiwiZGlyZWN0aXZlIiwicmVzdHJpY3QiLCJjb21waWxlIiwiZWxlbWVudCIsImF0dHIiLCJjb250ZW50cyIsImh0bWwiLCJzY29wZSIsImF0dHJzIiwiZHVyYXRpb24iLCJlYXNpbmciLCJjc3MiLCJvdmVyZmxvdyIsImhlaWdodCIsInRyYW5zaXRpb25Qcm9wZXJ0eSIsInRyYW5zaXRpb25EdXJhdGlvbiIsInRyYW5zaXRpb25UaW1pbmdGdW5jdGlvbiIsImxpbmsiLCJ0YXJnZXQiLCJjb250ZW50IiwiZXhwYW5kZWQiLCJiaW5kIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwic2xpZGVUb2dnbGUiLCJzdHlsZSIsImJvcmRlciIsInkiLCJjbGllbnRIZWlnaHQiLCJhcHAiLCJjb25maWciLCIkbG9jYXRpb25Qcm92aWRlciIsImh0bWw1TW9kZSIsIiRyb290U2NvcGUiLCJBdXRoU2VydmljZSIsIkF1dGhSZXNvbHZlciIsIiRvbiIsImV2ZW50IiwibmV4dCIsImJJc1Jlc29sdmVkIiwiY29uc29sZSIsImxvZyIsImlzQXV0aGVudGljYXRlZCIsInJlc29sdmUiLCJ0aGVuIiwiZGF0YSIsImNvbnRyb2xsZXIiLCIkc3RhdGUiLCJDb3Vyc2VTZXJ2aWNlIiwicm9vdCIsInRoaXMiLCJuZXdDb3Vyc2UiLCJjb3Vyc2VzIiwidXNlciIsImdldENvdXJzZXMiLCJjcmVhdGVDb3Vyc2UiLCIkc3RhdGVQYXJhbXMiLCJjb3Vyc2UiLCJuZXdBc3NpZ25tZW50IiwiZ2V0Q291cnNlIiwiY291cnNlQ29kZSIsImNvdXJzZUlEIiwiX2lkIiwiY3JlYXRlQXNzaWdubWVudCIsIiRzdGF0ZVByb3ZpZGVyIiwic3RhdGUiLCJ0ZW1wbGF0ZVVybCIsImNvbnRyb2xsZXJBcyIsInVybCIsImZhY3RvcnkiLCJwb3N0IiwiYkxvZ2dlZEluIiwiYWJzdHJhY3QiLCJ0ZW1wbGF0ZSIsImF1dGgiLCJnbyIsImF1dGhNZXNzYWdlIiwiZW1haWwiLCJwYXNzd29yZCIsImxvZ2luIiwidXNlck1lc3NhZ2UiLCJmaXJzdE5hbWUiLCJsYXN0TmFtZSIsInJldHlwZVBhc3N3b3JkIiwiYWNjb3VudFR5cGUiLCJzaWdudXAiLCJhdXRoU2VydmljZSIsImNyZWRlbnRpYWxzIiwibmV3VXNlciIsImxpdmUiLCJzZXJ2aWNlIiwiT2JqZWN0Iiwia2V5cyIsImxlbmd0aCIsImN1cnJlbnRVc2VyIiwiZGVzdHJveSIsIiRxIiwiZGVmZXJyZWQiLCJkZWZlciIsInVud2F0Y2giLCIkd2F0Y2giLCJpc0RlZmluZWQiLCJyZWplY3QiLCJwcm9taXNlIl0sIm1hcHBpbmdzIjoiQ0FBQSxXQUNBQSxRQUFBQyxPQUFBLGlCQ0RBLFdBQ0FELFFBQUFDLE9BQUEsaUJDREEsV0FDQUQsUUFBQUMsT0FBQSxXQUNBQyxLQUFBLFFBQUEsVUFBQSxTQUFBQyxNQUFBQyxTQUNBRCxNQUFBRSxJQUFBLGdCQUNBQyxRQUFBLFNBQUFDLEtBQ0FILFFBQUFJLE9BQUFELE9BRUFFLE1BQUEsU0FBQUYsS0FDQUgsUUFBQU0sMkJDUkFWLFFBQUFDLE9BQUEsd0JB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LGdCQUFBLEtBQUEsYUFBQSxTQUFBLFNBQUEyQixHQUFBL0QsV0FBQWMsUUFDQSxHQUFBUixjQUFBLENBRUEsUUFDQUksUUFBQSxXQUNBLEdBQUFzRCxVQUFBRCxHQUFBRSxRQUNBQyxRQUFBbEUsV0FBQW1FLE9BQUEsY0FBQSxTQUFBTixhQUNBekcsUUFBQWdILFVBQUFQLGVBQ0FBLFlBQ0FHLFNBQUF0RCxRQUFBbUQsYUFFQUcsU0FBQUssU0FFQS9ELGFBQUEsRUFDQTRELFlBR0EsT0FBQUYsVUFBQU0sU0FHQWhFLFlBQUEsV0FDQSxNQUFBQSIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7XHJcblx0dmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdjb3Vyc2VzJywgW10pO1xyXG59KSgpOyIsIihmdW5jdGlvbigpe1xyXG5cdHZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnZ2VuZXJhbCcsIFtdKTtcclxufSkoKTsiLCIoZnVuY3Rpb24oKXtcclxuXHR2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ3VzZXInLCBbXSlcclxuXHQucnVuKGZ1bmN0aW9uKCRodHRwLCBTZXNzaW9uKXtcclxuXHRcdCRodHRwLmdldCgnL2FwaS9wcm9maWxlJylcclxuXHRcdC5zdWNjZXNzKGZ1bmN0aW9uKHJlcyl7XHJcblx0XHRcdFNlc3Npb24uY3JlYXRlKHJlcyk7XHJcblx0XHR9KVxyXG5cdFx0LmVycm9yKGZ1bmN0aW9uKHJlcyl7XHJcblx0XHRcdFNlc3Npb24uc2V0Q3VycmVudFVzZXIoe30pO1xyXG5cdFx0fSk7XHJcblx0fSk7XHJcbn0pKCk7IiwiYW5ndWxhci5tb2R1bGUoJ2FuZ3VsYXJTbGlkZWFibGVzJywgW10pXHJcbi5kaXJlY3RpdmUoJ3NsaWRlYWJsZScsIGZ1bmN0aW9uICgpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgcmVzdHJpY3Q6J0MnLFxyXG4gICAgICAgIGNvbXBpbGU6IGZ1bmN0aW9uIChlbGVtZW50LCBhdHRyKSB7XHJcbiAgICAgICAgICAgIC8vIHdyYXAgdGFnXHJcbiAgICAgICAgICAgIHZhciBjb250ZW50cyA9IGVsZW1lbnQuaHRtbCgpO1xyXG4gICAgICAgICAgICBlbGVtZW50Lmh0bWwoJzxkaXYgY2xhc3M9XCJzbGlkZWFibGVfY29udGVudFwiIHN0eWxlPVwibWFyZ2luOjAgIWltcG9ydGFudDsgcGFkZGluZzowICFpbXBvcnRhbnRcIiA+JyArIGNvbnRlbnRzICsgJzwvZGl2PicpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIHBvc3RMaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xyXG4gICAgICAgICAgICAgICAgLy8gZGVmYXVsdCBwcm9wZXJ0aWVzXHJcbiAgICAgICAgICAgICAgICBhdHRycy5kdXJhdGlvbiA9ICghYXR0cnMuZHVyYXRpb24pID8gJzFzJyA6IGF0dHJzLmR1cmF0aW9uO1xyXG4gICAgICAgICAgICAgICAgYXR0cnMuZWFzaW5nID0gKCFhdHRycy5lYXNpbmcpID8gJ2Vhc2UtaW4tb3V0JyA6IGF0dHJzLmVhc2luZztcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQuY3NzKHtcclxuICAgICAgICAgICAgICAgICAgICAnb3ZlcmZsb3cnOiAnaGlkZGVuJyxcclxuICAgICAgICAgICAgICAgICAgICAnaGVpZ2h0JzogJzBweCcsXHJcbiAgICAgICAgICAgICAgICAgICAgJ3RyYW5zaXRpb25Qcm9wZXJ0eSc6ICdoZWlnaHQnLFxyXG4gICAgICAgICAgICAgICAgICAgICd0cmFuc2l0aW9uRHVyYXRpb24nOiBhdHRycy5kdXJhdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAndHJhbnNpdGlvblRpbWluZ0Z1bmN0aW9uJzogYXR0cnMuZWFzaW5nXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59KVxyXG4uZGlyZWN0aXZlKCdzbGlkZVRvZ2dsZScsIGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICByZXN0cmljdDogJ0EnLFxyXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xyXG4gICAgICAgICAgICB2YXIgdGFyZ2V0LCBjb250ZW50O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgYXR0cnMuZXhwYW5kZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGVsZW1lbnQuYmluZCgnY2xpY2snLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGlmICghdGFyZ2V0KSB0YXJnZXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF0dHJzLnNsaWRlVG9nZ2xlKTtcclxuICAgICAgICAgICAgICAgIGlmICghY29udGVudCkgY29udGVudCA9IHRhcmdldC5xdWVyeVNlbGVjdG9yKCcuc2xpZGVhYmxlX2NvbnRlbnQnKTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgaWYoIWF0dHJzLmV4cGFuZGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGVudC5zdHlsZS5ib3JkZXIgPSAnMXB4IHNvbGlkIHJnYmEoMCwwLDAsMCknO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB5ID0gY29udGVudC5jbGllbnRIZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGVudC5zdHlsZS5ib3JkZXIgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldC5zdHlsZS5oZWlnaHQgPSB5ICsgJ3B4JztcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LnN0eWxlLmhlaWdodCA9ICcwcHgnO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYXR0cnMuZXhwYW5kZWQgPSAhYXR0cnMuZXhwYW5kZWQ7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSk7IiwiKGZ1bmN0aW9uKCl7XHJcblx0dmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdncmFkZXInLCBcclxuXHRcdFtcclxuXHRcdFx0J3VpLnJvdXRlcicsXHJcblx0XHRcdCdnZW5lcmFsJyxcclxuXHRcdFx0J2NvdXJzZXMnLFxyXG5cdFx0XHQndXNlcidcclxuXHRcdF0pO1xyXG5cclxuXHQvL3JlbW92ZSB0aGUgaGFzaFxyXG5cdGFwcC5jb25maWcoWyckbG9jYXRpb25Qcm92aWRlcicsIGZ1bmN0aW9uKCRsb2NhdGlvblByb3ZpZGVyKXtcclxuXHRcdCRsb2NhdGlvblByb3ZpZGVyLmh0bWw1TW9kZSh0cnVlKTtcclxuXHR9XSk7XHJcblx0XHJcblx0YXBwLnJ1bihmdW5jdGlvbiAoJHJvb3RTY29wZSwgQXV0aFNlcnZpY2UsIEF1dGhSZXNvbHZlcikge1xyXG4gIFx0XHQkcm9vdFNjb3BlLiRvbignJHN0YXRlQ2hhbmdlU3RhcnQnLCBmdW5jdGlvbiAoZXZlbnQsIG5leHQpIHtcclxuICBcdFx0XHRpZiAoQXV0aFJlc29sdmVyLmJJc1Jlc29sdmVkKCkpe1xyXG4gIFx0XHRcdFx0Y29uc29sZS5sb2coJ3N0YXRlQ2hhbmdlU3RhcnQgcmVzb2x2ZWQnKTtcclxuICBcdFx0XHRcdGNvbnNvbGUubG9nKCdhdXRoOiAnICsgQXV0aFNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCkpO1xyXG4gIFx0XHRcdH1lbHNle1xyXG4gIFx0XHRcdFx0QXV0aFJlc29sdmVyLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uKGRhdGEpe1xyXG4gIFx0XHRcdFx0XHRjb25zb2xlLmxvZygnc3RhdGVDaGFuZ2VTdGFydCBub3QgcmVzb2x2ZWQnKTtcclxuICBcdFx0XHRcdFx0Y29uc29sZS5sb2coJ2F1dGg6ICcgKyBBdXRoU2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKSk7XHJcbiAgXHRcdFx0XHR9KVxyXG4gIFx0XHRcdH1cclxuICBcdFx0fSk7XHJcblx0fSk7XHJcbn0pKCk7IiwiKGZ1bmN0aW9uKCl7XHJcblx0YW5ndWxhci5tb2R1bGUoJ3VzZXInKS5jb250cm9sbGVyKCdEYXNoYm9hcmRDb250cm9sbGVyJywgZnVuY3Rpb24oJHN0YXRlLCAkaHR0cCwgQ291cnNlU2VydmljZSwgU2Vzc2lvbil7XHJcblx0XHR2YXIgcm9vdCA9IHRoaXM7XHJcblx0XHR0aGlzLm5ld0NvdXJzZSA9IHt9O1xyXG5cdFx0dGhpcy5jb3Vyc2VzID0gbnVsbDtcclxuXHRcdHRoaXMudXNlciA9IFNlc3Npb24udXNlcjtcclxuXHJcblx0XHR2YXIgZ2V0Q291cnNlcyA9IGZ1bmN0aW9uKCl7XHJcblx0XHRcdENvdXJzZVNlcnZpY2UuZ2V0Q291cnNlcygpLnRoZW4oXHJcblx0XHRcdFx0ZnVuY3Rpb24gU3VjY2VzcyhyZXMpe1xyXG5cdFx0XHRcdFx0cm9vdC5jb3Vyc2VzID0gcmVzLmRhdGE7XHJcblx0XHRcdFx0fSwgXHJcblx0XHRcdFx0ZnVuY3Rpb24gRmFpbHVyZShyZXMpe1xyXG5cclxuXHRcdFx0XHR9XHJcblx0XHRcdCk7XHJcblx0XHR9O1xyXG5cclxuXHRcdHRoaXMuY3JlYXRlQ291cnNlID0gZnVuY3Rpb24oKXtcclxuXHRcdFx0Q291cnNlU2VydmljZS5jcmVhdGVDb3Vyc2Uocm9vdC5uZXdDb3Vyc2UpLnRoZW4oZnVuY3Rpb24ocmVzKXtcclxuXHRcdFx0XHRjb25zb2xlLmxvZyhyZXMpO1xyXG5cdFx0XHR9KTtcclxuXHRcdH1cclxuXHJcblx0XHRnZXRDb3Vyc2VzKCk7XHJcblx0fSk7XHJcblxyXG5cdGFuZ3VsYXIubW9kdWxlKCd1c2VyJykuY29udHJvbGxlcignQ291cnNlQ29udHJvbGxlcicsIFxyXG5cdFx0ZnVuY3Rpb24oJHN0YXRlLCAkaHR0cCwgJHN0YXRlUGFyYW1zLCBDb3Vyc2VTZXJ2aWNlLCBTZXNzaW9uKXtcclxuXHRcdHZhciByb290ID0gdGhpcztcclxuXHJcblx0XHR0aGlzLmNvdXJzZSA9IG51bGw7XHJcblx0XHRyb290LnVzZXIgPSBTZXNzaW9uLnVzZXI7XHJcblxyXG5cdFx0dGhpcy5uZXdBc3NpZ25tZW50ID0ge307XHJcblxyXG5cdFx0dmFyIGdldENvdXJzZSA9IGZ1bmN0aW9uKCl7XHJcblx0XHRcdENvdXJzZVNlcnZpY2UuZ2V0Q291cnNlKCRzdGF0ZVBhcmFtcy5jb3Vyc2VDb2RlKS50aGVuKFxyXG5cdFx0XHRcdGZ1bmN0aW9uIFN1Y2Nlc3MocmVzKXtcclxuXHRcdFx0XHRcdGNvbnNvbGUubG9nKHJlcyk7XHJcblx0XHRcdFx0XHRyb290LmNvdXJzZSA9IHJlcy5kYXRhO1xyXG5cdFx0XHRcdFx0cm9vdC5uZXdBc3NpZ25tZW50LmNvdXJzZUlEID0gcmVzLmRhdGEuX2lkO1xyXG5cdFx0XHRcdH0sIFxyXG5cdFx0XHRcdGZ1bmN0aW9uIEZhaWx1cmUocmVzKXtcclxuXHJcblx0XHRcdFx0fVxyXG5cdFx0XHQpO1xyXG5cdFx0fTtcclxuXHJcblx0XHR0aGlzLmNyZWF0ZUFzc2lnbm1lbnQgPSBmdW5jdGlvbigpe1xyXG5cdFx0XHRDb3Vyc2VTZXJ2aWNlLmNyZWF0ZUFzc2lnbm1lbnQoJHN0YXRlUGFyYW1zLmNvdXJzZUNvZGUsIHJvb3QubmV3QXNzaWdubWVudCkudGhlbihcclxuXHRcdFx0XHRmdW5jdGlvbiBTdWNjZXNzKHJlcyl7XHJcblx0XHRcdFx0XHRjb25zb2xlLmxvZyhyZXMpO1xyXG5cdFx0XHRcdH0sIFxyXG5cdFx0XHRcdGZ1bmN0aW9uIEZhaWx1cmUocmVzKXtcclxuXHJcblx0XHRcdFx0fVxyXG5cdFx0XHQpO1xyXG5cdFx0fVxyXG5cclxuXHRcdGdldENvdXJzZSgpO1xyXG5cdH0pO1xyXG59KSgpOyIsIihmdW5jdGlvbigpe1xyXG5cdHZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnY291cnNlcycsIFtdKTtcclxufSkoKTtcbihmdW5jdGlvbigpe1xyXG5cdHZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnZ2VuZXJhbCcsIFtdKTtcclxufSkoKTtcbihmdW5jdGlvbigpe1xyXG5cdHZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgndXNlcicsIFtdKVxyXG5cdC5ydW4oW1wiJGh0dHBcIiwgXCJTZXNzaW9uXCIsIGZ1bmN0aW9uKCRodHRwLCBTZXNzaW9uKXtcclxuXHRcdCRodHRwLmdldCgnL2FwaS9wcm9maWxlJylcclxuXHRcdC5zdWNjZXNzKGZ1bmN0aW9uKHJlcyl7XHJcblx0XHRcdFNlc3Npb24uY3JlYXRlKHJlcyk7XHJcblx0XHR9KVxyXG5cdFx0LmVycm9yKGZ1bmN0aW9uKHJlcyl7XHJcblx0XHRcdFNlc3Npb24uc2V0Q3VycmVudFVzZXIoe30pO1xyXG5cdFx0fSk7XHJcblx0fV0pO1xyXG59KSgpO1xuYW5ndWxhci5tb2R1bGUoJ2FuZ3VsYXJTbGlkZWFibGVzJywgW10pXHJcbi5kaXJlY3RpdmUoJ3NsaWRlYWJsZScsIGZ1bmN0aW9uICgpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgcmVzdHJpY3Q6J0MnLFxyXG4gICAgICAgIGNvbXBpbGU6IGZ1bmN0aW9uIChlbGVtZW50LCBhdHRyKSB7XHJcbiAgICAgICAgICAgIC8vIHdyYXAgdGFnXHJcbiAgICAgICAgICAgIHZhciBjb250ZW50cyA9IGVsZW1lbnQuaHRtbCgpO1xyXG4gICAgICAgICAgICBlbGVtZW50Lmh0bWwoJzxkaXYgY2xhc3M9XCJzbGlkZWFibGVfY29udGVudFwiIHN0eWxlPVwibWFyZ2luOjAgIWltcG9ydGFudDsgcGFkZGluZzowICFpbXBvcnRhbnRcIiA+JyArIGNvbnRlbnRzICsgJzwvZGl2PicpO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIHBvc3RMaW5rKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xyXG4gICAgICAgICAgICAgICAgLy8gZGVmYXVsdCBwcm9wZXJ0aWVzXHJcbiAgICAgICAgICAgICAgICBhdHRycy5kdXJhdGlvbiA9ICghYXR0cnMuZHVyYXRpb24pID8gJzFzJyA6IGF0dHJzLmR1cmF0aW9uO1xyXG4gICAgICAgICAgICAgICAgYXR0cnMuZWFzaW5nID0gKCFhdHRycy5lYXNpbmcpID8gJ2Vhc2UtaW4tb3V0JyA6IGF0dHJzLmVhc2luZztcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQuY3NzKHtcclxuICAgICAgICAgICAgICAgICAgICAnb3ZlcmZsb3cnOiAnaGlkZGVuJyxcclxuICAgICAgICAgICAgICAgICAgICAnaGVpZ2h0JzogJzBweCcsXHJcbiAgICAgICAgICAgICAgICAgICAgJ3RyYW5zaXRpb25Qcm9wZXJ0eSc6ICdoZWlnaHQnLFxyXG4gICAgICAgICAgICAgICAgICAgICd0cmFuc2l0aW9uRHVyYXRpb24nOiBhdHRycy5kdXJhdGlvbixcclxuICAgICAgICAgICAgICAgICAgICAndHJhbnNpdGlvblRpbWluZ0Z1bmN0aW9uJzogYXR0cnMuZWFzaW5nXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59KVxyXG4uZGlyZWN0aXZlKCdzbGlkZVRvZ2dsZScsIGZ1bmN0aW9uKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICByZXN0cmljdDogJ0EnLFxyXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xyXG4gICAgICAgICAgICB2YXIgdGFyZ2V0LCBjb250ZW50O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgYXR0cnMuZXhwYW5kZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGVsZW1lbnQuYmluZCgnY2xpY2snLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGlmICghdGFyZ2V0KSB0YXJnZXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF0dHJzLnNsaWRlVG9nZ2xlKTtcclxuICAgICAgICAgICAgICAgIGlmICghY29udGVudCkgY29udGVudCA9IHRhcmdldC5xdWVyeVNlbGVjdG9yKCcuc2xpZGVhYmxlX2NvbnRlbnQnKTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgaWYoIWF0dHJzLmV4cGFuZGVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGVudC5zdHlsZS5ib3JkZXIgPSAnMXB4IHNvbGlkIHJnYmEoMCwwLDAsMCknO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciB5ID0gY29udGVudC5jbGllbnRIZWlnaHQ7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGVudC5zdHlsZS5ib3JkZXIgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldC5zdHlsZS5oZWlnaHQgPSB5ICsgJ3B4JztcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LnN0eWxlLmhlaWdodCA9ICcwcHgnO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgYXR0cnMuZXhwYW5kZWQgPSAhYXR0cnMuZXhwYW5kZWQ7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSk7XG4oZnVuY3Rpb24oKXtcclxuXHR2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ2dyYWRlcicsIFxyXG5cdFx0W1xyXG5cdFx0XHQndWkucm91dGVyJyxcclxuXHRcdFx0J2dlbmVyYWwnLFxyXG5cdFx0XHQnY291cnNlcycsXHJcblx0XHRcdCd1c2VyJ1xyXG5cdFx0XSk7XHJcblxyXG5cdC8vcmVtb3ZlIHRoZSBoYXNoXHJcblx0YXBwLmNvbmZpZyhbJyRsb2NhdGlvblByb3ZpZGVyJywgZnVuY3Rpb24oJGxvY2F0aW9uUHJvdmlkZXIpe1xyXG5cdFx0JGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xyXG5cdH1dKTtcclxuXHRcclxuXHRhcHAucnVuKFtcIiRyb290U2NvcGVcIiwgXCJBdXRoU2VydmljZVwiLCBcIkF1dGhSZXNvbHZlclwiLCBmdW5jdGlvbiAoJHJvb3RTY29wZSwgQXV0aFNlcnZpY2UsIEF1dGhSZXNvbHZlcikge1xyXG4gIFx0XHQkcm9vdFNjb3BlLiRvbignJHN0YXRlQ2hhbmdlU3RhcnQnLCBmdW5jdGlvbiAoZXZlbnQsIG5leHQpIHtcclxuICBcdFx0XHRpZiAoQXV0aFJlc29sdmVyLmJJc1Jlc29sdmVkKCkpe1xyXG4gIFx0XHRcdFx0Y29uc29sZS5sb2coJ3N0YXRlQ2hhbmdlU3RhcnQgcmVzb2x2ZWQnKTtcclxuICBcdFx0XHRcdGNvbnNvbGUubG9nKCdhdXRoOiAnICsgQXV0aFNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCkpO1xyXG4gIFx0XHRcdH1lbHNle1xyXG4gIFx0XHRcdFx0QXV0aFJlc29sdmVyLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uKGRhdGEpe1xyXG4gIFx0XHRcdFx0XHRjb25zb2xlLmxvZygnc3RhdGVDaGFuZ2VTdGFydCBub3QgcmVzb2x2ZWQnKTtcclxuICBcdFx0XHRcdFx0Y29uc29sZS5sb2coJ2F1dGg6ICcgKyBBdXRoU2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKSk7XHJcbiAgXHRcdFx0XHR9KVxyXG4gIFx0XHRcdH1cclxuICBcdFx0fSk7XHJcblx0fV0pO1xyXG59KSgpO1xuKGZ1bmN0aW9uKCl7XHJcblx0YW5ndWxhci5tb2R1bGUoJ3VzZXInKS5jb250cm9sbGVyKCdEYXNoYm9hcmRDb250cm9sbGVyJywgW1wiJHN0YXRlXCIsIFwiJGh0dHBcIiwgXCJDb3Vyc2VTZXJ2aWNlXCIsIFwiU2Vzc2lvblwiLCBmdW5jdGlvbigkc3RhdGUsICRodHRwLCBDb3Vyc2VTZXJ2aWNlLCBTZXNzaW9uKXtcclxuXHRcdHZhciByb290ID0gdGhpcztcclxuXHRcdHRoaXMubmV3Q291cnNlID0ge307XHJcblx0XHR0aGlzLmNvdXJzZXMgPSBudWxsO1xyXG5cdFx0dGhpcy51c2VyID0gU2Vzc2lvbi51c2VyO1xyXG5cclxuXHRcdHZhciBnZXRDb3Vyc2VzID0gZnVuY3Rpb24oKXtcclxuXHRcdFx0Q291cnNlU2VydmljZS5nZXRDb3Vyc2VzKCkudGhlbihcclxuXHRcdFx0XHRmdW5jdGlvbiBTdWNjZXNzKHJlcyl7XHJcblx0XHRcdFx0XHRyb290LmNvdXJzZXMgPSByZXMuZGF0YTtcclxuXHRcdFx0XHR9LCBcclxuXHRcdFx0XHRmdW5jdGlvbiBGYWlsdXJlKHJlcyl7XHJcblxyXG5cdFx0XHRcdH1cclxuXHRcdFx0KTtcclxuXHRcdH07XHJcblxyXG5cdFx0dGhpcy5jcmVhdGVDb3Vyc2UgPSBmdW5jdGlvbigpe1xyXG5cdFx0XHRDb3Vyc2VTZXJ2aWNlLmNyZWF0ZUNvdXJzZShyb290Lm5ld0NvdXJzZSkudGhlbihmdW5jdGlvbihyZXMpe1xyXG5cdFx0XHRcdGNvbnNvbGUubG9nKHJlcyk7XHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cclxuXHRcdGdldENvdXJzZXMoKTtcclxuXHR9XSk7XHJcblxyXG5cdGFuZ3VsYXIubW9kdWxlKCd1c2VyJykuY29udHJvbGxlcignQ291cnNlQ29udHJvbGxlcicsIFxyXG5cdFx0W1wiJHN0YXRlXCIsIFwiJGh0dHBcIiwgXCIkc3RhdGVQYXJhbXNcIiwgXCJDb3Vyc2VTZXJ2aWNlXCIsIFwiU2Vzc2lvblwiLCBmdW5jdGlvbigkc3RhdGUsICRodHRwLCAkc3RhdGVQYXJhbXMsIENvdXJzZVNlcnZpY2UsIFNlc3Npb24pe1xyXG5cdFx0dmFyIHJvb3QgPSB0aGlzO1xyXG5cclxuXHRcdHRoaXMuY291cnNlID0gbnVsbDtcclxuXHRcdHJvb3QudXNlciA9IFNlc3Npb24udXNlcjtcclxuXHJcblx0XHR0aGlzLm5ld0Fzc2lnbm1lbnQgPSB7fTtcclxuXHJcblx0XHR2YXIgZ2V0Q291cnNlID0gZnVuY3Rpb24oKXtcclxuXHRcdFx0Q291cnNlU2VydmljZS5nZXRDb3Vyc2UoJHN0YXRlUGFyYW1zLmNvdXJzZUNvZGUpLnRoZW4oXHJcblx0XHRcdFx0ZnVuY3Rpb24gU3VjY2VzcyhyZXMpe1xyXG5cdFx0XHRcdFx0Y29uc29sZS5sb2cocmVzKTtcclxuXHRcdFx0XHRcdHJvb3QuY291cnNlID0gcmVzLmRhdGE7XHJcblx0XHRcdFx0XHRyb290Lm5ld0Fzc2lnbm1lbnQuY291cnNlSUQgPSByZXMuZGF0YS5faWQ7XHJcblx0XHRcdFx0fSwgXHJcblx0XHRcdFx0ZnVuY3Rpb24gRmFpbHVyZShyZXMpe1xyXG5cclxuXHRcdFx0XHR9XHJcblx0XHRcdCk7XHJcblx0XHR9O1xyXG5cclxuXHRcdHRoaXMuY3JlYXRlQXNzaWdubWVudCA9IGZ1bmN0aW9uKCl7XHJcblx0XHRcdENvdXJzZVNlcnZpY2UuY3JlYXRlQXNzaWdubWVudCgkc3RhdGVQYXJhbXMuY291cnNlQ29kZSwgcm9vdC5uZXdBc3NpZ25tZW50KS50aGVuKFxyXG5cdFx0XHRcdGZ1bmN0aW9uIFN1Y2Nlc3MocmVzKXtcclxuXHRcdFx0XHRcdGNvbnNvbGUubG9nKHJlcyk7XHJcblx0XHRcdFx0fSwgXHJcblx0XHRcdFx0ZnVuY3Rpb24gRmFpbHVyZShyZXMpe1xyXG5cclxuXHRcdFx0XHR9XHJcblx0XHRcdCk7XHJcblx0XHR9XHJcblxyXG5cdFx0Z2V0Q291cnNlKCk7XHJcblx0fV0pO1xyXG59KSgpO1xuKGZ1bmN0aW9uKCl7XHJcblx0YW5ndWxhci5tb2R1bGUoJ3VzZXInKS5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uKCRzdGF0ZVByb3ZpZGVyKXtcclxuXHRcdCRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdyb290Lm1haW4uZGFzaGJvYXJkJywge1xyXG5cdFx0XHR0ZW1wbGF0ZVVybDogJy9hbmd1bGFyL2NvdXJzZXMvcGFydGlhbHMvZGFzaGJvYXJkLmh0bWwnLFxyXG5cdFx0XHRjb250cm9sbGVyOiAnRGFzaGJvYXJkQ29udHJvbGxlcicsXHJcblx0XHRcdGNvbnRyb2xsZXJBczogJ2Rhc2hib2FyZEN0cmwnXHJcblx0XHR9KTtcclxuXHJcblx0XHQkc3RhdGVQcm92aWRlci5zdGF0ZSgncm9vdC5jb3Vyc2UnLCB7XHJcblx0XHRcdHVybDogJy9jb3Vyc2UvOmNvdXJzZUNvZGUnLFxyXG5cdFx0XHR0ZW1wbGF0ZVVybDogJy9hbmd1bGFyL2NvdXJzZXMvcGFydGlhbHMvY291cnNlLmh0bWwnLFxyXG5cdFx0XHRjb250cm9sbGVyOiAnQ291cnNlQ29udHJvbGxlcicsXHJcblx0XHRcdGNvbnRyb2xsZXJBczogJ2NvdXJzZUN0cmwnXHJcblx0XHR9KTtcclxuXHR9XSk7XHJcbn0pKCk7XG4oZnVuY3Rpb24oKXtcclxuXHRhbmd1bGFyLm1vZHVsZSgnY291cnNlcycpLmZhY3RvcnkoJ0NvdXJzZVNlcnZpY2UnLCBbXCIkaHR0cFwiLCBmdW5jdGlvbiAoJGh0dHApIHtcclxuXHRcdHRoaXMuY3JlYXRlQ291cnNlID0gZnVuY3Rpb24obmV3Q291cnNlKSB7XHJcblx0XHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL2NvdXJzZS9jcmVhdGUnLCBuZXdDb3Vyc2UpO1xyXG5cdFx0fTtcclxuXHJcblx0XHR0aGlzLmdldENvdXJzZXMgPSBmdW5jdGlvbigpe1xyXG5cdFx0XHRyZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3Byb2ZpbGUvY291cnNlcycpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuZ2V0Q291cnNlID0gZnVuY3Rpb24oY291cnNlQ29kZSl7XHJcblx0XHRcdHJldHVybiAkaHR0cC5nZXQoJy9hcGkvY291cnNlLycgKyBjb3Vyc2VDb2RlKTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLmNyZWF0ZUFzc2lnbm1lbnQgPSBmdW5jdGlvbihjb3Vyc2VDb2RlLCBuZXdBc3NpZ25tZW50KXtcclxuXHRcdFx0Y29uc29sZS5sb2coJ2hlbGxvJylcclxuXHRcdFx0cmV0dXJuICRodHRwLnBvc3QoJy9hcGkvY291cnNlLycgKyBjb3Vyc2VDb2RlICsgJy9hc3NpZ25tZW50L2NyZWF0ZScsIG5ld0Fzc2lnbm1lbnQpO1xyXG5cdFx0fTtcclxuXHJcblx0XHRyZXR1cm4gdGhpcztcclxuXHR9XSk7XHJcbn0pKCk7XG4oZnVuY3Rpb24oKXtcclxuXHRhbmd1bGFyLm1vZHVsZSgnZ2VuZXJhbCcpLmNvbnRyb2xsZXIoJ05hdkNvbnRyb2xsZXInLCBbXCIkaHR0cFwiLCBcIkF1dGhTZXJ2aWNlXCIsIFwiQXV0aFJlc29sdmVyXCIsIFwiJHN0YXRlXCIsIGZ1bmN0aW9uKCRodHRwLCBBdXRoU2VydmljZSwgQXV0aFJlc29sdmVyLCAkc3RhdGUpe1xyXG5cdFx0dmFyIHJvb3QgPSB0aGlzO1xyXG5cdFx0dGhpcy4kc3RhdGUgPSAkc3RhdGU7XHJcblx0XHR0aGlzLmJMb2dnZWRJbiA9IG51bGw7XHJcblx0XHRcclxuXHRcdGlmIChBdXRoUmVzb2x2ZXIuYklzUmVzb2x2ZWQoKSl7XHJcblx0XHRcdHJvb3QuYkxvZ2dlZEluID0gQXV0aFNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCk7XHJcblx0XHR9ZWxzZXtcclxuXHRcdFx0QXV0aFJlc29sdmVyLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uKCl7XHJcblx0XHRcdFx0cm9vdC5iTG9nZ2VkSW4gPSBBdXRoU2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKTtcclxuXHRcdFx0fSk7XHJcblx0XHR9XHJcblx0fV0pO1xyXG59KSgpO1xuKGZ1bmN0aW9uKCl7XHJcblx0YW5ndWxhci5tb2R1bGUoJ2dlbmVyYWwnKS5jb25maWcoW1wiJHN0YXRlUHJvdmlkZXJcIiwgZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIpe1xyXG5cclxuXHRcdCRzdGF0ZVByb3ZpZGVyXHJcblx0XHQuc3RhdGUoJ3Jvb3QnLCB7XHJcblx0XHRcdGFic3RyYWN0OiB0cnVlLFxyXG5cdFx0XHR0ZW1wbGF0ZTogJzx1aS12aWV3Lz4nLFxyXG5cdFx0XHRyZXNvbHZlOiB7XHJcblx0XHRcdFx0YXV0aDogW1wiQXV0aFJlc29sdmVyXCIsIGZ1bmN0aW9uIHJlc29sdmVBdXRoZW50aWNhdGlvbihBdXRoUmVzb2x2ZXIpIHsgXHJcblx0XHRcdFx0XHRyZXR1cm4gKEF1dGhSZXNvbHZlci5iSXNSZXNvbHZlZCgpID09PSB0cnVlIHx8IEF1dGhSZXNvbHZlci5yZXNvbHZlKCkpO1xyXG5cdFx0XHRcdH1dXHJcblx0XHRcdH1cclxuXHRcdH0pXHJcblxyXG5cdFx0LnN0YXRlKCdyb290Lm1haW4nLCB7XHJcblx0XHRcdHVybDogJy8nLFxyXG5cdFx0XHR0ZW1wbGF0ZTogJzx1aS12aWV3Lz4nLFxyXG5cdFx0XHRjb250cm9sbGVyOiBbXCIkc3RhdGVcIiwgXCJBdXRoU2VydmljZVwiLCBmdW5jdGlvbigkc3RhdGUsIEF1dGhTZXJ2aWNlKXtcclxuXHRcdFx0XHRpZiAoQXV0aFNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCkpe1xyXG5cdFx0XHRcdFx0JHN0YXRlLmdvKCdyb290Lm1haW4uZGFzaGJvYXJkJyk7XHJcblx0XHRcdFx0fWVsc2V7XHJcblx0XHRcdFx0XHQkc3RhdGUuZ28oJ3Jvb3QubWFpbi5wdWJsaWMnKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1dXHJcblx0XHR9KVxyXG5cclxuXHRcdC5zdGF0ZSgncm9vdC5tYWluLnB1YmxpYycsIHtcclxuXHRcdFx0dGVtcGxhdGVVcmw6ICcvYW5ndWxhci9nZW5lcmFsL3BhcnRpYWxzL2luZGV4Lmh0bWwnLFxyXG5cdFx0XHRjb250cm9sbGVyOiBmdW5jdGlvbigpe1xyXG5cdFx0XHRcdGNvbnNvbGUubG9nKCdIaXQgcHVibGljIGluZGV4Jyk7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH1dKTtcclxufSkoKTtcbihmdW5jdGlvbigpe1xyXG5cdGFuZ3VsYXIubW9kdWxlKCd1c2VyJykuY29udHJvbGxlcignTG9naW5Db250cm9sbGVyJywgW1wiJHN0YXRlXCIsIFwiJHJvb3RTY29wZVwiLCBcIkF1dGhTZXJ2aWNlXCIsIGZ1bmN0aW9uKCRzdGF0ZSwgJHJvb3RTY29wZSwgQXV0aFNlcnZpY2Upe1xyXG5cdFx0dmFyIHJvb3QgPSB0aGlzO1xyXG5cdFx0dGhpcy5hdXRoTWVzc2FnZSA9ICcnO1xyXG5cdFx0dGhpcy51c2VyID0ge1xyXG5cdFx0XHRlbWFpbDogJycsXHJcblx0XHRcdHBhc3N3b3JkOiAnJ1xyXG5cdFx0fTtcclxuXHJcblx0XHR0aGlzLmxvZ2luID0gZnVuY3Rpb24oKSB7XHJcblx0XHRcdEF1dGhTZXJ2aWNlLmxvZ2luKHJvb3QudXNlcikudGhlbihcclxuXHRcdFx0XHRmdW5jdGlvbihyZXMpe1xyXG5cdFx0XHRcdFx0JHN0YXRlLmdvKCdyb290Lm1haW4nKTtcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdGZ1bmN0aW9uKHJlcyl7XHJcblx0XHRcdFx0XHRyb290LmF1dGhNZXNzYWdlID0gcmVzLmRhdGEudXNlck1lc3NhZ2U7XHJcblx0XHRcdFx0fSk7XHJcblx0XHR9O1xyXG5cdH1dKTtcclxuXHRcclxuXHRhbmd1bGFyLm1vZHVsZSgndXNlcicpLmNvbnRyb2xsZXIoJ0pvaW5Db250cm9sbGVyJywgW1wiJHN0YXRlXCIsIFwiJHJvb3RTY29wZVwiLCBcIkF1dGhTZXJ2aWNlXCIsIGZ1bmN0aW9uKCRzdGF0ZSwgJHJvb3RTY29wZSwgQXV0aFNlcnZpY2Upe1xyXG5cdFx0dmFyIHJvb3QgPSB0aGlzO1xyXG5cdFx0dGhpcy5hdXRoTWVzc2FnZSA9ICcnO1xyXG5cdFx0dGhpcy51c2VyID0ge1xyXG5cdFx0XHRmaXJzdE5hbWU6ICcnLFxyXG5cdFx0XHRsYXN0TmFtZTogJycsXHJcblx0XHRcdHJldHlwZVBhc3N3b3JkOiAnJywgXHJcblx0XHRcdHBhc3N3b3JkOiAnJyxcclxuXHRcdFx0ZW1haWw6ICcnLFxyXG5cdFx0XHRhY2NvdW50VHlwZTogJydcclxuXHRcdH07XHJcblxyXG5cdFx0dGhpcy5zaWdudXAgPSBmdW5jdGlvbigpIHtcclxuXHRcdFx0QXV0aFNlcnZpY2Uuc2lnbnVwKHJvb3QudXNlcikudGhlbihcclxuXHRcdFx0XHRmdW5jdGlvbihyZXMpe1xyXG5cdFx0XHRcdFx0JHN0YXRlLmdvKCdyb290Lm1haW4nKTtcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdGZ1bmN0aW9uKHJlcyl7XHJcblx0XHRcdFx0XHRyb290LmF1dGhNZXNzYWdlID0gcmVzLmRhdGEudXNlck1lc3NhZ2U7XHJcblx0XHRcdFx0fSk7XHJcblx0XHR9O1xyXG5cdH1dKTtcclxuXHJcblx0YW5ndWxhci5tb2R1bGUoJ3VzZXInKS5jb250cm9sbGVyKCdQcm9maWxlQ29udHJvbGxlcicsIFtcIiRzdGF0ZVwiLCBcIlNlc3Npb25cIiwgZnVuY3Rpb24oJHN0YXRlLCBTZXNzaW9uKXtcclxuXHRcdHRoaXMudXNlciA9IFNlc3Npb24udXNlcjtcclxuXHR9XSk7XHJcbn0pKCk7XG4oZnVuY3Rpb24oKXtcclxuXHRhbmd1bGFyLm1vZHVsZSgndXNlcicpLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIpe1xyXG5cdFx0JHN0YXRlUHJvdmlkZXIuc3RhdGUoJ3Jvb3QubG9naW4nLCB7XHJcblx0XHRcdHVybDogJy9sb2dpbicsXHJcblx0XHRcdHRlbXBsYXRlVXJsOiAnL2FuZ3VsYXIvdXNlci9wYXJ0aWFscy9sb2dpbi5odG1sJyxcclxuXHRcdFx0Y29udHJvbGxlcjogJ0xvZ2luQ29udHJvbGxlcicsXHJcblx0XHRcdGNvbnRyb2xsZXJBczogJ2xvZ2luQ3RybCdcclxuXHRcdH0pO1xyXG5cclxuXHRcdCRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdyb290LmpvaW4nLCB7XHJcblx0XHRcdHVybDogJy9qb2luJyxcclxuXHRcdFx0dGVtcGxhdGVVcmw6ICcvYW5ndWxhci91c2VyL3BhcnRpYWxzL2pvaW4uaHRtbCcsXHJcblx0XHRcdGNvbnRyb2xsZXI6ICdKb2luQ29udHJvbGxlcicsXHJcblx0XHRcdGNvbnRyb2xsZXJBczogJ2pvaW5DdHJsJ1xyXG5cdFx0fSk7XHJcblx0XHRcclxuXHRcdCRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdyb290LnByb2ZpbGUnLCB7XHJcblx0XHRcdHVybDogJy9wcm9maWxlJyxcclxuXHRcdFx0dGVtcGxhdGVVcmw6ICcvYW5ndWxhci91c2VyL3BhcnRpYWxzL3Byb2ZpbGUuaHRtbCcsXHJcblx0XHRcdGNvbnRyb2xsZXI6ICdQcm9maWxlQ29udHJvbGxlcicsXHJcblx0XHRcdGNvbnRyb2xsZXJBczogJ3Byb2ZpbGVDdHJsJ1xyXG5cdFx0fSk7XHJcblx0fV0pO1xyXG59KSgpO1xuKGZ1bmN0aW9uKCl7XHJcblx0YW5ndWxhci5tb2R1bGUoJ3VzZXInKS5mYWN0b3J5KCdBdXRoU2VydmljZScsIFtcIiRodHRwXCIsIFwiU2Vzc2lvblwiLCBmdW5jdGlvbiAoJGh0dHAsIFNlc3Npb24pIHtcclxuXHRcdHZhciBhdXRoU2VydmljZSA9IHt9O1xyXG5cdFx0dmFyIHVzZXIgPSB7fTtcclxuXHJcblx0XHRhdXRoU2VydmljZS5sb2dpbiA9IGZ1bmN0aW9uKGNyZWRlbnRpYWxzKSB7XHJcblx0XHRcdHJldHVybiAkaHR0cFxyXG5cdFx0XHQucG9zdCgnL2F1dGgvbG9jYWwnLCBjcmVkZW50aWFscylcclxuXHRcdFx0LnRoZW4oZnVuY3Rpb24gKHJlcykge1xyXG5cdFx0XHRcdFNlc3Npb24uY3JlYXRlKHJlcy5kYXRhKTtcclxuXHRcdFx0XHRyZXR1cm4gcmVzLmRhdGE7XHJcblx0XHRcdH0pO1xyXG5cdFx0fTtcclxuXHJcblx0XHRhdXRoU2VydmljZS5zaWdudXAgPSBmdW5jdGlvbihuZXdVc2VyKXtcclxuXHRcdFx0cmV0dXJuICRodHRwXHJcblx0XHRcdC5wb3N0KCcvYXBpL3VzZXIvam9pbicsIG5ld1VzZXIpXHJcblx0XHRcdC50aGVuKFxyXG5cdFx0XHRmdW5jdGlvbiBTdWNjZXNzKHJlcyl7XHJcblx0XHRcdFx0Y29uc29sZS5sb2cocmVzLmRhdGEpO1xyXG5cdFx0XHRcdFNlc3Npb24uY3JlYXRlKHJlcy5kYXRhKTtcclxuXHRcdFx0XHRyZXR1cm4gcmVzLmRhdGE7XHJcblx0XHRcdH0sIGZ1bmN0aW9uIEZhaWx1cmUocmVzKXtcclxuXHRcdFx0XHRyZXR1cm4gcmVzLmRhdGE7XHJcblx0XHRcdH0pO1xyXG5cdFx0fTtcclxuXHJcblx0XHRhdXRoU2VydmljZS5pc0F1dGhlbnRpY2F0ZWQgPSBmdW5jdGlvbigpIHtcclxuXHRcdFx0cmV0dXJuIFNlc3Npb24ubGl2ZSgpO1xyXG5cdFx0fTtcclxuXHJcblx0XHRyZXR1cm4gYXV0aFNlcnZpY2U7XHJcblx0fV0pO1xyXG5cclxuXHRhbmd1bGFyLm1vZHVsZSgndXNlcicpLnNlcnZpY2UoJ1Nlc3Npb24nLCBbXCIkcm9vdFNjb3BlXCIsIGZ1bmN0aW9uICgkcm9vdFNjb3BlKSB7XHJcblx0XHR2YXIgcm9vdCA9IHRoaXM7XHJcblx0XHR0aGlzLnVzZXIgPSB7fTtcclxuXHJcblx0XHR0aGlzLmxpdmUgPSBmdW5jdGlvbigpe1xyXG5cdFx0XHRyZXR1cm4gKE9iamVjdC5rZXlzKHJvb3QudXNlcikubGVuZ3RoID4gMCk7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5zZXRDdXJyZW50VXNlciA9IGZ1bmN0aW9uKHVzZXIpe1xyXG5cdFx0XHQkcm9vdFNjb3BlLmN1cnJlbnRVc2VyID0gdXNlcjtcclxuXHRcdFx0cm9vdC51c2VyID0gdXNlcjtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLmNyZWF0ZSA9IGZ1bmN0aW9uKHVzZXIpe1xyXG5cdFx0XHQkcm9vdFNjb3BlLmN1cnJlbnRVc2VyID0gdXNlcjtcclxuXHRcdFx0cm9vdC51c2VyID0gdXNlcjtcclxuXHRcdH07XHJcblxyXG5cdFx0dGhpcy5kZXN0cm95ID0gZnVuY3Rpb24gKCkge1xyXG5cdFx0XHQkcm9vdFNjb3BlLmN1cnJlbnRVc2VyID0gbnVsbDtcclxuXHRcdFx0cm9vdC51c2VyID0gbnVsbDtcclxuXHRcdH07XHJcblx0fV0pO1xyXG5cclxuXHRhbmd1bGFyLm1vZHVsZSgndXNlcicpLmZhY3RvcnkoJ0F1dGhSZXNvbHZlcicsIFtcIiRxXCIsIFwiJHJvb3RTY29wZVwiLCBcIiRzdGF0ZVwiLCBmdW5jdGlvbigkcSwgJHJvb3RTY29wZSwgJHN0YXRlKSB7XHJcblx0XHR2YXIgYklzUmVzb2x2ZWQgPSBmYWxzZTtcclxuXHJcblx0XHRyZXR1cm4ge1xyXG5cdFx0XHRyZXNvbHZlOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdFx0dmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcclxuXHRcdFx0XHR2YXIgdW53YXRjaCA9ICRyb290U2NvcGUuJHdhdGNoKCdjdXJyZW50VXNlcicsIGZ1bmN0aW9uIChjdXJyZW50VXNlcikge1xyXG5cdFx0XHRcdFx0aWYgKGFuZ3VsYXIuaXNEZWZpbmVkKGN1cnJlbnRVc2VyKSkge1xyXG5cdFx0XHRcdFx0XHRpZiAoY3VycmVudFVzZXIpIHtcclxuXHRcdFx0XHRcdFx0XHRkZWZlcnJlZC5yZXNvbHZlKGN1cnJlbnRVc2VyKTtcclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRkZWZlcnJlZC5yZWplY3QoKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRiSXNSZXNvbHZlZCA9IHRydWU7XHJcblx0XHRcdFx0XHRcdHVud2F0Y2goKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHRyZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcclxuXHRcdFx0fSxcclxuXHJcblx0XHRcdGJJc1Jlc29sdmVkOiBmdW5jdGlvbigpe1xyXG5cdFx0XHRcdHJldHVybiBiSXNSZXNvbHZlZDtcclxuXHRcdFx0fVxyXG5cdFx0fTtcclxuXHR9XSk7XHJcbn0pKCk7IiwiKGZ1bmN0aW9uKCl7XHJcblx0YW5ndWxhci5tb2R1bGUoJ3VzZXInKS5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uKCRzdGF0ZVByb3ZpZGVyKXtcclxuXHRcdCRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdyb290Lm1haW4uZGFzaGJvYXJkJywge1xyXG5cdFx0XHR0ZW1wbGF0ZVVybDogJy9hbmd1bGFyL2NvdXJzZXMvcGFydGlhbHMvZGFzaGJvYXJkLmh0bWwnLFxyXG5cdFx0XHRjb250cm9sbGVyOiAnRGFzaGJvYXJkQ29udHJvbGxlcicsXHJcblx0XHRcdGNvbnRyb2xsZXJBczogJ2Rhc2hib2FyZEN0cmwnXHJcblx0XHR9KTtcclxuXHJcblx0XHQkc3RhdGVQcm92aWRlci5zdGF0ZSgncm9vdC5jb3Vyc2UnLCB7XHJcblx0XHRcdHVybDogJy9jb3Vyc2UvOmNvdXJzZUNvZGUnLFxyXG5cdFx0XHR0ZW1wbGF0ZVVybDogJy9hbmd1bGFyL2NvdXJzZXMvcGFydGlhbHMvY291cnNlLmh0bWwnLFxyXG5cdFx0XHRjb250cm9sbGVyOiAnQ291cnNlQ29udHJvbGxlcicsXHJcblx0XHRcdGNvbnRyb2xsZXJBczogJ2NvdXJzZUN0cmwnXHJcblx0XHR9KTtcclxuXHR9XSk7XHJcbn0pKCk7IiwiKGZ1bmN0aW9uKCl7XHJcblx0YW5ndWxhci5tb2R1bGUoJ2NvdXJzZXMnKS5mYWN0b3J5KCdDb3Vyc2VTZXJ2aWNlJywgZnVuY3Rpb24gKCRodHRwKSB7XHJcblx0XHR0aGlzLmNyZWF0ZUNvdXJzZSA9IGZ1bmN0aW9uKG5ld0NvdXJzZSkge1xyXG5cdFx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9jb3Vyc2UvY3JlYXRlJywgbmV3Q291cnNlKTtcclxuXHRcdH07XHJcblxyXG5cdFx0dGhpcy5nZXRDb3Vyc2VzID0gZnVuY3Rpb24oKXtcclxuXHRcdFx0cmV0dXJuICRodHRwLmdldCgnL2FwaS9wcm9maWxlL2NvdXJzZXMnKTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLmdldENvdXJzZSA9IGZ1bmN0aW9uKGNvdXJzZUNvZGUpe1xyXG5cdFx0XHRyZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL2NvdXJzZS8nICsgY291cnNlQ29kZSk7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5jcmVhdGVBc3NpZ25tZW50ID0gZnVuY3Rpb24oY291cnNlQ29kZSwgbmV3QXNzaWdubWVudCl7XHJcblx0XHRcdGNvbnNvbGUubG9nKCdoZWxsbycpXHJcblx0XHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL2NvdXJzZS8nICsgY291cnNlQ29kZSArICcvYXNzaWdubWVudC9jcmVhdGUnLCBuZXdBc3NpZ25tZW50KTtcclxuXHRcdH07XHJcblxyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fSk7XHJcbn0pKCk7IiwiKGZ1bmN0aW9uKCl7XHJcblx0YW5ndWxhci5tb2R1bGUoJ2dlbmVyYWwnKS5jb250cm9sbGVyKCdOYXZDb250cm9sbGVyJywgZnVuY3Rpb24oJGh0dHAsIEF1dGhTZXJ2aWNlLCBBdXRoUmVzb2x2ZXIsICRzdGF0ZSl7XHJcblx0XHR2YXIgcm9vdCA9IHRoaXM7XHJcblx0XHR0aGlzLiRzdGF0ZSA9ICRzdGF0ZTtcclxuXHRcdHRoaXMuYkxvZ2dlZEluID0gbnVsbDtcclxuXHRcdFxyXG5cdFx0aWYgKEF1dGhSZXNvbHZlci5iSXNSZXNvbHZlZCgpKXtcclxuXHRcdFx0cm9vdC5iTG9nZ2VkSW4gPSBBdXRoU2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKTtcclxuXHRcdH1lbHNle1xyXG5cdFx0XHRBdXRoUmVzb2x2ZXIucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24oKXtcclxuXHRcdFx0XHRyb290LmJMb2dnZWRJbiA9IEF1dGhTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCgpO1xyXG5cdFx0XHR9KTtcclxuXHRcdH1cclxuXHR9KTtcclxufSkoKTsiLCIoZnVuY3Rpb24oKXtcclxuXHRhbmd1bGFyLm1vZHVsZSgnZ2VuZXJhbCcpLmNvbmZpZyhmdW5jdGlvbigkc3RhdGVQcm92aWRlcil7XHJcblxyXG5cdFx0JHN0YXRlUHJvdmlkZXJcclxuXHRcdC5zdGF0ZSgncm9vdCcsIHtcclxuXHRcdFx0YWJzdHJhY3Q6IHRydWUsXHJcblx0XHRcdHRlbXBsYXRlOiAnPHVpLXZpZXcvPicsXHJcblx0XHRcdHJlc29sdmU6IHtcclxuXHRcdFx0XHRhdXRoOiBmdW5jdGlvbiByZXNvbHZlQXV0aGVudGljYXRpb24oQXV0aFJlc29sdmVyKSB7IFxyXG5cdFx0XHRcdFx0cmV0dXJuIChBdXRoUmVzb2x2ZXIuYklzUmVzb2x2ZWQoKSA9PT0gdHJ1ZSB8fCBBdXRoUmVzb2x2ZXIucmVzb2x2ZSgpKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0pXHJcblxyXG5cdFx0LnN0YXRlKCdyb290Lm1haW4nLCB7XHJcblx0XHRcdHVybDogJy8nLFxyXG5cdFx0XHR0ZW1wbGF0ZTogJzx1aS12aWV3Lz4nLFxyXG5cdFx0XHRjb250cm9sbGVyOiBmdW5jdGlvbigkc3RhdGUsIEF1dGhTZXJ2aWNlKXtcclxuXHRcdFx0XHRpZiAoQXV0aFNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCkpe1xyXG5cdFx0XHRcdFx0JHN0YXRlLmdvKCdyb290Lm1haW4uZGFzaGJvYXJkJyk7XHJcblx0XHRcdFx0fWVsc2V7XHJcblx0XHRcdFx0XHQkc3RhdGUuZ28oJ3Jvb3QubWFpbi5wdWJsaWMnKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0pXHJcblxyXG5cdFx0LnN0YXRlKCdyb290Lm1haW4ucHVibGljJywge1xyXG5cdFx0XHR0ZW1wbGF0ZVVybDogJy9hbmd1bGFyL2dlbmVyYWwvcGFydGlhbHMvaW5kZXguaHRtbCcsXHJcblx0XHRcdGNvbnRyb2xsZXI6IGZ1bmN0aW9uKCl7XHJcblx0XHRcdFx0Y29uc29sZS5sb2coJ0hpdCBwdWJsaWMgaW5kZXgnKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fSk7XHJcbn0pKCk7IiwiKGZ1bmN0aW9uKCl7XHJcblx0YW5ndWxhci5tb2R1bGUoJ3VzZXInKS5jb250cm9sbGVyKCdMb2dpbkNvbnRyb2xsZXInLCBmdW5jdGlvbigkc3RhdGUsICRyb290U2NvcGUsIEF1dGhTZXJ2aWNlKXtcclxuXHRcdHZhciByb290ID0gdGhpcztcclxuXHRcdHRoaXMuYXV0aE1lc3NhZ2UgPSAnJztcclxuXHRcdHRoaXMudXNlciA9IHtcclxuXHRcdFx0ZW1haWw6ICcnLFxyXG5cdFx0XHRwYXNzd29yZDogJydcclxuXHRcdH07XHJcblxyXG5cdFx0dGhpcy5sb2dpbiA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRBdXRoU2VydmljZS5sb2dpbihyb290LnVzZXIpLnRoZW4oXHJcblx0XHRcdFx0ZnVuY3Rpb24ocmVzKXtcclxuXHRcdFx0XHRcdCRzdGF0ZS5nbygncm9vdC5tYWluJyk7XHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHRmdW5jdGlvbihyZXMpe1xyXG5cdFx0XHRcdFx0cm9vdC5hdXRoTWVzc2FnZSA9IHJlcy5kYXRhLnVzZXJNZXNzYWdlO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0fTtcclxuXHR9KTtcclxuXHRcclxuXHRhbmd1bGFyLm1vZHVsZSgndXNlcicpLmNvbnRyb2xsZXIoJ0pvaW5Db250cm9sbGVyJywgZnVuY3Rpb24oJHN0YXRlLCAkcm9vdFNjb3BlLCBBdXRoU2VydmljZSl7XHJcblx0XHR2YXIgcm9vdCA9IHRoaXM7XHJcblx0XHR0aGlzLmF1dGhNZXNzYWdlID0gJyc7XHJcblx0XHR0aGlzLnVzZXIgPSB7XHJcblx0XHRcdGZpcnN0TmFtZTogJycsXHJcblx0XHRcdGxhc3ROYW1lOiAnJyxcclxuXHRcdFx0cmV0eXBlUGFzc3dvcmQ6ICcnLCBcclxuXHRcdFx0cGFzc3dvcmQ6ICcnLFxyXG5cdFx0XHRlbWFpbDogJycsXHJcblx0XHRcdGFjY291bnRUeXBlOiAnJ1xyXG5cdFx0fTtcclxuXHJcblx0XHR0aGlzLnNpZ251cCA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRBdXRoU2VydmljZS5zaWdudXAocm9vdC51c2VyKS50aGVuKFxyXG5cdFx0XHRcdGZ1bmN0aW9uKHJlcyl7XHJcblx0XHRcdFx0XHQkc3RhdGUuZ28oJ3Jvb3QubWFpbicpO1xyXG5cdFx0XHRcdH0sXHJcblx0XHRcdFx0ZnVuY3Rpb24ocmVzKXtcclxuXHRcdFx0XHRcdHJvb3QuYXV0aE1lc3NhZ2UgPSByZXMuZGF0YS51c2VyTWVzc2FnZTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdH07XHJcblx0fSk7XHJcblxyXG5cdGFuZ3VsYXIubW9kdWxlKCd1c2VyJykuY29udHJvbGxlcignUHJvZmlsZUNvbnRyb2xsZXInLCBmdW5jdGlvbigkc3RhdGUsIFNlc3Npb24pe1xyXG5cdFx0dGhpcy51c2VyID0gU2Vzc2lvbi51c2VyO1xyXG5cdH0pO1xyXG59KSgpOyIsIihmdW5jdGlvbigpe1xyXG5cdGFuZ3VsYXIubW9kdWxlKCd1c2VyJykuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbigkc3RhdGVQcm92aWRlcil7XHJcblx0XHQkc3RhdGVQcm92aWRlci5zdGF0ZSgncm9vdC5sb2dpbicsIHtcclxuXHRcdFx0dXJsOiAnL2xvZ2luJyxcclxuXHRcdFx0dGVtcGxhdGVVcmw6ICcvYW5ndWxhci91c2VyL3BhcnRpYWxzL2xvZ2luLmh0bWwnLFxyXG5cdFx0XHRjb250cm9sbGVyOiAnTG9naW5Db250cm9sbGVyJyxcclxuXHRcdFx0Y29udHJvbGxlckFzOiAnbG9naW5DdHJsJ1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0JHN0YXRlUHJvdmlkZXIuc3RhdGUoJ3Jvb3Quam9pbicsIHtcclxuXHRcdFx0dXJsOiAnL2pvaW4nLFxyXG5cdFx0XHR0ZW1wbGF0ZVVybDogJy9hbmd1bGFyL3VzZXIvcGFydGlhbHMvam9pbi5odG1sJyxcclxuXHRcdFx0Y29udHJvbGxlcjogJ0pvaW5Db250cm9sbGVyJyxcclxuXHRcdFx0Y29udHJvbGxlckFzOiAnam9pbkN0cmwnXHJcblx0XHR9KTtcclxuXHRcdFxyXG5cdFx0JHN0YXRlUHJvdmlkZXIuc3RhdGUoJ3Jvb3QucHJvZmlsZScsIHtcclxuXHRcdFx0dXJsOiAnL3Byb2ZpbGUnLFxyXG5cdFx0XHR0ZW1wbGF0ZVVybDogJy9hbmd1bGFyL3VzZXIvcGFydGlhbHMvcHJvZmlsZS5odG1sJyxcclxuXHRcdFx0Y29udHJvbGxlcjogJ1Byb2ZpbGVDb250cm9sbGVyJyxcclxuXHRcdFx0Y29udHJvbGxlckFzOiAncHJvZmlsZUN0cmwnXHJcblx0XHR9KTtcclxuXHR9XSk7XHJcbn0pKCk7IiwiKGZ1bmN0aW9uKCl7XHJcblx0YW5ndWxhci5tb2R1bGUoJ3VzZXInKS5mYWN0b3J5KCdBdXRoU2VydmljZScsIGZ1bmN0aW9uICgkaHR0cCwgU2Vzc2lvbikge1xyXG5cdFx0dmFyIGF1dGhTZXJ2aWNlID0ge307XHJcblx0XHR2YXIgdXNlciA9IHt9O1xyXG5cclxuXHRcdGF1dGhTZXJ2aWNlLmxvZ2luID0gZnVuY3Rpb24oY3JlZGVudGlhbHMpIHtcclxuXHRcdFx0cmV0dXJuICRodHRwXHJcblx0XHRcdC5wb3N0KCcvYXV0aC9sb2NhbCcsIGNyZWRlbnRpYWxzKVxyXG5cdFx0XHQudGhlbihmdW5jdGlvbiAocmVzKSB7XHJcblx0XHRcdFx0U2Vzc2lvbi5jcmVhdGUocmVzLmRhdGEpO1xyXG5cdFx0XHRcdHJldHVybiByZXMuZGF0YTtcclxuXHRcdFx0fSk7XHJcblx0XHR9O1xyXG5cclxuXHRcdGF1dGhTZXJ2aWNlLnNpZ251cCA9IGZ1bmN0aW9uKG5ld1VzZXIpe1xyXG5cdFx0XHRyZXR1cm4gJGh0dHBcclxuXHRcdFx0LnBvc3QoJy9hcGkvdXNlci9qb2luJywgbmV3VXNlcilcclxuXHRcdFx0LnRoZW4oXHJcblx0XHRcdGZ1bmN0aW9uIFN1Y2Nlc3MocmVzKXtcclxuXHRcdFx0XHRjb25zb2xlLmxvZyhyZXMuZGF0YSk7XHJcblx0XHRcdFx0U2Vzc2lvbi5jcmVhdGUocmVzLmRhdGEpO1xyXG5cdFx0XHRcdHJldHVybiByZXMuZGF0YTtcclxuXHRcdFx0fSwgZnVuY3Rpb24gRmFpbHVyZShyZXMpe1xyXG5cdFx0XHRcdHJldHVybiByZXMuZGF0YTtcclxuXHRcdFx0fSk7XHJcblx0XHR9O1xyXG5cclxuXHRcdGF1dGhTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRyZXR1cm4gU2Vzc2lvbi5saXZlKCk7XHJcblx0XHR9O1xyXG5cclxuXHRcdHJldHVybiBhdXRoU2VydmljZTtcclxuXHR9KTtcclxuXHJcblx0YW5ndWxhci5tb2R1bGUoJ3VzZXInKS5zZXJ2aWNlKCdTZXNzaW9uJywgZnVuY3Rpb24gKCRyb290U2NvcGUpIHtcclxuXHRcdHZhciByb290ID0gdGhpcztcclxuXHRcdHRoaXMudXNlciA9IHt9O1xyXG5cclxuXHRcdHRoaXMubGl2ZSA9IGZ1bmN0aW9uKCl7XHJcblx0XHRcdHJldHVybiAoT2JqZWN0LmtleXMocm9vdC51c2VyKS5sZW5ndGggPiAwKTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLnNldEN1cnJlbnRVc2VyID0gZnVuY3Rpb24odXNlcil7XHJcblx0XHRcdCRyb290U2NvcGUuY3VycmVudFVzZXIgPSB1c2VyO1xyXG5cdFx0XHRyb290LnVzZXIgPSB1c2VyO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuY3JlYXRlID0gZnVuY3Rpb24odXNlcil7XHJcblx0XHRcdCRyb290U2NvcGUuY3VycmVudFVzZXIgPSB1c2VyO1xyXG5cdFx0XHRyb290LnVzZXIgPSB1c2VyO1xyXG5cdFx0fTtcclxuXHJcblx0XHR0aGlzLmRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdCRyb290U2NvcGUuY3VycmVudFVzZXIgPSBudWxsO1xyXG5cdFx0XHRyb290LnVzZXIgPSBudWxsO1xyXG5cdFx0fTtcclxuXHR9KTtcclxuXHJcblx0YW5ndWxhci5tb2R1bGUoJ3VzZXInKS5mYWN0b3J5KCdBdXRoUmVzb2x2ZXInLCBmdW5jdGlvbigkcSwgJHJvb3RTY29wZSwgJHN0YXRlKSB7XHJcblx0XHR2YXIgYklzUmVzb2x2ZWQgPSBmYWxzZTtcclxuXHJcblx0XHRyZXR1cm4ge1xyXG5cdFx0XHRyZXNvbHZlOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdFx0dmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcclxuXHRcdFx0XHR2YXIgdW53YXRjaCA9ICRyb290U2NvcGUuJHdhdGNoKCdjdXJyZW50VXNlcicsIGZ1bmN0aW9uIChjdXJyZW50VXNlcikge1xyXG5cdFx0XHRcdFx0aWYgKGFuZ3VsYXIuaXNEZWZpbmVkKGN1cnJlbnRVc2VyKSkge1xyXG5cdFx0XHRcdFx0XHRpZiAoY3VycmVudFVzZXIpIHtcclxuXHRcdFx0XHRcdFx0XHRkZWZlcnJlZC5yZXNvbHZlKGN1cnJlbnRVc2VyKTtcclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRkZWZlcnJlZC5yZWplY3QoKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRiSXNSZXNvbHZlZCA9IHRydWU7XHJcblx0XHRcdFx0XHRcdHVud2F0Y2goKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHRyZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcclxuXHRcdFx0fSxcclxuXHJcblx0XHRcdGJJc1Jlc29sdmVkOiBmdW5jdGlvbigpe1xyXG5cdFx0XHRcdHJldHVybiBiSXNSZXNvbHZlZDtcclxuXHRcdFx0fVxyXG5cdFx0fTtcclxuXHR9KTtcclxufSkoKTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
