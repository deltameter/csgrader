!function(){angular.module("general",[])}(),function(){angular.module("user",[]).run(["$http","Session",function($http,Session){$http.get("/api/profile").success(function(res){Session.create(res)}).error(function(res){Session.setCurrentUser({})})}])}(),function(){var app=angular.module("grader",["ui.router","general","user"]);app.config(["$locationProvider",function($locationProvider){$locationProvider.html5Mode(!0)}]),app.run(["$rootScope","AuthService","AuthResolver",function($rootScope,AuthService,AuthResolver){$rootScope.$on("$stateChangeStart",function(event,next){AuthResolver.bIsResolved()?(console.log("stateChangeStart resolved"),console.log("auth: "+AuthService.isAuthenticated())):AuthResolver.resolve().then(function(data){console.log("stateChangeStart not resolved"),console.log("auth: "+AuthService.isAuthenticated())})})}])}(),function(){angular.module("general").controller("NavController",["$http","AuthService","AuthResolver","$state",function($http,AuthService,AuthResolver,$state){var root=this;this.$state=$state,this.bLoggedIn=null,AuthResolver.bIsResolved()?root.bLoggedIn=AuthService.isAuthenticated():AuthResolver.resolve().then(function(){root.bLoggedIn=AuthService.isAuthenticated()})}])}(),function(){angular.module("general").config(["$stateProvider",function($stateProvider){$stateProvider.state("root",{"abstract":!0,template:"<ui-view/>",resolve:{auth:["AuthResolver",function(AuthResolver){return AuthResolver.bIsResolved()===!0||AuthResolver.resolve()}]}}).state("root.main",{url:"/",template:"<ui-view/>",controller:["$state","AuthService",function($state,AuthService){console.log("hi"),AuthService.isAuthenticated()?$state.go("root.dashboard"):$state.go("root.public")}]}).state("root.public",{templateUrl:"/angular/general/partials/index.html"})}])}(),function(){angular.module("user").controller("LoginController",["$state","$rootScope","AuthService",function($state,$rootScope,AuthService){var root=this;this.authMessage="",this.user={email:"",password:""},this.login=function(){AuthService.login(root.user).then(function(res){$state.go("root.profile")},function(res){root.authMessage=res.data.userMessage})}}]),angular.module("user").controller("JoinController",["$state","$rootScope","AuthService",function($state,$rootScope,AuthService){var root=this;this.authMessage="",this.user={firstName:"",lastName:"",retypePassword:"",password:"",email:"",accountType:""},this.signup=function(){AuthService.signup(root.user).then(function(res){$state.go("root.profile")},function(res){root.authMessage=res.data.userMessage})}}]),angular.module("user").controller("DashboardController",["$state","Session",function($state,Session){this.user=Session.user}]),angular.module("user").controller("ProfileController",["$state","Session",function($state,Session){this.user=Session.user}])}(),function(){angular.module("user").config(["$stateProvider",function($stateProvider){$stateProvider.state("root.login",{url:"/login",templateUrl:"/angular/user/partials/login.html",controller:"LoginController",controllerAs:"loginCtrl"}),$stateProvider.state("root.join",{url:"/join",templateUrl:"/angular/user/partials/join.html",controller:"JoinController",controllerAs:"joinCtrl"}),$stateProvider.state("root.dashboard",{templateUrl:"/angular/user/partials/dashboard.html",controller:"DashboardController",controllerAs:"dashboardCtrl"}),$stateProvider.state("root.profile",{url:"/profile",templateUrl:"/angular/user/partials/profile.html",controller:"ProfileController",controllerAs:"profileCtrl"})}])}(),function(){angular.module("user").factory("AuthService",["$http","Session",function($http,Session){var authService={};return authService.login=function(credentials){return $http.post("/auth/local",credentials).then(function(res){return Session.create(res.data),res.data})},authService.signup=function(newUser){return $http.post("/api/user/join",newUser).then(function(res){return console.log(res.data),Session.create(res.data),res.data},function(res){return res.data})},authService.isAuthenticated=function(){return Session.live()},authService}]),angular.module("user").service("Session",["$rootScope",function($rootScope){var root=this;this.user={},this.live=function(){return Object.keys(root.user).length>0},this.setCurrentUser=function(user){$rootScope.currentUser=user},this.create=function(user){$rootScope.currentUser=user,root.user=user},this.destroy=function(){$rootScope.currentUser=null,root.user=null}}]),angular.module("user").factory("AuthResolver",["$q","$rootScope","$state",function($q,$rootScope,$state){var bIsResolved=!1;return{resolve:function(){var deferred=$q.defer(),unwatch=$rootScope.$watch("currentUser",function(currentUser){angular.isDefined(currentUser)&&(currentUser?deferred.resolve(currentUser):deferred.reject(),bIsResolved=!0,unwatch())});return deferred.promise},bIsResolved:function(){return bIsResolved}}}])}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdlbmVyYWwvZ2VuZXJhbC5tb2R1bGUuanMiLCJ1c2VyL3VzZXIubW9kdWxlLmpzIiwiY29yZS5qcyIsImdlbmVyYWwvZ2VuZXJhbC5jdHJsLmpzIiwiZ2VuZXJhbC9nZW5lcmFsLnN0YXRlcy5qcyIsInVzZXIvdXNlci5jdHJsLmpzIiwidXNlci91c2VyLnN0YXRlcy5qcyIsInVzZXIvdXNlci5zdmMuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsInJ1biIsIiRodHRwIiwiU2Vzc2lvbiIsImdldCIsInN1Y2Nlc3MiLCJyZXMiLCJjcmVhdGUiLCJlcnJvciIsInNldEN1cnJlbnRVc2VyIiwiYXBwIiwiY29uZmlnIiwiJGxvY2F0aW9uUHJvdmlkZXIiLCJodG1sNU1vZGUiLCIkcm9vdFNjb3BlIiwiQXV0aFNlcnZpY2UiLCJBdXRoUmVzb2x2ZXIiLCIkb24iLCJldmVudCIsIm5leHQiLCJiSXNSZXNvbHZlZCIsImNvbnNvbGUiLCJsb2ciLCJpc0F1dGhlbnRpY2F0ZWQiLCJyZXNvbHZlIiwidGhlbiIsImRhdGEiLCJjb250cm9sbGVyIiwiJHN0YXRlIiwicm9vdCIsInRoaXMiLCJiTG9nZ2VkSW4iLCIkc3RhdGVQcm92aWRlciIsInN0YXRlIiwiYWJzdHJhY3QiLCJ0ZW1wbGF0ZSIsImF1dGgiLCJ1cmwiLCJnbyIsInRlbXBsYXRlVXJsIiwiYXV0aE1lc3NhZ2UiLCJ1c2VyIiwiZW1haWwiLCJwYXNzd29yZCIsImxvZ2luIiwidXNlck1lc3NhZ2UiLCJmaXJzdE5hbWUiLCJsYXN0TmFtZSIsInJldHlwZVBhc3N3b3JkIiwiYWNjb3VudFR5cGUiLCJzaWdudXAiLCJjb250cm9sbGVyQXMiLCJmYWN0b3J5IiwiYXV0aFNlcnZpY2UiLCJjcmVkZW50aWFscyIsInBvc3QiLCJuZXdVc2VyIiwibGl2ZSIsInNlcnZpY2UiLCJPYmplY3QiLCJrZXlzIiwibGVuZ3RoIiwiY3VycmVudFVzZXIiLCJkZXN0cm95IiwiJHEiLCJkZWZlcnJlZCIsImRlZmVy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LGVBQUEsU0FBQWdDLE1BQ0EzQixXQUFBZ0QsWUFBQXJCLE1BR0FYLEtBQUF2QixPQUFBLFNBQUFrQyxNQUNBM0IsV0FBQWdELFlBQUFyQixLQUNBWixLQUFBWSxLQUFBQSxNQUdBWCxLQUFBaUMsUUFBQSxXQUNBakQsV0FBQWdELFlBQUEsS0FDQWpDLEtBQUFZLEtBQUEsU0FJQTFDLFFBQUFDLE9BQUEsUUFBQW9ELFFBQUEsZ0JBQUEsS0FBQSxhQUFBLFNBQUEsU0FBQVksR0FBQWxELFdBQUFjLFFBQ0EsR0FBQVIsY0FBQSxDQUVBLFFBQ0FJLFFBQUEsV0FDQSxHQUFBeUMsVUFBQUQsR0FBQUUsUUFDQUMsUUFBQXJELFdBQUFzRCxPQUFBLGNBQUEsU0FBQU4sYUFDQS9ELFFBQUFzRSxVQUFBUCxlQUNBQSxZQUNBRyxTQUFBekMsUUFBQXNDLGFBRUFHLFNBQUFLLFNBRUFsRCxhQUFBLEVBQ0ErQyxZQUdBLE9BQUFGLFVBQUFNLFNBR0FuRCxZQUFBLFdBQ0EsTUFBQUEiLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe1xyXG5cdHZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnZ2VuZXJhbCcsIFtdKTtcclxufSkoKTsiLCIoZnVuY3Rpb24oKXtcclxuXHR2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ3VzZXInLCBbXSlcclxuXHQucnVuKGZ1bmN0aW9uKCRodHRwLCBTZXNzaW9uKXtcclxuXHRcdCRodHRwLmdldCgnL2FwaS9wcm9maWxlJylcclxuXHRcdC5zdWNjZXNzKGZ1bmN0aW9uKHJlcyl7XHJcblx0XHRcdFNlc3Npb24uY3JlYXRlKHJlcyk7XHJcblx0XHR9KVxyXG5cdFx0LmVycm9yKGZ1bmN0aW9uKHJlcyl7XHJcblx0XHRcdFNlc3Npb24uc2V0Q3VycmVudFVzZXIoe30pO1xyXG5cdFx0fSk7XHJcblx0fSk7XHJcbn0pKCk7IiwiKGZ1bmN0aW9uKCl7XHJcblx0dmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdncmFkZXInLCBcclxuXHRcdFtcclxuXHRcdFx0J3VpLnJvdXRlcicsXHJcblx0XHRcdCdnZW5lcmFsJyxcclxuXHRcdFx0J3VzZXInXHJcblx0XHRdKTtcclxuXHJcblx0Ly9yZW1vdmUgdGhlIGhhc2hcclxuXHRhcHAuY29uZmlnKFsnJGxvY2F0aW9uUHJvdmlkZXInLCBmdW5jdGlvbigkbG9jYXRpb25Qcm92aWRlcil7XHJcblx0XHQkbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUodHJ1ZSk7XHJcblx0fV0pO1xyXG5cdFxyXG5cdGFwcC5ydW4oZnVuY3Rpb24gKCRyb290U2NvcGUsIEF1dGhTZXJ2aWNlLCBBdXRoUmVzb2x2ZXIpIHtcclxuICBcdFx0JHJvb3RTY29wZS4kb24oJyRzdGF0ZUNoYW5nZVN0YXJ0JywgZnVuY3Rpb24gKGV2ZW50LCBuZXh0KSB7XHJcbiAgXHRcdFx0aWYgKEF1dGhSZXNvbHZlci5iSXNSZXNvbHZlZCgpKXtcclxuICBcdFx0XHRcdGNvbnNvbGUubG9nKCdzdGF0ZUNoYW5nZVN0YXJ0IHJlc29sdmVkJyk7XHJcbiAgXHRcdFx0XHRjb25zb2xlLmxvZygnYXV0aDogJyArIEF1dGhTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCgpKTtcclxuICBcdFx0XHR9ZWxzZXtcclxuICBcdFx0XHRcdEF1dGhSZXNvbHZlci5yZXNvbHZlKCkudGhlbihmdW5jdGlvbihkYXRhKXtcclxuICBcdFx0XHRcdFx0Y29uc29sZS5sb2coJ3N0YXRlQ2hhbmdlU3RhcnQgbm90IHJlc29sdmVkJyk7XHJcbiAgXHRcdFx0XHRcdGNvbnNvbGUubG9nKCdhdXRoOiAnICsgQXV0aFNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCkpO1xyXG4gIFx0XHRcdFx0fSlcclxuICBcdFx0XHR9XHJcbiAgXHRcdH0pO1xyXG5cdH0pXHJcblxyXG59KSgpOyIsIihmdW5jdGlvbigpe1xyXG5cdGFuZ3VsYXIubW9kdWxlKCdnZW5lcmFsJykuY29udHJvbGxlcignTmF2Q29udHJvbGxlcicsIGZ1bmN0aW9uKCRodHRwLCBBdXRoU2VydmljZSwgQXV0aFJlc29sdmVyLCAkc3RhdGUpe1xyXG5cdFx0dmFyIHJvb3QgPSB0aGlzO1xyXG5cdFx0dGhpcy4kc3RhdGUgPSAkc3RhdGU7XHJcblx0XHR0aGlzLmJMb2dnZWRJbiA9IG51bGw7XHJcblx0XHRcclxuXHRcdGlmIChBdXRoUmVzb2x2ZXIuYklzUmVzb2x2ZWQoKSl7XHJcblx0XHRcdHJvb3QuYkxvZ2dlZEluID0gQXV0aFNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCk7XHJcblx0XHR9ZWxzZXtcclxuXHRcdFx0QXV0aFJlc29sdmVyLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uKCl7XHJcblx0XHRcdFx0cm9vdC5iTG9nZ2VkSW4gPSBBdXRoU2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKTtcclxuXHRcdFx0fSk7XHJcblx0XHR9XHJcblx0fSk7XHJcbn0pKCk7IiwiKGZ1bmN0aW9uKCl7XHJcblx0YW5ndWxhci5tb2R1bGUoJ2dlbmVyYWwnKS5jb25maWcoZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIpe1xyXG5cclxuXHRcdCRzdGF0ZVByb3ZpZGVyXHJcblx0XHQuc3RhdGUoJ3Jvb3QnLCB7XHJcblx0XHRcdGFic3RyYWN0OiB0cnVlLFxyXG5cdFx0XHR0ZW1wbGF0ZTogJzx1aS12aWV3Lz4nLFxyXG5cdFx0XHRyZXNvbHZlOiB7XHJcblx0XHRcdFx0YXV0aDogZnVuY3Rpb24gcmVzb2x2ZUF1dGhlbnRpY2F0aW9uKEF1dGhSZXNvbHZlcikgeyBcclxuXHRcdFx0XHRcdHJldHVybiAoQXV0aFJlc29sdmVyLmJJc1Jlc29sdmVkKCkgPT09IHRydWUgfHwgQXV0aFJlc29sdmVyLnJlc29sdmUoKSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9KVxyXG5cclxuXHRcdC5zdGF0ZSgncm9vdC5tYWluJywge1xyXG5cdFx0XHR1cmw6ICcvJyxcclxuXHRcdFx0dGVtcGxhdGU6ICc8dWktdmlldy8+JyxcclxuXHRcdFx0Y29udHJvbGxlcjogZnVuY3Rpb24oJHN0YXRlLCBBdXRoU2VydmljZSl7XHJcblx0XHRcdFx0Y29uc29sZS5sb2coJ2hpJyk7XHJcblx0XHRcdFx0aWYgKEF1dGhTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCgpKXtcclxuXHRcdFx0XHRcdCRzdGF0ZS5nbygncm9vdC5kYXNoYm9hcmQnKTtcclxuXHRcdFx0XHR9ZWxzZXtcclxuXHRcdFx0XHRcdCRzdGF0ZS5nbygncm9vdC5wdWJsaWMnKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0pXHJcblxyXG5cdFx0LnN0YXRlKCdyb290LnB1YmxpYycsIHtcclxuXHRcdFx0dGVtcGxhdGVVcmw6ICcvYW5ndWxhci9nZW5lcmFsL3BhcnRpYWxzL2luZGV4Lmh0bWwnXHJcblx0XHR9KTtcclxuXHJcblx0fSk7XHJcbn0pKCk7IiwiKGZ1bmN0aW9uKCl7XHJcblxyXG5cdGFuZ3VsYXIubW9kdWxlKCd1c2VyJykuY29udHJvbGxlcignTG9naW5Db250cm9sbGVyJywgZnVuY3Rpb24oJHN0YXRlLCAkcm9vdFNjb3BlLCBBdXRoU2VydmljZSl7XHJcblx0XHR2YXIgcm9vdCA9IHRoaXM7XHJcblx0XHR0aGlzLmF1dGhNZXNzYWdlID0gJyc7XHJcblx0XHR0aGlzLnVzZXIgPSB7XHJcblx0XHRcdGVtYWlsOiAnJyxcclxuXHRcdFx0cGFzc3dvcmQ6ICcnXHJcblx0XHR9O1xyXG5cclxuXHRcdHRoaXMubG9naW4gPSBmdW5jdGlvbigpIHtcclxuXHRcdFx0QXV0aFNlcnZpY2UubG9naW4ocm9vdC51c2VyKS50aGVuKFxyXG5cdFx0XHRcdGZ1bmN0aW9uKHJlcyl7XHJcblx0XHRcdFx0XHQkc3RhdGUuZ28oJ3Jvb3QucHJvZmlsZScpO1xyXG5cdFx0XHRcdH0sXHJcblx0XHRcdFx0ZnVuY3Rpb24ocmVzKXtcclxuXHRcdFx0XHRcdHJvb3QuYXV0aE1lc3NhZ2UgPSByZXMuZGF0YS51c2VyTWVzc2FnZTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdH07XHJcblx0fSk7XHJcblx0XHJcblx0YW5ndWxhci5tb2R1bGUoJ3VzZXInKS5jb250cm9sbGVyKCdKb2luQ29udHJvbGxlcicsIGZ1bmN0aW9uKCRzdGF0ZSwgJHJvb3RTY29wZSwgQXV0aFNlcnZpY2Upe1xyXG5cdFx0dmFyIHJvb3QgPSB0aGlzO1xyXG5cdFx0dGhpcy5hdXRoTWVzc2FnZSA9ICcnO1xyXG5cdFx0dGhpcy51c2VyID0ge1xyXG5cdFx0XHRmaXJzdE5hbWU6ICcnLFxyXG5cdFx0XHRsYXN0TmFtZTogJycsXHJcblx0XHRcdHJldHlwZVBhc3N3b3JkOiAnJywgXHJcblx0XHRcdHBhc3N3b3JkOiAnJyxcclxuXHRcdFx0ZW1haWw6ICcnLFxyXG5cdFx0XHRhY2NvdW50VHlwZTogJydcclxuXHRcdH07XHJcblxyXG5cdFx0dGhpcy5zaWdudXAgPSBmdW5jdGlvbigpIHtcclxuXHRcdFx0QXV0aFNlcnZpY2Uuc2lnbnVwKHJvb3QudXNlcikudGhlbihcclxuXHRcdFx0XHRmdW5jdGlvbihyZXMpe1xyXG5cdFx0XHRcdFx0JHN0YXRlLmdvKCdyb290LnByb2ZpbGUnKTtcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdGZ1bmN0aW9uKHJlcyl7XHJcblx0XHRcdFx0XHRyb290LmF1dGhNZXNzYWdlID0gcmVzLmRhdGEudXNlck1lc3NhZ2U7XHJcblx0XHRcdFx0fSk7XHJcblx0XHR9O1xyXG5cdH0pO1xyXG5cclxuXHRhbmd1bGFyLm1vZHVsZSgndXNlcicpLmNvbnRyb2xsZXIoJ0Rhc2hib2FyZENvbnRyb2xsZXInLCBmdW5jdGlvbigkc3RhdGUsIFNlc3Npb24pe1xyXG5cdFx0dGhpcy51c2VyID0gU2Vzc2lvbi51c2VyO1xyXG5cdH0pO1xyXG5cclxuXHRhbmd1bGFyLm1vZHVsZSgndXNlcicpLmNvbnRyb2xsZXIoJ1Byb2ZpbGVDb250cm9sbGVyJywgZnVuY3Rpb24oJHN0YXRlLCBTZXNzaW9uKXtcclxuXHRcdHRoaXMudXNlciA9IFNlc3Npb24udXNlcjtcclxuXHR9KTtcclxufSkoKTsiLCIoZnVuY3Rpb24oKXtcclxuXHRhbmd1bGFyLm1vZHVsZSgndXNlcicpLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIpe1xyXG5cdFx0JHN0YXRlUHJvdmlkZXIuc3RhdGUoJ3Jvb3QubG9naW4nLCB7XHJcblx0XHRcdHVybDogJy9sb2dpbicsXHJcblx0XHRcdHRlbXBsYXRlVXJsOiAnL2FuZ3VsYXIvdXNlci9wYXJ0aWFscy9sb2dpbi5odG1sJyxcclxuXHRcdFx0Y29udHJvbGxlcjogJ0xvZ2luQ29udHJvbGxlcicsXHJcblx0XHRcdGNvbnRyb2xsZXJBczogJ2xvZ2luQ3RybCdcclxuXHRcdH0pO1xyXG5cclxuXHRcdCRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdyb290LmpvaW4nLCB7XHJcblx0XHRcdHVybDogJy9qb2luJyxcclxuXHRcdFx0dGVtcGxhdGVVcmw6ICcvYW5ndWxhci91c2VyL3BhcnRpYWxzL2pvaW4uaHRtbCcsXHJcblx0XHRcdGNvbnRyb2xsZXI6ICdKb2luQ29udHJvbGxlcicsXHJcblx0XHRcdGNvbnRyb2xsZXJBczogJ2pvaW5DdHJsJ1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0JHN0YXRlUHJvdmlkZXIuc3RhdGUoJ3Jvb3QuZGFzaGJvYXJkJywge1xyXG5cdFx0XHR0ZW1wbGF0ZVVybDogJy9hbmd1bGFyL3VzZXIvcGFydGlhbHMvZGFzaGJvYXJkLmh0bWwnLFxyXG5cdFx0XHRjb250cm9sbGVyOiAnRGFzaGJvYXJkQ29udHJvbGxlcicsXHJcblx0XHRcdGNvbnRyb2xsZXJBczogJ2Rhc2hib2FyZEN0cmwnXHJcblx0XHR9KTtcclxuXHJcblx0XHQkc3RhdGVQcm92aWRlci5zdGF0ZSgncm9vdC5wcm9maWxlJywge1xyXG5cdFx0XHR1cmw6ICcvcHJvZmlsZScsXHJcblx0XHRcdHRlbXBsYXRlVXJsOiAnL2FuZ3VsYXIvdXNlci9wYXJ0aWFscy9wcm9maWxlLmh0bWwnLFxyXG5cdFx0XHRjb250cm9sbGVyOiAnUHJvZmlsZUNvbnRyb2xsZXInLFxyXG5cdFx0XHRjb250cm9sbGVyQXM6ICdwcm9maWxlQ3RybCdcclxuXHRcdH0pO1xyXG5cdH1dKTtcclxufSkoKTsiLCIoZnVuY3Rpb24oKXtcclxuXHRhbmd1bGFyLm1vZHVsZSgndXNlcicpLmZhY3RvcnkoJ0F1dGhTZXJ2aWNlJywgZnVuY3Rpb24gKCRodHRwLCBTZXNzaW9uKSB7XHJcblx0XHR2YXIgYXV0aFNlcnZpY2UgPSB7fTtcclxuXHRcdHZhciB1c2VyID0ge307XHJcblxyXG5cdFx0YXV0aFNlcnZpY2UubG9naW4gPSBmdW5jdGlvbihjcmVkZW50aWFscykge1xyXG5cdFx0XHRyZXR1cm4gJGh0dHBcclxuXHRcdFx0LnBvc3QoJy9hdXRoL2xvY2FsJywgY3JlZGVudGlhbHMpXHJcblx0XHRcdC50aGVuKGZ1bmN0aW9uIChyZXMpIHtcclxuXHRcdFx0XHRTZXNzaW9uLmNyZWF0ZShyZXMuZGF0YSk7XHJcblx0XHRcdFx0cmV0dXJuIHJlcy5kYXRhO1xyXG5cdFx0XHR9KTtcclxuXHRcdH07XHJcblxyXG5cdFx0YXV0aFNlcnZpY2Uuc2lnbnVwID0gZnVuY3Rpb24obmV3VXNlcil7XHJcblx0XHRcdHJldHVybiAkaHR0cFxyXG5cdFx0XHQucG9zdCgnL2FwaS91c2VyL2pvaW4nLCBuZXdVc2VyKVxyXG5cdFx0XHQudGhlbihcclxuXHRcdFx0ZnVuY3Rpb24gU3VjY2VzcyhyZXMpe1xyXG5cdFx0XHRcdGNvbnNvbGUubG9nKHJlcy5kYXRhKTtcclxuXHRcdFx0XHRTZXNzaW9uLmNyZWF0ZShyZXMuZGF0YSk7XHJcblx0XHRcdFx0cmV0dXJuIHJlcy5kYXRhO1xyXG5cdFx0XHR9LCBmdW5jdGlvbiBGYWlsdXJlKHJlcyl7XHJcblx0XHRcdFx0cmV0dXJuIHJlcy5kYXRhO1xyXG5cdFx0XHR9KTtcclxuXHRcdH07XHJcblxyXG5cdFx0YXV0aFNlcnZpY2UuaXNBdXRoZW50aWNhdGVkID0gZnVuY3Rpb24oKSB7XHJcblx0XHRcdHJldHVybiBTZXNzaW9uLmxpdmUoKTtcclxuXHRcdH07XHJcblxyXG5cdFx0cmV0dXJuIGF1dGhTZXJ2aWNlO1xyXG5cdH0pO1xyXG5cclxuXHRhbmd1bGFyLm1vZHVsZSgndXNlcicpLnNlcnZpY2UoJ1Nlc3Npb24nLCBmdW5jdGlvbiAoJHJvb3RTY29wZSkge1xyXG5cdFx0dmFyIHJvb3QgPSB0aGlzO1xyXG5cdFx0dGhpcy51c2VyID0ge307XHJcblxyXG5cdFx0dGhpcy5saXZlID0gZnVuY3Rpb24oKXtcclxuXHRcdFx0cmV0dXJuIChPYmplY3Qua2V5cyhyb290LnVzZXIpLmxlbmd0aCA+IDApO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuc2V0Q3VycmVudFVzZXIgPSBmdW5jdGlvbih1c2VyKXtcclxuXHRcdFx0JHJvb3RTY29wZS5jdXJyZW50VXNlciA9IHVzZXI7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5jcmVhdGUgPSBmdW5jdGlvbih1c2VyKXtcclxuXHRcdFx0JHJvb3RTY29wZS5jdXJyZW50VXNlciA9IHVzZXI7XHJcblx0XHRcdHJvb3QudXNlciA9IHVzZXI7XHJcblx0XHR9O1xyXG5cclxuXHRcdHRoaXMuZGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0JHJvb3RTY29wZS5jdXJyZW50VXNlciA9IG51bGw7XHJcblx0XHRcdHJvb3QudXNlciA9IG51bGw7XHJcblx0XHR9O1xyXG5cdH0pO1xyXG5cclxuXHRhbmd1bGFyLm1vZHVsZSgndXNlcicpLmZhY3RvcnkoJ0F1dGhSZXNvbHZlcicsIGZ1bmN0aW9uKCRxLCAkcm9vdFNjb3BlLCAkc3RhdGUpIHtcclxuXHRcdHZhciBiSXNSZXNvbHZlZCA9IGZhbHNlO1xyXG5cclxuXHRcdHJldHVybiB7XHJcblx0XHRcdHJlc29sdmU6IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0XHR2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xyXG5cdFx0XHRcdHZhciB1bndhdGNoID0gJHJvb3RTY29wZS4kd2F0Y2goJ2N1cnJlbnRVc2VyJywgZnVuY3Rpb24gKGN1cnJlbnRVc2VyKSB7XHJcblx0XHRcdFx0XHRpZiAoYW5ndWxhci5pc0RlZmluZWQoY3VycmVudFVzZXIpKSB7XHJcblx0XHRcdFx0XHRcdGlmIChjdXJyZW50VXNlcikge1xyXG5cdFx0XHRcdFx0XHRcdGRlZmVycmVkLnJlc29sdmUoY3VycmVudFVzZXIpO1xyXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdGRlZmVycmVkLnJlamVjdCgpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGJJc1Jlc29sdmVkID0gdHJ1ZTtcclxuXHRcdFx0XHRcdFx0dW53YXRjaCgpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHRcdHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xyXG5cdFx0XHR9LFxyXG5cclxuXHRcdFx0YklzUmVzb2x2ZWQ6IGZ1bmN0aW9uKCl7XHJcblx0XHRcdFx0cmV0dXJuIGJJc1Jlc29sdmVkO1xyXG5cdFx0XHR9XHJcblx0XHR9O1xyXG5cdH0pO1xyXG59KSgpOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
