!function(){angular.module("general",[])}(),function(){angular.module("courses",[])}(),angular.module("angularSlideables",[]).directive("slideable",function(){return{restrict:"C",compile:function(element,attr){var contents=element.html();return element.html('<div class="slideable_content" style="margin:0 !important; padding:0 !important" >'+contents+"</div>"),function(scope,element,attrs){attrs.duration=attrs.duration?attrs.duration:"1s",attrs.easing=attrs.easing?attrs.easing:"ease-in-out",element.css({overflow:"hidden",height:"0px",transitionProperty:"height",transitionDuration:attrs.duration,transitionTimingFunction:attrs.easing})}}}}).directive("slideToggle",function(){return{restrict:"A",link:function(scope,element,attrs){var target,content;attrs.expanded=!1,element.bind("click",function(){if(target||(target=document.querySelector(attrs.slideToggle)),content||(content=target.querySelector(".slideable_content")),attrs.expanded)target.style.height="0px";else{content.style.border="1px solid rgba(0,0,0,0)";var y=content.clientHeight;content.style.border=0,target.style.height=y+"px"}attrs.expanded=!attrs.expanded})}}}),function(){angular.module("user",[]).run(["$http","Session",function($http,Session){$http.get("/api/profile").success(function(res){Session.create(res)}).error(function(res){Session.setCurrentUser({})})}])}(),function(){var app=angular.module("grader",["ui.router","general","courses","user"]);app.config(["$locationProvider",function($locationProvider){$locationProvider.html5Mode(!0)}]),app.run(["$rootScope","AuthService","AuthResolver",function($rootScope,AuthService,AuthResolver){$rootScope.$on("$stateChangeStart",function(event,next){AuthResolver.bIsResolved()?(console.log("stateChangeStart resolved"),console.log("auth: "+AuthService.isAuthenticated())):AuthResolver.resolve().then(function(data){console.log("stateChangeStart not resolved"),console.log("auth: "+AuthService.isAuthenticated())})})}])}(),function(){angular.module("general").controller("NavController",["$http","AuthService","AuthResolver","$state",function($http,AuthService,AuthResolver,$state){var root=this;this.$state=$state,this.bLoggedIn=null,AuthResolver.bIsResolved()?root.bLoggedIn=AuthService.isAuthenticated():AuthResolver.resolve().then(function(){root.bLoggedIn=AuthService.isAuthenticated()})}])}(),function(){angular.module("general").config(["$stateProvider",function($stateProvider){$stateProvider.state("root",{"abstract":!0,template:"<ui-view/>",resolve:{auth:["AuthResolver",function(AuthResolver){return AuthResolver.bIsResolved()===!0||AuthResolver.resolve()}]}}).state("root.main",{url:"/",template:"<ui-view/>",controller:["$state","AuthService",function($state,AuthService){AuthService.isAuthenticated()?$state.go("root.main.dashboard"):$state.go("root.main.public")}]}).state("root.main.public",{templateUrl:"/angular/general/partials/index.html",controller:function(){console.log("Hit public index")}})}])}(),function(){angular.module("user").controller("DashboardController",["$state","$http","CourseService","Session",function($state,$http,CourseService,Session){var root=this;this.newCourse={},this.courses=null,this.user=Session.user;var getCourses=function(){CourseService.getCourses().then(function(res){root.courses=res.data},function(res){})};this.createCourse=function(){CourseService.createCourse(root.newCourse).then(function(res){console.log(res)})},getCourses()}]),angular.module("user").controller("CourseController",["$state","$http","$stateParams","CourseService","Session",function($state,$http,$stateParams,CourseService,Session){var root=this;this.course=null,root.user=Session.user;var getCourse=function(){CourseService.getCourse($stateParams.courseCode).then(function(res){console.log(res),root.course=res.data},function(res){})};getCourse()}])}(),function(){angular.module("user").config(["$stateProvider",function($stateProvider){$stateProvider.state("root.main.dashboard",{templateUrl:"/angular/courses/partials/dashboard.html",controller:"DashboardController",controllerAs:"dashboardCtrl"}),$stateProvider.state("root.course",{url:"/course/:courseCode",templateUrl:"/angular/courses/partials/course.html",controller:"CourseController",controllerAs:"courseCtrl"})}])}(),function(){angular.module("courses").factory("CourseService",["$http",function($http){return this.createCourse=function(newCourse){return $http.post("/api/course/create",newCourse)},this.getCourses=function(){return $http.get("/api/profile/courses")},this.getCourse=function(courseCode){return $http.get("/api/course/"+courseCode)},this}])}(),function(){angular.module("user").controller("LoginController",["$state","$rootScope","AuthService",function($state,$rootScope,AuthService){var root=this;this.authMessage="",this.user={email:"",password:""},this.login=function(){AuthService.login(root.user).then(function(res){$state.go("root.main")},function(res){root.authMessage=res.data.userMessage})}}]),angular.module("user").controller("JoinController",["$state","$rootScope","AuthService",function($state,$rootScope,AuthService){var root=this;this.authMessage="",this.user={firstName:"",lastName:"",retypePassword:"",password:"",email:"",accountType:""},this.signup=function(){AuthService.signup(root.user).then(function(res){$state.go("root.main")},function(res){root.authMessage=res.data.userMessage})}}]),angular.module("user").controller("ProfileController",["$state","Session",function($state,Session){this.user=Session.user}])}(),function(){angular.module("user").config(["$stateProvider",function($stateProvider){$stateProvider.state("root.login",{url:"/login",templateUrl:"/angular/user/partials/login.html",controller:"LoginController",controllerAs:"loginCtrl"}),$stateProvider.state("root.join",{url:"/join",templateUrl:"/angular/user/partials/join.html",controller:"JoinController",controllerAs:"joinCtrl"}),$stateProvider.state("root.profile",{url:"/profile",templateUrl:"/angular/user/partials/profile.html",controller:"ProfileController",controllerAs:"profileCtrl"})}])}(),function(){angular.module("user").factory("AuthService",["$http","Session",function($http,Session){var authService={};return authService.login=function(credentials){return $http.post("/auth/local",credentials).then(function(res){return Session.create(res.data),res.data})},authService.signup=function(newUser){return $http.post("/api/user/join",newUser).then(function(res){return console.log(res.data),Session.create(res.data),res.data},function(res){return res.data})},authService.isAuthenticated=function(){return Session.live()},authService}]),angular.module("user").service("Session",["$rootScope",function($rootScope){var root=this;this.user={},this.live=function(){return Object.keys(root.user).length>0},this.setCurrentUser=function(user){$rootScope.currentUser=user,root.user=user},this.create=function(user){$rootScope.currentUser=user,root.user=user},this.destroy=function(){$rootScope.currentUser=null,root.user=null}}]),angular.module("user").factory("AuthResolver",["$q","$rootScope","$state",function($q,$rootScope,$state){var bIsResolved=!1;return{resolve:function(){var deferred=$q.defer(),unwatch=$rootScope.$watch("currentUser",function(currentUser){angular.isDefined(currentUser)&&(currentUser?deferred.resolve(currentUser):deferred.reject(),bIsResolved=!0,unwatch())});return deferred.promise},bIsResolved:function(){return bIsResolved}}}])}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdlbmVyYWwvZ2VuZXJhbC5tb2R1bGUuanMiLCJjb3Vyc2VzL2NvdXJzZXMubW9kdWxlLmpzIiwibWlzYy9zbGlkZWFibGUubW9kdWxlLmpzIiwidXNlci91c2VyLm1vZHVsZS5qcyIsImNvcmUuanMiLCJnZW5lcmFsL2dlbmVyYWwuY3RybC5qcyIsImdlbmVyYWwvZ2VuZXJhbC5zdGF0ZXMuanMiLCJjb3Vyc2VzL2NvdXJzZXMuY3RybC5qcyIsIm1haW4uanMiLCJjb3Vyc2VzL2NvdXJzZXMuc3RhdGVzLmpzIiwiY291cnNlcy9jb3Vyc2VzLnN2Yy5qcyIsInVzZXIvdXNlci5jdHJsLmpzIiwidXNlci91c2VyLnN0YXRlcy5qcyIsInVzZXIvdXNlci5zdmMuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImRpcmVjdGl2ZSIsInJlc3RyaWN0IiwiY29tcGlsZSIsImVsZW1lbnQiLCJhdHRyIiwiY29udGVudHMiLCJodG1sIiwic2NvcGUiLCJhdHRycyIsImR1cmF0aW9uIiwiZWFzaW5nIiwiY3NzIiwib3ZlcmZsb3ciLCJoZWlnaHQiLCJ0cmFuc2l0aW9uUHJvcGVydHkiLCJ0cmFuc2l0aW9uRHVyYXRpb24iLCJ0cmFuc2l0aW9uVGltaW5nRnVuY3Rpb24iLCJsaW5rIiwidGFyZ2V0IiwiY29udGVudCIsImV4cGFuZGVkIiwiYmluZCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInNsaWRlVG9nZ2xlIiwic3R5bGUiLCJib3JkZXIiLCJ5IiwiY2xpZW50SGVpZ2h0IiwicnVuIiwiJGh0dHAiLCJTZXNzaW9uIiwiZ2V0Iiwic3VjY2VzcyIsInJlcyIsImNyZWF0ZSIsImVycm9yIiwic2V0Q3VycmVudFVzZXIiLCJhcHAiLCJjb25maWciLCIkbG9jYXRpb25Qcm92aWRlciIsImh0bWw1TW9kZSIsIiRyb290U2NvcGUiLCJBdXRoU2VydmljZSIsIkF1dGhSZXNvbHZlciIsIiRvbiIsImV2ZW50IiwibmV4dCIsImJJc1Jlc29sdmVkIiwiY29uc29sZSIsImxvZyIsImlzQXV0aGVudGljYXRlZCIsInJlc29sdmUiLCJ0aGVuIiwiZGF0YSIsImNvbnRyb2xsZXIiLCIkc3RhdGUiLCJyb290IiwidGhpcyIsImJMb2dnZWRJbiIsIiRzdGF0ZVByb3ZpZGVyIiwic3RhdGUiLCJhYnN0cmFjdCIsInRlbXBsYXRlIiwiYXV0aCIsInVybCIsImdvIiwidGVtcGxhdGVVcmwiLCJDb3Vyc2VTZXJ2aWNlIiwibmV3Q291cnNlIiwiY291cnNlcyIsInVzZXIiLCJnZXRDb3Vyc2VzIiwiY3JlYXRlQ291cnNlIiwiJHN0YXRlUGFyYW1zIiwiY291cnNlIiwiZ2V0Q291cnNlIiwiY291cnNlQ29kZSIsImNvbnRyb2xsZXJBcyIsImZhY3RvcnkiLCJwb3N0IiwiYXV0aE1lc3NhZ2UiLCJlbWFpbCIsInBhc3N3b3JkIiwibG9naW4iLCJ1c2VyTWVzc2FnZSIsImZpcnN0TmFtZSIsImxhc3ROYW1lIiwicmV0eXBlUGFzc3dvcmQiLCJhY2NvdW50VHlwZSIsInNpZ251cCIsImF1dGhTZXJ2aWNlIiwiY3JlZGVudGlhbHMiLCJuZXdVc2VyIiwibGl2ZSIsInNlcnZpY2UiLCJPYmplY3QiLCJrZXlzIiwibGVuZ3RoIiwiY3VycmVudFVzZXIiLCJkZXN0cm95IiwiJHEiLCJkZWZlcnJlZCIsImRlZmVyIiwidW53YXRjaCIsIiR3YXRjaCIsImlzRGVmaW5lZCIsInJlamVjdCIsInByb21pc2UiXSwibWFwcGluZ3MiOiJDQUFBLFdBQ0FBLFFBQUFDLE9BQUEsaUJDREEsV0FDQUQsUUFBQUMsT0FBQSxpQkNEQUQsUUFBQUMsT0FBQSx3QkFDQUMsVUFBQSxZQUFBLFdBQ0EsT0FDQUMsU0FBQSxJQUNBQyxRQUFBLFNBQUFDLFFBQUFDLE1BRUEsR0FBQUMsVUFBQUYsUUFBQUcsTUFHQSxPQUZBSCxTQUFBRyxLQUFBLHFGQUFBRCxTQUFBLFVBRUEsU0FBQUUsTUFBQUosUUFBQUssT0FFQUEsTUFBQUMsU0FBQUQsTUFBQUMsU0FBQUQsTUFBQUMsU0FBQSxLQUNBRCxNQUFBRSxPQUFB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dWxhci5tb2R1bGUoJ2dlbmVyYWwnLCBbXSk7XHJcbn0pKCk7IiwiKGZ1bmN0aW9uKCl7XHJcblx0dmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdjb3Vyc2VzJywgW10pO1xyXG59KSgpOyIsImFuZ3VsYXIubW9kdWxlKCdhbmd1bGFyU2xpZGVhYmxlcycsIFtdKVxyXG4uZGlyZWN0aXZlKCdzbGlkZWFibGUnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHJlc3RyaWN0OidDJyxcclxuICAgICAgICBjb21waWxlOiBmdW5jdGlvbiAoZWxlbWVudCwgYXR0cikge1xyXG4gICAgICAgICAgICAvLyB3cmFwIHRhZ1xyXG4gICAgICAgICAgICB2YXIgY29udGVudHMgPSBlbGVtZW50Lmh0bWwoKTtcclxuICAgICAgICAgICAgZWxlbWVudC5odG1sKCc8ZGl2IGNsYXNzPVwic2xpZGVhYmxlX2NvbnRlbnRcIiBzdHlsZT1cIm1hcmdpbjowICFpbXBvcnRhbnQ7IHBhZGRpbmc6MCAhaW1wb3J0YW50XCIgPicgKyBjb250ZW50cyArICc8L2Rpdj4nKTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiBwb3N0TGluayhzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcclxuICAgICAgICAgICAgICAgIC8vIGRlZmF1bHQgcHJvcGVydGllc1xyXG4gICAgICAgICAgICAgICAgYXR0cnMuZHVyYXRpb24gPSAoIWF0dHJzLmR1cmF0aW9uKSA/ICcxcycgOiBhdHRycy5kdXJhdGlvbjtcclxuICAgICAgICAgICAgICAgIGF0dHJzLmVhc2luZyA9ICghYXR0cnMuZWFzaW5nKSA/ICdlYXNlLWluLW91dCcgOiBhdHRycy5lYXNpbmc7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LmNzcyh7XHJcbiAgICAgICAgICAgICAgICAgICAgJ292ZXJmbG93JzogJ2hpZGRlbicsXHJcbiAgICAgICAgICAgICAgICAgICAgJ2hlaWdodCc6ICcwcHgnLFxyXG4gICAgICAgICAgICAgICAgICAgICd0cmFuc2l0aW9uUHJvcGVydHknOiAnaGVpZ2h0JyxcclxuICAgICAgICAgICAgICAgICAgICAndHJhbnNpdGlvbkR1cmF0aW9uJzogYXR0cnMuZHVyYXRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgJ3RyYW5zaXRpb25UaW1pbmdGdW5jdGlvbic6IGF0dHJzLmVhc2luZ1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufSlcclxuLmRpcmVjdGl2ZSgnc2xpZGVUb2dnbGUnLCBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgcmVzdHJpY3Q6ICdBJyxcclxuICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcclxuICAgICAgICAgICAgdmFyIHRhcmdldCwgY29udGVudDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGF0dHJzLmV4cGFuZGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBlbGVtZW50LmJpbmQoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRhcmdldCkgdGFyZ2V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdHRycy5zbGlkZVRvZ2dsZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWNvbnRlbnQpIGNvbnRlbnQgPSB0YXJnZXQucXVlcnlTZWxlY3RvcignLnNsaWRlYWJsZV9jb250ZW50Jyk7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGlmKCFhdHRycy5leHBhbmRlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQuc3R5bGUuYm9yZGVyID0gJzFweCBzb2xpZCByZ2JhKDAsMCwwLDApJztcclxuICAgICAgICAgICAgICAgICAgICB2YXIgeSA9IGNvbnRlbnQuY2xpZW50SGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQuc3R5bGUuYm9yZGVyID0gMDtcclxuICAgICAgICAgICAgICAgICAgICB0YXJnZXQuc3R5bGUuaGVpZ2h0ID0geSArICdweCc7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldC5zdHlsZS5oZWlnaHQgPSAnMHB4JztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGF0dHJzLmV4cGFuZGVkID0gIWF0dHJzLmV4cGFuZGVkO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0pOyIsIihmdW5jdGlvbigpe1xyXG5cdHZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgndXNlcicsIFtdKVxyXG5cdC5ydW4oZnVuY3Rpb24oJGh0dHAsIFNlc3Npb24pe1xyXG5cdFx0JGh0dHAuZ2V0KCcvYXBpL3Byb2ZpbGUnKVxyXG5cdFx0LnN1Y2Nlc3MoZnVuY3Rpb24ocmVzKXtcclxuXHRcdFx0U2Vzc2lvbi5jcmVhdGUocmVzKTtcclxuXHRcdH0pXHJcblx0XHQuZXJyb3IoZnVuY3Rpb24ocmVzKXtcclxuXHRcdFx0U2Vzc2lvbi5zZXRDdXJyZW50VXNlcih7fSk7XHJcblx0XHR9KTtcclxuXHR9KTtcclxufSkoKTsiLCIoZnVuY3Rpb24oKXtcclxuXHR2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ2dyYWRlcicsIFxyXG5cdFx0W1xyXG5cdFx0XHQndWkucm91dGVyJyxcclxuXHRcdFx0J2dlbmVyYWwnLFxyXG5cdFx0XHQnY291cnNlcycsXHJcblx0XHRcdCd1c2VyJ1xyXG5cdFx0XSk7XHJcblxyXG5cdC8vcmVtb3ZlIHRoZSBoYXNoXHJcblx0YXBwLmNvbmZpZyhbJyRsb2NhdGlvblByb3ZpZGVyJywgZnVuY3Rpb24oJGxvY2F0aW9uUHJvdmlkZXIpe1xyXG5cdFx0JGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xyXG5cdH1dKTtcclxuXHRcclxuXHRhcHAucnVuKGZ1bmN0aW9uICgkcm9vdFNjb3BlLCBBdXRoU2VydmljZSwgQXV0aFJlc29sdmVyKSB7XHJcbiAgXHRcdCRyb290U2NvcGUuJG9uKCckc3RhdGVDaGFuZ2VTdGFydCcsIGZ1bmN0aW9uIChldmVudCwgbmV4dCkge1xyXG4gIFx0XHRcdGlmIChBdXRoUmVzb2x2ZXIuYklzUmVzb2x2ZWQoKSl7XHJcbiAgXHRcdFx0XHRjb25zb2xlLmxvZygnc3RhdGVDaGFuZ2VTdGFydCByZXNvbHZlZCcpO1xyXG4gIFx0XHRcdFx0Y29uc29sZS5sb2coJ2F1dGg6ICcgKyBBdXRoU2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKSk7XHJcbiAgXHRcdFx0fWVsc2V7XHJcbiAgXHRcdFx0XHRBdXRoUmVzb2x2ZXIucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24oZGF0YSl7XHJcbiAgXHRcdFx0XHRcdGNvbnNvbGUubG9nKCdzdGF0ZUNoYW5nZVN0YXJ0IG5vdCByZXNvbHZlZCcpO1xyXG4gIFx0XHRcdFx0XHRjb25zb2xlLmxvZygnYXV0aDogJyArIEF1dGhTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCgpKTtcclxuICBcdFx0XHRcdH0pXHJcbiAgXHRcdFx0fVxyXG4gIFx0XHR9KTtcclxuXHR9KTtcclxufSkoKTsiLCIoZnVuY3Rpb24oKXtcclxuXHRhbmd1bGFyLm1vZHVsZSgnZ2VuZXJhbCcpLmNvbnRyb2xsZXIoJ05hdkNvbnRyb2xsZXInLCBmdW5jdGlvbigkaHR0cCwgQXV0aFNlcnZpY2UsIEF1dGhSZXNvbHZlciwgJHN0YXRlKXtcclxuXHRcdHZhciByb290ID0gdGhpcztcclxuXHRcdHRoaXMuJHN0YXRlID0gJHN0YXRlO1xyXG5cdFx0dGhpcy5iTG9nZ2VkSW4gPSBudWxsO1xyXG5cdFx0XHJcblx0XHRpZiAoQXV0aFJlc29sdmVyLmJJc1Jlc29sdmVkKCkpe1xyXG5cdFx0XHRyb290LmJMb2dnZWRJbiA9IEF1dGhTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCgpO1xyXG5cdFx0fWVsc2V7XHJcblx0XHRcdEF1dGhSZXNvbHZlci5yZXNvbHZlKCkudGhlbihmdW5jdGlvbigpe1xyXG5cdFx0XHRcdHJvb3QuYkxvZ2dlZEluID0gQXV0aFNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCk7XHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG59KSgpOyIsIihmdW5jdGlvbigpe1xyXG5cdGFuZ3VsYXIubW9kdWxlKCdnZW5lcmFsJykuY29uZmlnKGZ1bmN0aW9uKCRzdGF0ZVByb3ZpZGVyKXtcclxuXHJcblx0XHQkc3RhdGVQcm92aWRlclxyXG5cdFx0LnN0YXRlKCdyb290Jywge1xyXG5cdFx0XHRhYnN0cmFjdDogdHJ1ZSxcclxuXHRcdFx0dGVtcGxhdGU6ICc8dWktdmlldy8+JyxcclxuXHRcdFx0cmVzb2x2ZToge1xyXG5cdFx0XHRcdGF1dGg6IGZ1bmN0aW9uIHJlc29sdmVBdXRoZW50aWNhdGlvbihBdXRoUmVzb2x2ZXIpIHsgXHJcblx0XHRcdFx0XHRyZXR1cm4gKEF1dGhSZXNvbHZlci5iSXNSZXNvbHZlZCgpID09PSB0cnVlIHx8IEF1dGhSZXNvbHZlci5yZXNvbHZlKCkpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSlcclxuXHJcblx0XHQuc3RhdGUoJ3Jvb3QubWFpbicsIHtcclxuXHRcdFx0dXJsOiAnLycsXHJcblx0XHRcdHRlbXBsYXRlOiAnPHVpLXZpZXcvPicsXHJcblx0XHRcdGNvbnRyb2xsZXI6IGZ1bmN0aW9uKCRzdGF0ZSwgQXV0aFNlcnZpY2Upe1xyXG5cdFx0XHRcdGlmIChBdXRoU2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKSl7XHJcblx0XHRcdFx0XHQkc3RhdGUuZ28oJ3Jvb3QubWFpbi5kYXNoYm9hcmQnKTtcclxuXHRcdFx0XHR9ZWxzZXtcclxuXHRcdFx0XHRcdCRzdGF0ZS5nbygncm9vdC5tYWluLnB1YmxpYycpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSlcclxuXHJcblx0XHQuc3RhdGUoJ3Jvb3QubWFpbi5wdWJsaWMnLCB7XHJcblx0XHRcdHRlbXBsYXRlVXJsOiAnL2FuZ3VsYXIvZ2VuZXJhbC9wYXJ0aWFscy9pbmRleC5odG1sJyxcclxuXHRcdFx0Y29udHJvbGxlcjogZnVuY3Rpb24oKXtcclxuXHRcdFx0XHRjb25zb2xlLmxvZygnSGl0IHB1YmxpYyBpbmRleCcpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9KTtcclxufSkoKTsiLCIoZnVuY3Rpb24oKXtcclxuXHRhbmd1bGFyLm1vZHVsZSgndXNlcicpLmNvbnRyb2xsZXIoJ0Rhc2hib2FyZENvbnRyb2xsZXInLCBmdW5jdGlvbigkc3RhdGUsICRodHRwLCBDb3Vyc2VTZXJ2aWNlLCBTZXNzaW9uKXtcclxuXHRcdHZhciByb290ID0gdGhpcztcclxuXHRcdHRoaXMubmV3Q291cnNlID0ge307XHJcblx0XHR0aGlzLmNvdXJzZXMgPSBudWxsO1xyXG5cdFx0dGhpcy51c2VyID0gU2Vzc2lvbi51c2VyO1xyXG5cclxuXHRcdHZhciBnZXRDb3Vyc2VzID0gZnVuY3Rpb24oKXtcclxuXHRcdFx0Q291cnNlU2VydmljZS5nZXRDb3Vyc2VzKCkudGhlbihcclxuXHRcdFx0XHRmdW5jdGlvbiBTdWNjZXNzKHJlcyl7XHJcblx0XHRcdFx0XHRyb290LmNvdXJzZXMgPSByZXMuZGF0YTtcclxuXHRcdFx0XHR9LCBcclxuXHRcdFx0XHRmdW5jdGlvbiBGYWlsdXJlKHJlcyl7XHJcblxyXG5cdFx0XHRcdH1cclxuXHRcdFx0KTtcclxuXHRcdH07XHJcblxyXG5cdFx0dGhpcy5jcmVhdGVDb3Vyc2UgPSBmdW5jdGlvbigpe1xyXG5cdFx0XHRDb3Vyc2VTZXJ2aWNlLmNyZWF0ZUNvdXJzZShyb290Lm5ld0NvdXJzZSkudGhlbihmdW5jdGlvbihyZXMpe1xyXG5cdFx0XHRcdGNvbnNvbGUubG9nKHJlcyk7XHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cclxuXHRcdGdldENvdXJzZXMoKTtcclxuXHR9KTtcclxuXHJcblx0YW5ndWxhci5tb2R1bGUoJ3VzZXInKS5jb250cm9sbGVyKCdDb3Vyc2VDb250cm9sbGVyJywgXHJcblx0XHRmdW5jdGlvbigkc3RhdGUsICRodHRwLCAkc3RhdGVQYXJhbXMsIENvdXJzZVNlcnZpY2UsIFNlc3Npb24pe1xyXG5cclxuXHRcdHZhciByb290ID0gdGhpcztcclxuXHJcblx0XHR0aGlzLmNvdXJzZSA9IG51bGw7XHJcblx0XHRyb290LnVzZXIgPSBTZXNzaW9uLnVzZXI7XHJcblxyXG5cdFx0dmFyIGdldENvdXJzZSA9IGZ1bmN0aW9uKCl7XHJcblx0XHRcdENvdXJzZVNlcnZpY2UuZ2V0Q291cnNlKCRzdGF0ZVBhcmFtcy5jb3Vyc2VDb2RlKS50aGVuKFxyXG5cdFx0XHRcdGZ1bmN0aW9uIFN1Y2Nlc3MocmVzKXtcclxuXHRcdFx0XHRcdGNvbnNvbGUubG9nKHJlcyk7XHJcblx0XHRcdFx0XHRyb290LmNvdXJzZSA9IHJlcy5kYXRhO1xyXG5cdFx0XHRcdH0sIFxyXG5cdFx0XHRcdGZ1bmN0aW9uIEZhaWx1cmUocmVzKXtcclxuXHJcblx0XHRcdFx0fVxyXG5cdFx0XHQpO1xyXG5cdFx0fTtcclxuXHJcblx0XHRnZXRDb3Vyc2UoKTtcclxuXHR9KTtcclxufSkoKTsiLCIoZnVuY3Rpb24oKXtcclxuXHR2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ2dlbmVyYWwnLCBbXSk7XHJcbn0pKCk7XG4oZnVuY3Rpb24oKXtcclxuXHR2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ2NvdXJzZXMnLCBbXSk7XHJcbn0pKCk7XG5hbmd1bGFyLm1vZHVsZSgnYW5ndWxhclNsaWRlYWJsZXMnLCBbXSlcclxuLmRpcmVjdGl2ZSgnc2xpZGVhYmxlJywgZnVuY3Rpb24gKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICByZXN0cmljdDonQycsXHJcbiAgICAgICAgY29tcGlsZTogZnVuY3Rpb24gKGVsZW1lbnQsIGF0dHIpIHtcclxuICAgICAgICAgICAgLy8gd3JhcCB0YWdcclxuICAgICAgICAgICAgdmFyIGNvbnRlbnRzID0gZWxlbWVudC5odG1sKCk7XHJcbiAgICAgICAgICAgIGVsZW1lbnQuaHRtbCgnPGRpdiBjbGFzcz1cInNsaWRlYWJsZV9jb250ZW50XCIgc3R5bGU9XCJtYXJnaW46MCAhaW1wb3J0YW50OyBwYWRkaW5nOjAgIWltcG9ydGFudFwiID4nICsgY29udGVudHMgKyAnPC9kaXY+Jyk7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24gcG9zdExpbmsoc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBkZWZhdWx0IHByb3BlcnRpZXNcclxuICAgICAgICAgICAgICAgIGF0dHJzLmR1cmF0aW9uID0gKCFhdHRycy5kdXJhdGlvbikgPyAnMXMnIDogYXR0cnMuZHVyYXRpb247XHJcbiAgICAgICAgICAgICAgICBhdHRycy5lYXNpbmcgPSAoIWF0dHJzLmVhc2luZykgPyAnZWFzZS1pbi1vdXQnIDogYXR0cnMuZWFzaW5nO1xyXG4gICAgICAgICAgICAgICAgZWxlbWVudC5jc3Moe1xyXG4gICAgICAgICAgICAgICAgICAgICdvdmVyZmxvdyc6ICdoaWRkZW4nLFxyXG4gICAgICAgICAgICAgICAgICAgICdoZWlnaHQnOiAnMHB4JyxcclxuICAgICAgICAgICAgICAgICAgICAndHJhbnNpdGlvblByb3BlcnR5JzogJ2hlaWdodCcsXHJcbiAgICAgICAgICAgICAgICAgICAgJ3RyYW5zaXRpb25EdXJhdGlvbic6IGF0dHJzLmR1cmF0aW9uLFxyXG4gICAgICAgICAgICAgICAgICAgICd0cmFuc2l0aW9uVGltaW5nRnVuY3Rpb24nOiBhdHRycy5lYXNpbmdcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbn0pXHJcbi5kaXJlY3RpdmUoJ3NsaWRlVG9nZ2xlJywgZnVuY3Rpb24oKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHJlc3RyaWN0OiAnQScsXHJcbiAgICAgICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzKSB7XHJcbiAgICAgICAgICAgIHZhciB0YXJnZXQsIGNvbnRlbnQ7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBhdHRycy5leHBhbmRlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZWxlbWVudC5iaW5kKCdjbGljaycsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCF0YXJnZXQpIHRhcmdldCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXR0cnMuc2xpZGVUb2dnbGUpO1xyXG4gICAgICAgICAgICAgICAgaWYgKCFjb250ZW50KSBjb250ZW50ID0gdGFyZ2V0LnF1ZXJ5U2VsZWN0b3IoJy5zbGlkZWFibGVfY29udGVudCcpO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBpZighYXR0cnMuZXhwYW5kZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb250ZW50LnN0eWxlLmJvcmRlciA9ICcxcHggc29saWQgcmdiYSgwLDAsMCwwKSc7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHkgPSBjb250ZW50LmNsaWVudEhlaWdodDtcclxuICAgICAgICAgICAgICAgICAgICBjb250ZW50LnN0eWxlLmJvcmRlciA9IDA7XHJcbiAgICAgICAgICAgICAgICAgICAgdGFyZ2V0LnN0eWxlLmhlaWdodCA9IHkgKyAncHgnO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICB0YXJnZXQuc3R5bGUuaGVpZ2h0ID0gJzBweCc7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBhdHRycy5leHBhbmRlZCA9ICFhdHRycy5leHBhbmRlZDtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KTtcbihmdW5jdGlvbigpe1xyXG5cdHZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgndXNlcicsIFtdKVxyXG5cdC5ydW4oW1wiJGh0dHBcIiwgXCJTZXNzaW9uXCIsIGZ1bmN0aW9uKCRodHRwLCBTZXNzaW9uKXtcclxuXHRcdCRodHRwLmdldCgnL2FwaS9wcm9maWxlJylcclxuXHRcdC5zdWNjZXNzKGZ1bmN0aW9uKHJlcyl7XHJcblx0XHRcdFNlc3Npb24uY3JlYXRlKHJlcyk7XHJcblx0XHR9KVxyXG5cdFx0LmVycm9yKGZ1bmN0aW9uKHJlcyl7XHJcblx0XHRcdFNlc3Npb24uc2V0Q3VycmVudFVzZXIoe30pO1xyXG5cdFx0fSk7XHJcblx0fV0pO1xyXG59KSgpO1xuKGZ1bmN0aW9uKCl7XHJcblx0dmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCdncmFkZXInLCBcclxuXHRcdFtcclxuXHRcdFx0J3VpLnJvdXRlcicsXHJcblx0XHRcdCdnZW5lcmFsJyxcclxuXHRcdFx0J2NvdXJzZXMnLFxyXG5cdFx0XHQndXNlcidcclxuXHRcdF0pO1xyXG5cclxuXHQvL3JlbW92ZSB0aGUgaGFzaFxyXG5cdGFwcC5jb25maWcoWyckbG9jYXRpb25Qcm92aWRlcicsIGZ1bmN0aW9uKCRsb2NhdGlvblByb3ZpZGVyKXtcclxuXHRcdCRsb2NhdGlvblByb3ZpZGVyLmh0bWw1TW9kZSh0cnVlKTtcclxuXHR9XSk7XHJcblx0XHJcblx0YXBwLnJ1bihbXCIkcm9vdFNjb3BlXCIsIFwiQXV0aFNlcnZpY2VcIiwgXCJBdXRoUmVzb2x2ZXJcIiwgZnVuY3Rpb24gKCRyb290U2NvcGUsIEF1dGhTZXJ2aWNlLCBBdXRoUmVzb2x2ZXIpIHtcclxuICBcdFx0JHJvb3RTY29wZS4kb24oJyRzdGF0ZUNoYW5nZVN0YXJ0JywgZnVuY3Rpb24gKGV2ZW50LCBuZXh0KSB7XHJcbiAgXHRcdFx0aWYgKEF1dGhSZXNvbHZlci5iSXNSZXNvbHZlZCgpKXtcclxuICBcdFx0XHRcdGNvbnNvbGUubG9nKCdzdGF0ZUNoYW5nZVN0YXJ0IHJlc29sdmVkJyk7XHJcbiAgXHRcdFx0XHRjb25zb2xlLmxvZygnYXV0aDogJyArIEF1dGhTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCgpKTtcclxuICBcdFx0XHR9ZWxzZXtcclxuICBcdFx0XHRcdEF1dGhSZXNvbHZlci5yZXNvbHZlKCkudGhlbihmdW5jdGlvbihkYXRhKXtcclxuICBcdFx0XHRcdFx0Y29uc29sZS5sb2coJ3N0YXRlQ2hhbmdlU3RhcnQgbm90IHJlc29sdmVkJyk7XHJcbiAgXHRcdFx0XHRcdGNvbnNvbGUubG9nKCdhdXRoOiAnICsgQXV0aFNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCkpO1xyXG4gIFx0XHRcdFx0fSlcclxuICBcdFx0XHR9XHJcbiAgXHRcdH0pO1xyXG5cdH1dKTtcclxufSkoKTtcbihmdW5jdGlvbigpe1xyXG5cdGFuZ3VsYXIubW9kdWxlKCdnZW5lcmFsJykuY29udHJvbGxlcignTmF2Q29udHJvbGxlcicsIFtcIiRodHRwXCIsIFwiQXV0aFNlcnZpY2VcIiwgXCJBdXRoUmVzb2x2ZXJcIiwgXCIkc3RhdGVcIiwgZnVuY3Rpb24oJGh0dHAsIEF1dGhTZXJ2aWNlLCBBdXRoUmVzb2x2ZXIsICRzdGF0ZSl7XHJcblx0XHR2YXIgcm9vdCA9IHRoaXM7XHJcblx0XHR0aGlzLiRzdGF0ZSA9ICRzdGF0ZTtcclxuXHRcdHRoaXMuYkxvZ2dlZEluID0gbnVsbDtcclxuXHRcdFxyXG5cdFx0aWYgKEF1dGhSZXNvbHZlci5iSXNSZXNvbHZlZCgpKXtcclxuXHRcdFx0cm9vdC5iTG9nZ2VkSW4gPSBBdXRoU2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKTtcclxuXHRcdH1lbHNle1xyXG5cdFx0XHRBdXRoUmVzb2x2ZXIucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24oKXtcclxuXHRcdFx0XHRyb290LmJMb2dnZWRJbiA9IEF1dGhTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCgpO1xyXG5cdFx0XHR9KTtcclxuXHRcdH1cclxuXHR9XSk7XHJcbn0pKCk7XG4oZnVuY3Rpb24oKXtcclxuXHRhbmd1bGFyLm1vZHVsZSgnZ2VuZXJhbCcpLmNvbmZpZyhbXCIkc3RhdGVQcm92aWRlclwiLCBmdW5jdGlvbigkc3RhdGVQcm92aWRlcil7XHJcblxyXG5cdFx0JHN0YXRlUHJvdmlkZXJcclxuXHRcdC5zdGF0ZSgncm9vdCcsIHtcclxuXHRcdFx0YWJzdHJhY3Q6IHRydWUsXHJcblx0XHRcdHRlbXBsYXRlOiAnPHVpLXZpZXcvPicsXHJcblx0XHRcdHJlc29sdmU6IHtcclxuXHRcdFx0XHRhdXRoOiBbXCJBdXRoUmVzb2x2ZXJcIiwgZnVuY3Rpb24gcmVzb2x2ZUF1dGhlbnRpY2F0aW9uKEF1dGhSZXNvbHZlcikgeyBcclxuXHRcdFx0XHRcdHJldHVybiAoQXV0aFJlc29sdmVyLmJJc1Jlc29sdmVkKCkgPT09IHRydWUgfHwgQXV0aFJlc29sdmVyLnJlc29sdmUoKSk7XHJcblx0XHRcdFx0fV1cclxuXHRcdFx0fVxyXG5cdFx0fSlcclxuXHJcblx0XHQuc3RhdGUoJ3Jvb3QubWFpbicsIHtcclxuXHRcdFx0dXJsOiAnLycsXHJcblx0XHRcdHRlbXBsYXRlOiAnPHVpLXZpZXcvPicsXHJcblx0XHRcdGNvbnRyb2xsZXI6IFtcIiRzdGF0ZVwiLCBcIkF1dGhTZXJ2aWNlXCIsIGZ1bmN0aW9uKCRzdGF0ZSwgQXV0aFNlcnZpY2Upe1xyXG5cdFx0XHRcdGlmIChBdXRoU2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKSl7XHJcblx0XHRcdFx0XHQkc3RhdGUuZ28oJ3Jvb3QubWFpbi5kYXNoYm9hcmQnKTtcclxuXHRcdFx0XHR9ZWxzZXtcclxuXHRcdFx0XHRcdCRzdGF0ZS5nbygncm9vdC5tYWluLnB1YmxpYycpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fV1cclxuXHRcdH0pXHJcblxyXG5cdFx0LnN0YXRlKCdyb290Lm1haW4ucHVibGljJywge1xyXG5cdFx0XHR0ZW1wbGF0ZVVybDogJy9hbmd1bGFyL2dlbmVyYWwvcGFydGlhbHMvaW5kZXguaHRtbCcsXHJcblx0XHRcdGNvbnRyb2xsZXI6IGZ1bmN0aW9uKCl7XHJcblx0XHRcdFx0Y29uc29sZS5sb2coJ0hpdCBwdWJsaWMgaW5kZXgnKTtcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0fV0pO1xyXG59KSgpO1xuKGZ1bmN0aW9uKCl7XHJcblx0YW5ndWxhci5tb2R1bGUoJ3VzZXInKS5jb250cm9sbGVyKCdEYXNoYm9hcmRDb250cm9sbGVyJywgW1wiJHN0YXRlXCIsIFwiJGh0dHBcIiwgXCJDb3Vyc2VTZXJ2aWNlXCIsIFwiU2Vzc2lvblwiLCBmdW5jdGlvbigkc3RhdGUsICRodHRwLCBDb3Vyc2VTZXJ2aWNlLCBTZXNzaW9uKXtcclxuXHRcdHZhciByb290ID0gdGhpcztcclxuXHRcdHRoaXMubmV3Q291cnNlID0ge307XHJcblx0XHR0aGlzLmNvdXJzZXMgPSBudWxsO1xyXG5cdFx0dGhpcy51c2VyID0gU2Vzc2lvbi51c2VyO1xyXG5cclxuXHRcdHZhciBnZXRDb3Vyc2VzID0gZnVuY3Rpb24oKXtcclxuXHRcdFx0Q291cnNlU2VydmljZS5nZXRDb3Vyc2VzKCkudGhlbihcclxuXHRcdFx0XHRmdW5jdGlvbiBTdWNjZXNzKHJlcyl7XHJcblx0XHRcdFx0XHRyb290LmNvdXJzZXMgPSByZXMuZGF0YTtcclxuXHRcdFx0XHR9LCBcclxuXHRcdFx0XHRmdW5jdGlvbiBGYWlsdXJlKHJlcyl7XHJcblxyXG5cdFx0XHRcdH1cclxuXHRcdFx0KTtcclxuXHRcdH07XHJcblxyXG5cdFx0dGhpcy5jcmVhdGVDb3Vyc2UgPSBmdW5jdGlvbigpe1xyXG5cdFx0XHRDb3Vyc2VTZXJ2aWNlLmNyZWF0ZUNvdXJzZShyb290Lm5ld0NvdXJzZSkudGhlbihmdW5jdGlvbihyZXMpe1xyXG5cdFx0XHRcdGNvbnNvbGUubG9nKHJlcyk7XHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cclxuXHRcdGdldENvdXJzZXMoKTtcclxuXHR9XSk7XHJcblxyXG5cdGFuZ3VsYXIubW9kdWxlKCd1c2VyJykuY29udHJvbGxlcignQ291cnNlQ29udHJvbGxlcicsIFxyXG5cdFx0W1wiJHN0YXRlXCIsIFwiJGh0dHBcIiwgXCIkc3RhdGVQYXJhbXNcIiwgXCJDb3Vyc2VTZXJ2aWNlXCIsIFwiU2Vzc2lvblwiLCBmdW5jdGlvbigkc3RhdGUsICRodHRwLCAkc3RhdGVQYXJhbXMsIENvdXJzZVNlcnZpY2UsIFNlc3Npb24pe1xyXG5cclxuXHRcdHZhciByb290ID0gdGhpcztcclxuXHJcblx0XHR0aGlzLmNvdXJzZSA9IG51bGw7XHJcblx0XHRyb290LnVzZXIgPSBTZXNzaW9uLnVzZXI7XHJcblxyXG5cdFx0dmFyIGdldENvdXJzZSA9IGZ1bmN0aW9uKCl7XHJcblx0XHRcdENvdXJzZVNlcnZpY2UuZ2V0Q291cnNlKCRzdGF0ZVBhcmFtcy5jb3Vyc2VDb2RlKS50aGVuKFxyXG5cdFx0XHRcdGZ1bmN0aW9uIFN1Y2Nlc3MocmVzKXtcclxuXHRcdFx0XHRcdGNvbnNvbGUubG9nKHJlcyk7XHJcblx0XHRcdFx0XHRyb290LmNvdXJzZSA9IHJlcy5kYXRhO1xyXG5cdFx0XHRcdH0sIFxyXG5cdFx0XHRcdGZ1bmN0aW9uIEZhaWx1cmUocmVzKXtcclxuXHJcblx0XHRcdFx0fVxyXG5cdFx0XHQpO1xyXG5cdFx0fTtcclxuXHJcblx0XHRnZXRDb3Vyc2UoKTtcclxuXHR9XSk7XHJcbn0pKCk7XG4oZnVuY3Rpb24oKXtcclxuXHRhbmd1bGFyLm1vZHVsZSgndXNlcicpLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIpe1xyXG5cdFx0JHN0YXRlUHJvdmlkZXIuc3RhdGUoJ3Jvb3QubWFpbi5kYXNoYm9hcmQnLCB7XHJcblx0XHRcdHRlbXBsYXRlVXJsOiAnL2FuZ3VsYXIvY291cnNlcy9wYXJ0aWFscy9kYXNoYm9hcmQuaHRtbCcsXHJcblx0XHRcdGNvbnRyb2xsZXI6ICdEYXNoYm9hcmRDb250cm9sbGVyJyxcclxuXHRcdFx0Y29udHJvbGxlckFzOiAnZGFzaGJvYXJkQ3RybCdcclxuXHRcdH0pO1xyXG5cclxuXHRcdCRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdyb290LmNvdXJzZScsIHtcclxuXHRcdFx0dXJsOiAnL2NvdXJzZS86Y291cnNlQ29kZScsXHJcblx0XHRcdHRlbXBsYXRlVXJsOiAnL2FuZ3VsYXIvY291cnNlcy9wYXJ0aWFscy9jb3Vyc2UuaHRtbCcsXHJcblx0XHRcdGNvbnRyb2xsZXI6ICdDb3Vyc2VDb250cm9sbGVyJyxcclxuXHRcdFx0Y29udHJvbGxlckFzOiAnY291cnNlQ3RybCdcclxuXHRcdH0pO1xyXG5cdH1dKTtcclxufSkoKTtcbihmdW5jdGlvbigpe1xyXG5cdGFuZ3VsYXIubW9kdWxlKCdjb3Vyc2VzJykuZmFjdG9yeSgnQ291cnNlU2VydmljZScsIFtcIiRodHRwXCIsIGZ1bmN0aW9uICgkaHR0cCkge1xyXG5cdFx0dGhpcy5jcmVhdGVDb3Vyc2UgPSBmdW5jdGlvbihuZXdDb3Vyc2UpIHtcclxuXHRcdFx0cmV0dXJuICRodHRwLnBvc3QoJy9hcGkvY291cnNlL2NyZWF0ZScsIG5ld0NvdXJzZSk7XHJcblx0XHR9O1xyXG5cclxuXHRcdHRoaXMuZ2V0Q291cnNlcyA9IGZ1bmN0aW9uKCl7XHJcblx0XHRcdHJldHVybiAkaHR0cC5nZXQoJy9hcGkvcHJvZmlsZS9jb3Vyc2VzJyk7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5nZXRDb3Vyc2UgPSBmdW5jdGlvbihjb3Vyc2VDb2RlKXtcclxuXHRcdFx0cmV0dXJuICRodHRwLmdldCgnL2FwaS9jb3Vyc2UvJyArIGNvdXJzZUNvZGUpO1xyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB0aGlzO1xyXG5cdH1dKTtcclxufSkoKTtcbihmdW5jdGlvbigpe1xyXG5cdGFuZ3VsYXIubW9kdWxlKCd1c2VyJykuY29udHJvbGxlcignTG9naW5Db250cm9sbGVyJywgW1wiJHN0YXRlXCIsIFwiJHJvb3RTY29wZVwiLCBcIkF1dGhTZXJ2aWNlXCIsIGZ1bmN0aW9uKCRzdGF0ZSwgJHJvb3RTY29wZSwgQXV0aFNlcnZpY2Upe1xyXG5cdFx0dmFyIHJvb3QgPSB0aGlzO1xyXG5cdFx0dGhpcy5hdXRoTWVzc2FnZSA9ICcnO1xyXG5cdFx0dGhpcy51c2VyID0ge1xyXG5cdFx0XHRlbWFpbDogJycsXHJcblx0XHRcdHBhc3N3b3JkOiAnJ1xyXG5cdFx0fTtcclxuXHJcblx0XHR0aGlzLmxvZ2luID0gZnVuY3Rpb24oKSB7XHJcblx0XHRcdEF1dGhTZXJ2aWNlLmxvZ2luKHJvb3QudXNlcikudGhlbihcclxuXHRcdFx0XHRmdW5jdGlvbihyZXMpe1xyXG5cdFx0XHRcdFx0JHN0YXRlLmdvKCdyb290Lm1haW4nKTtcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdGZ1bmN0aW9uKHJlcyl7XHJcblx0XHRcdFx0XHRyb290LmF1dGhNZXNzYWdlID0gcmVzLmRhdGEudXNlck1lc3NhZ2U7XHJcblx0XHRcdFx0fSk7XHJcblx0XHR9O1xyXG5cdH1dKTtcclxuXHRcclxuXHRhbmd1bGFyLm1vZHVsZSgndXNlcicpLmNvbnRyb2xsZXIoJ0pvaW5Db250cm9sbGVyJywgW1wiJHN0YXRlXCIsIFwiJHJvb3RTY29wZVwiLCBcIkF1dGhTZXJ2aWNlXCIsIGZ1bmN0aW9uKCRzdGF0ZSwgJHJvb3RTY29wZSwgQXV0aFNlcnZpY2Upe1xyXG5cdFx0dmFyIHJvb3QgPSB0aGlzO1xyXG5cdFx0dGhpcy5hdXRoTWVzc2FnZSA9ICcnO1xyXG5cdFx0dGhpcy51c2VyID0ge1xyXG5cdFx0XHRmaXJzdE5hbWU6ICcnLFxyXG5cdFx0XHRsYXN0TmFtZTogJycsXHJcblx0XHRcdHJldHlwZVBhc3N3b3JkOiAnJywgXHJcblx0XHRcdHBhc3N3b3JkOiAnJyxcclxuXHRcdFx0ZW1haWw6ICcnLFxyXG5cdFx0XHRhY2NvdW50VHlwZTogJydcclxuXHRcdH07XHJcblxyXG5cdFx0dGhpcy5zaWdudXAgPSBmdW5jdGlvbigpIHtcclxuXHRcdFx0QXV0aFNlcnZpY2Uuc2lnbnVwKHJvb3QudXNlcikudGhlbihcclxuXHRcdFx0XHRmdW5jdGlvbihyZXMpe1xyXG5cdFx0XHRcdFx0JHN0YXRlLmdvKCdyb290Lm1haW4nKTtcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdGZ1bmN0aW9uKHJlcyl7XHJcblx0XHRcdFx0XHRyb290LmF1dGhNZXNzYWdlID0gcmVzLmRhdGEudXNlck1lc3NhZ2U7XHJcblx0XHRcdFx0fSk7XHJcblx0XHR9O1xyXG5cdH1dKTtcclxuXHJcblx0YW5ndWxhci5tb2R1bGUoJ3VzZXInKS5jb250cm9sbGVyKCdQcm9maWxlQ29udHJvbGxlcicsIFtcIiRzdGF0ZVwiLCBcIlNlc3Npb25cIiwgZnVuY3Rpb24oJHN0YXRlLCBTZXNzaW9uKXtcclxuXHRcdHRoaXMudXNlciA9IFNlc3Npb24udXNlcjtcclxuXHR9XSk7XHJcbn0pKCk7XG4oZnVuY3Rpb24oKXtcclxuXHRhbmd1bGFyLm1vZHVsZSgndXNlcicpLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIpe1xyXG5cdFx0JHN0YXRlUHJvdmlkZXIuc3RhdGUoJ3Jvb3QubG9naW4nLCB7XHJcblx0XHRcdHVybDogJy9sb2dpbicsXHJcblx0XHRcdHRlbXBsYXRlVXJsOiAnL2FuZ3VsYXIvdXNlci9wYXJ0aWFscy9sb2dpbi5odG1sJyxcclxuXHRcdFx0Y29udHJvbGxlcjogJ0xvZ2luQ29udHJvbGxlcicsXHJcblx0XHRcdGNvbnRyb2xsZXJBczogJ2xvZ2luQ3RybCdcclxuXHRcdH0pO1xyXG5cclxuXHRcdCRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdyb290LmpvaW4nLCB7XHJcblx0XHRcdHVybDogJy9qb2luJyxcclxuXHRcdFx0dGVtcGxhdGVVcmw6ICcvYW5ndWxhci91c2VyL3BhcnRpYWxzL2pvaW4uaHRtbCcsXHJcblx0XHRcdGNvbnRyb2xsZXI6ICdKb2luQ29udHJvbGxlcicsXHJcblx0XHRcdGNvbnRyb2xsZXJBczogJ2pvaW5DdHJsJ1xyXG5cdFx0fSk7XHJcblx0XHRcclxuXHRcdCRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdyb290LnByb2ZpbGUnLCB7XHJcblx0XHRcdHVybDogJy9wcm9maWxlJyxcclxuXHRcdFx0dGVtcGxhdGVVcmw6ICcvYW5ndWxhci91c2VyL3BhcnRpYWxzL3Byb2ZpbGUuaHRtbCcsXHJcblx0XHRcdGNvbnRyb2xsZXI6ICdQcm9maWxlQ29udHJvbGxlcicsXHJcblx0XHRcdGNvbnRyb2xsZXJBczogJ3Byb2ZpbGVDdHJsJ1xyXG5cdFx0fSk7XHJcblx0fV0pO1xyXG59KSgpO1xuKGZ1bmN0aW9uKCl7XHJcblx0YW5ndWxhci5tb2R1bGUoJ3VzZXInKS5mYWN0b3J5KCdBdXRoU2VydmljZScsIFtcIiRodHRwXCIsIFwiU2Vzc2lvblwiLCBmdW5jdGlvbiAoJGh0dHAsIFNlc3Npb24pIHtcclxuXHRcdHZhciBhdXRoU2VydmljZSA9IHt9O1xyXG5cdFx0dmFyIHVzZXIgPSB7fTtcclxuXHJcblx0XHRhdXRoU2VydmljZS5sb2dpbiA9IGZ1bmN0aW9uKGNyZWRlbnRpYWxzKSB7XHJcblx0XHRcdHJldHVybiAkaHR0cFxyXG5cdFx0XHQucG9zdCgnL2F1dGgvbG9jYWwnLCBjcmVkZW50aWFscylcclxuXHRcdFx0LnRoZW4oZnVuY3Rpb24gKHJlcykge1xyXG5cdFx0XHRcdFNlc3Npb24uY3JlYXRlKHJlcy5kYXRhKTtcclxuXHRcdFx0XHRyZXR1cm4gcmVzLmRhdGE7XHJcblx0XHRcdH0pO1xyXG5cdFx0fTtcclxuXHJcblx0XHRhdXRoU2VydmljZS5zaWdudXAgPSBmdW5jdGlvbihuZXdVc2VyKXtcclxuXHRcdFx0cmV0dXJuICRodHRwXHJcblx0XHRcdC5wb3N0KCcvYXBpL3VzZXIvam9pbicsIG5ld1VzZXIpXHJcblx0XHRcdC50aGVuKFxyXG5cdFx0XHRmdW5jdGlvbiBTdWNjZXNzKHJlcyl7XHJcblx0XHRcdFx0Y29uc29sZS5sb2cocmVzLmRhdGEpO1xyXG5cdFx0XHRcdFNlc3Npb24uY3JlYXRlKHJlcy5kYXRhKTtcclxuXHRcdFx0XHRyZXR1cm4gcmVzLmRhdGE7XHJcblx0XHRcdH0sIGZ1bmN0aW9uIEZhaWx1cmUocmVzKXtcclxuXHRcdFx0XHRyZXR1cm4gcmVzLmRhdGE7XHJcblx0XHRcdH0pO1xyXG5cdFx0fTtcclxuXHJcblx0XHRhdXRoU2VydmljZS5pc0F1dGhlbnRpY2F0ZWQgPSBmdW5jdGlvbigpIHtcclxuXHRcdFx0cmV0dXJuIFNlc3Npb24ubGl2ZSgpO1xyXG5cdFx0fTtcclxuXHJcblx0XHRyZXR1cm4gYXV0aFNlcnZpY2U7XHJcblx0fV0pO1xyXG5cclxuXHRhbmd1bGFyLm1vZHVsZSgndXNlcicpLnNlcnZpY2UoJ1Nlc3Npb24nLCBbXCIkcm9vdFNjb3BlXCIsIGZ1bmN0aW9uICgkcm9vdFNjb3BlKSB7XHJcblx0XHR2YXIgcm9vdCA9IHRoaXM7XHJcblx0XHR0aGlzLnVzZXIgPSB7fTtcclxuXHJcblx0XHR0aGlzLmxpdmUgPSBmdW5jdGlvbigpe1xyXG5cdFx0XHRyZXR1cm4gKE9iamVjdC5rZXlzKHJvb3QudXNlcikubGVuZ3RoID4gMCk7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5zZXRDdXJyZW50VXNlciA9IGZ1bmN0aW9uKHVzZXIpe1xyXG5cdFx0XHQkcm9vdFNjb3BlLmN1cnJlbnRVc2VyID0gdXNlcjtcclxuXHRcdFx0cm9vdC51c2VyID0gdXNlcjtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLmNyZWF0ZSA9IGZ1bmN0aW9uKHVzZXIpe1xyXG5cdFx0XHQkcm9vdFNjb3BlLmN1cnJlbnRVc2VyID0gdXNlcjtcclxuXHRcdFx0cm9vdC51c2VyID0gdXNlcjtcclxuXHRcdH07XHJcblxyXG5cdFx0dGhpcy5kZXN0cm95ID0gZnVuY3Rpb24gKCkge1xyXG5cdFx0XHQkcm9vdFNjb3BlLmN1cnJlbnRVc2VyID0gbnVsbDtcclxuXHRcdFx0cm9vdC51c2VyID0gbnVsbDtcclxuXHRcdH07XHJcblx0fV0pO1xyXG5cclxuXHRhbmd1bGFyLm1vZHVsZSgndXNlcicpLmZhY3RvcnkoJ0F1dGhSZXNvbHZlcicsIFtcIiRxXCIsIFwiJHJvb3RTY29wZVwiLCBcIiRzdGF0ZVwiLCBmdW5jdGlvbigkcSwgJHJvb3RTY29wZSwgJHN0YXRlKSB7XHJcblx0XHR2YXIgYklzUmVzb2x2ZWQgPSBmYWxzZTtcclxuXHJcblx0XHRyZXR1cm4ge1xyXG5cdFx0XHRyZXNvbHZlOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdFx0dmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcclxuXHRcdFx0XHR2YXIgdW53YXRjaCA9ICRyb290U2NvcGUuJHdhdGNoKCdjdXJyZW50VXNlcicsIGZ1bmN0aW9uIChjdXJyZW50VXNlcikge1xyXG5cdFx0XHRcdFx0aWYgKGFuZ3VsYXIuaXNEZWZpbmVkKGN1cnJlbnRVc2VyKSkge1xyXG5cdFx0XHRcdFx0XHRpZiAoY3VycmVudFVzZXIpIHtcclxuXHRcdFx0XHRcdFx0XHRkZWZlcnJlZC5yZXNvbHZlKGN1cnJlbnRVc2VyKTtcclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRkZWZlcnJlZC5yZWplY3QoKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRiSXNSZXNvbHZlZCA9IHRydWU7XHJcblx0XHRcdFx0XHRcdHVud2F0Y2goKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHRyZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcclxuXHRcdFx0fSxcclxuXHJcblx0XHRcdGJJc1Jlc29sdmVkOiBmdW5jdGlvbigpe1xyXG5cdFx0XHRcdHJldHVybiBiSXNSZXNvbHZlZDtcclxuXHRcdFx0fVxyXG5cdFx0fTtcclxuXHR9XSk7XHJcbn0pKCk7IiwiKGZ1bmN0aW9uKCl7XHJcblx0YW5ndWxhci5tb2R1bGUoJ3VzZXInKS5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uKCRzdGF0ZVByb3ZpZGVyKXtcclxuXHRcdCRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdyb290Lm1haW4uZGFzaGJvYXJkJywge1xyXG5cdFx0XHR0ZW1wbGF0ZVVybDogJy9hbmd1bGFyL2NvdXJzZXMvcGFydGlhbHMvZGFzaGJvYXJkLmh0bWwnLFxyXG5cdFx0XHRjb250cm9sbGVyOiAnRGFzaGJvYXJkQ29udHJvbGxlcicsXHJcblx0XHRcdGNvbnRyb2xsZXJBczogJ2Rhc2hib2FyZEN0cmwnXHJcblx0XHR9KTtcclxuXHJcblx0XHQkc3RhdGVQcm92aWRlci5zdGF0ZSgncm9vdC5jb3Vyc2UnLCB7XHJcblx0XHRcdHVybDogJy9jb3Vyc2UvOmNvdXJzZUNvZGUnLFxyXG5cdFx0XHR0ZW1wbGF0ZVVybDogJy9hbmd1bGFyL2NvdXJzZXMvcGFydGlhbHMvY291cnNlLmh0bWwnLFxyXG5cdFx0XHRjb250cm9sbGVyOiAnQ291cnNlQ29udHJvbGxlcicsXHJcblx0XHRcdGNvbnRyb2xsZXJBczogJ2NvdXJzZUN0cmwnXHJcblx0XHR9KTtcclxuXHR9XSk7XHJcbn0pKCk7IiwiKGZ1bmN0aW9uKCl7XHJcblx0YW5ndWxhci5tb2R1bGUoJ2NvdXJzZXMnKS5mYWN0b3J5KCdDb3Vyc2VTZXJ2aWNlJywgZnVuY3Rpb24gKCRodHRwKSB7XHJcblx0XHR0aGlzLmNyZWF0ZUNvdXJzZSA9IGZ1bmN0aW9uKG5ld0NvdXJzZSkge1xyXG5cdFx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9jb3Vyc2UvY3JlYXRlJywgbmV3Q291cnNlKTtcclxuXHRcdH07XHJcblxyXG5cdFx0dGhpcy5nZXRDb3Vyc2VzID0gZnVuY3Rpb24oKXtcclxuXHRcdFx0cmV0dXJuICRodHRwLmdldCgnL2FwaS9wcm9maWxlL2NvdXJzZXMnKTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLmdldENvdXJzZSA9IGZ1bmN0aW9uKGNvdXJzZUNvZGUpe1xyXG5cdFx0XHRyZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL2NvdXJzZS8nICsgY291cnNlQ29kZSk7XHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHRoaXM7XHJcblx0fSk7XHJcbn0pKCk7IiwiKGZ1bmN0aW9uKCl7XHJcblx0YW5ndWxhci5tb2R1bGUoJ3VzZXInKS5jb250cm9sbGVyKCdMb2dpbkNvbnRyb2xsZXInLCBmdW5jdGlvbigkc3RhdGUsICRyb290U2NvcGUsIEF1dGhTZXJ2aWNlKXtcclxuXHRcdHZhciByb290ID0gdGhpcztcclxuXHRcdHRoaXMuYXV0aE1lc3NhZ2UgPSAnJztcclxuXHRcdHRoaXMudXNlciA9IHtcclxuXHRcdFx0ZW1haWw6ICcnLFxyXG5cdFx0XHRwYXNzd29yZDogJydcclxuXHRcdH07XHJcblxyXG5cdFx0dGhpcy5sb2dpbiA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRBdXRoU2VydmljZS5sb2dpbihyb290LnVzZXIpLnRoZW4oXHJcblx0XHRcdFx0ZnVuY3Rpb24ocmVzKXtcclxuXHRcdFx0XHRcdCRzdGF0ZS5nbygncm9vdC5tYWluJyk7XHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHRmdW5jdGlvbihyZXMpe1xyXG5cdFx0XHRcdFx0cm9vdC5hdXRoTWVzc2FnZSA9IHJlcy5kYXRhLnVzZXJNZXNzYWdlO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0fTtcclxuXHR9KTtcclxuXHRcclxuXHRhbmd1bGFyLm1vZHVsZSgndXNlcicpLmNvbnRyb2xsZXIoJ0pvaW5Db250cm9sbGVyJywgZnVuY3Rpb24oJHN0YXRlLCAkcm9vdFNjb3BlLCBBdXRoU2VydmljZSl7XHJcblx0XHR2YXIgcm9vdCA9IHRoaXM7XHJcblx0XHR0aGlzLmF1dGhNZXNzYWdlID0gJyc7XHJcblx0XHR0aGlzLnVzZXIgPSB7XHJcblx0XHRcdGZpcnN0TmFtZTogJycsXHJcblx0XHRcdGxhc3ROYW1lOiAnJyxcclxuXHRcdFx0cmV0eXBlUGFzc3dvcmQ6ICcnLCBcclxuXHRcdFx0cGFzc3dvcmQ6ICcnLFxyXG5cdFx0XHRlbWFpbDogJycsXHJcblx0XHRcdGFjY291bnRUeXBlOiAnJ1xyXG5cdFx0fTtcclxuXHJcblx0XHR0aGlzLnNpZ251cCA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRBdXRoU2VydmljZS5zaWdudXAocm9vdC51c2VyKS50aGVuKFxyXG5cdFx0XHRcdGZ1bmN0aW9uKHJlcyl7XHJcblx0XHRcdFx0XHQkc3RhdGUuZ28oJ3Jvb3QubWFpbicpO1xyXG5cdFx0XHRcdH0sXHJcblx0XHRcdFx0ZnVuY3Rpb24ocmVzKXtcclxuXHRcdFx0XHRcdHJvb3QuYXV0aE1lc3NhZ2UgPSByZXMuZGF0YS51c2VyTWVzc2FnZTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdH07XHJcblx0fSk7XHJcblxyXG5cdGFuZ3VsYXIubW9kdWxlKCd1c2VyJykuY29udHJvbGxlcignUHJvZmlsZUNvbnRyb2xsZXInLCBmdW5jdGlvbigkc3RhdGUsIFNlc3Npb24pe1xyXG5cdFx0dGhpcy51c2VyID0gU2Vzc2lvbi51c2VyO1xyXG5cdH0pO1xyXG59KSgpOyIsIihmdW5jdGlvbigpe1xyXG5cdGFuZ3VsYXIubW9kdWxlKCd1c2VyJykuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbigkc3RhdGVQcm92aWRlcil7XHJcblx0XHQkc3RhdGVQcm92aWRlci5zdGF0ZSgncm9vdC5sb2dpbicsIHtcclxuXHRcdFx0dXJsOiAnL2xvZ2luJyxcclxuXHRcdFx0dGVtcGxhdGVVcmw6ICcvYW5ndWxhci91c2VyL3BhcnRpYWxzL2xvZ2luLmh0bWwnLFxyXG5cdFx0XHRjb250cm9sbGVyOiAnTG9naW5Db250cm9sbGVyJyxcclxuXHRcdFx0Y29udHJvbGxlckFzOiAnbG9naW5DdHJsJ1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0JHN0YXRlUHJvdmlkZXIuc3RhdGUoJ3Jvb3Quam9pbicsIHtcclxuXHRcdFx0dXJsOiAnL2pvaW4nLFxyXG5cdFx0XHR0ZW1wbGF0ZVVybDogJy9hbmd1bGFyL3VzZXIvcGFydGlhbHMvam9pbi5odG1sJyxcclxuXHRcdFx0Y29udHJvbGxlcjogJ0pvaW5Db250cm9sbGVyJyxcclxuXHRcdFx0Y29udHJvbGxlckFzOiAnam9pbkN0cmwnXHJcblx0XHR9KTtcclxuXHRcdFxyXG5cdFx0JHN0YXRlUHJvdmlkZXIuc3RhdGUoJ3Jvb3QucHJvZmlsZScsIHtcclxuXHRcdFx0dXJsOiAnL3Byb2ZpbGUnLFxyXG5cdFx0XHR0ZW1wbGF0ZVVybDogJy9hbmd1bGFyL3VzZXIvcGFydGlhbHMvcHJvZmlsZS5odG1sJyxcclxuXHRcdFx0Y29udHJvbGxlcjogJ1Byb2ZpbGVDb250cm9sbGVyJyxcclxuXHRcdFx0Y29udHJvbGxlckFzOiAncHJvZmlsZUN0cmwnXHJcblx0XHR9KTtcclxuXHR9XSk7XHJcbn0pKCk7IiwiKGZ1bmN0aW9uKCl7XHJcblx0YW5ndWxhci5tb2R1bGUoJ3VzZXInKS5mYWN0b3J5KCdBdXRoU2VydmljZScsIGZ1bmN0aW9uICgkaHR0cCwgU2Vzc2lvbikge1xyXG5cdFx0dmFyIGF1dGhTZXJ2aWNlID0ge307XHJcblx0XHR2YXIgdXNlciA9IHt9O1xyXG5cclxuXHRcdGF1dGhTZXJ2aWNlLmxvZ2luID0gZnVuY3Rpb24oY3JlZGVudGlhbHMpIHtcclxuXHRcdFx0cmV0dXJuICRodHRwXHJcblx0XHRcdC5wb3N0KCcvYXV0aC9sb2NhbCcsIGNyZWRlbnRpYWxzKVxyXG5cdFx0XHQudGhlbihmdW5jdGlvbiAocmVzKSB7XHJcblx0XHRcdFx0U2Vzc2lvbi5jcmVhdGUocmVzLmRhdGEpO1xyXG5cdFx0XHRcdHJldHVybiByZXMuZGF0YTtcclxuXHRcdFx0fSk7XHJcblx0XHR9O1xyXG5cclxuXHRcdGF1dGhTZXJ2aWNlLnNpZ251cCA9IGZ1bmN0aW9uKG5ld1VzZXIpe1xyXG5cdFx0XHRyZXR1cm4gJGh0dHBcclxuXHRcdFx0LnBvc3QoJy9hcGkvdXNlci9qb2luJywgbmV3VXNlcilcclxuXHRcdFx0LnRoZW4oXHJcblx0XHRcdGZ1bmN0aW9uIFN1Y2Nlc3MocmVzKXtcclxuXHRcdFx0XHRjb25zb2xlLmxvZyhyZXMuZGF0YSk7XHJcblx0XHRcdFx0U2Vzc2lvbi5jcmVhdGUocmVzLmRhdGEpO1xyXG5cdFx0XHRcdHJldHVybiByZXMuZGF0YTtcclxuXHRcdFx0fSwgZnVuY3Rpb24gRmFpbHVyZShyZXMpe1xyXG5cdFx0XHRcdHJldHVybiByZXMuZGF0YTtcclxuXHRcdFx0fSk7XHJcblx0XHR9O1xyXG5cclxuXHRcdGF1dGhTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRyZXR1cm4gU2Vzc2lvbi5saXZlKCk7XHJcblx0XHR9O1xyXG5cclxuXHRcdHJldHVybiBhdXRoU2VydmljZTtcclxuXHR9KTtcclxuXHJcblx0YW5ndWxhci5tb2R1bGUoJ3VzZXInKS5zZXJ2aWNlKCdTZXNzaW9uJywgZnVuY3Rpb24gKCRyb290U2NvcGUpIHtcclxuXHRcdHZhciByb290ID0gdGhpcztcclxuXHRcdHRoaXMudXNlciA9IHt9O1xyXG5cclxuXHRcdHRoaXMubGl2ZSA9IGZ1bmN0aW9uKCl7XHJcblx0XHRcdHJldHVybiAoT2JqZWN0LmtleXMocm9vdC51c2VyKS5sZW5ndGggPiAwKTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLnNldEN1cnJlbnRVc2VyID0gZnVuY3Rpb24odXNlcil7XHJcblx0XHRcdCRyb290U2NvcGUuY3VycmVudFVzZXIgPSB1c2VyO1xyXG5cdFx0XHRyb290LnVzZXIgPSB1c2VyO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuY3JlYXRlID0gZnVuY3Rpb24odXNlcil7XHJcblx0XHRcdCRyb290U2NvcGUuY3VycmVudFVzZXIgPSB1c2VyO1xyXG5cdFx0XHRyb290LnVzZXIgPSB1c2VyO1xyXG5cdFx0fTtcclxuXHJcblx0XHR0aGlzLmRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdCRyb290U2NvcGUuY3VycmVudFVzZXIgPSBudWxsO1xyXG5cdFx0XHRyb290LnVzZXIgPSBudWxsO1xyXG5cdFx0fTtcclxuXHR9KTtcclxuXHJcblx0YW5ndWxhci5tb2R1bGUoJ3VzZXInKS5mYWN0b3J5KCdBdXRoUmVzb2x2ZXInLCBmdW5jdGlvbigkcSwgJHJvb3RTY29wZSwgJHN0YXRlKSB7XHJcblx0XHR2YXIgYklzUmVzb2x2ZWQgPSBmYWxzZTtcclxuXHJcblx0XHRyZXR1cm4ge1xyXG5cdFx0XHRyZXNvbHZlOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdFx0dmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcclxuXHRcdFx0XHR2YXIgdW53YXRjaCA9ICRyb290U2NvcGUuJHdhdGNoKCdjdXJyZW50VXNlcicsIGZ1bmN0aW9uIChjdXJyZW50VXNlcikge1xyXG5cdFx0XHRcdFx0aWYgKGFuZ3VsYXIuaXNEZWZpbmVkKGN1cnJlbnRVc2VyKSkge1xyXG5cdFx0XHRcdFx0XHRpZiAoY3VycmVudFVzZXIpIHtcclxuXHRcdFx0XHRcdFx0XHRkZWZlcnJlZC5yZXNvbHZlKGN1cnJlbnRVc2VyKTtcclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRkZWZlcnJlZC5yZWplY3QoKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRiSXNSZXNvbHZlZCA9IHRydWU7XHJcblx0XHRcdFx0XHRcdHVud2F0Y2goKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHRyZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcclxuXHRcdFx0fSxcclxuXHJcblx0XHRcdGJJc1Jlc29sdmVkOiBmdW5jdGlvbigpe1xyXG5cdFx0XHRcdHJldHVybiBiSXNSZXNvbHZlZDtcclxuXHRcdFx0fVxyXG5cdFx0fTtcclxuXHR9KTtcclxufSkoKTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
