!function(){angular.module("courses",[])}(),function(){angular.module("general",[])}(),function(){angular.module("user",[]).run(["$http","Session",function($http,Session){$http.get("/api/profile").success(function(res){Session.create(res)}).error(function(res){Session.setCurrentUser({})})}])}(),angular.module("angularSlideables",[]).directive("slideable",function(){return{restrict:"C",compile:function(element,attr){var contents=element.html();return element.html('<div class="slideable_content" style="margin:0 !important; padding:0 !important" >'+contents+"</div>"),function(scope,element,attrs){attrs.duration=attrs.duration?attrs.duration:"1s",attrs.easing=attrs.easing?attrs.easing:"ease-in-out",element.css({overflow:"hidden",height:"0px",transitionProperty:"height",transitionDuration:attrs.duration,transitionTimingFunction:attrs.easing})}}}}).directive("slideToggle",function(){return{restrict:"A",link:function(scope,element,attrs){var target,content;attrs.expanded=!1,element.bind("click",function(){if(target||(target=document.querySelector(attrs.slideToggle)),content||(content=target.querySelector(".slideable_content")),attrs.expanded)target.style.height="0px";else{content.style.border="1px solid rgba(0,0,0,0)";var y=content.clientHeight;content.style.border=0,target.style.height=y+"px"}attrs.expanded=!attrs.expanded})}}}),function(){var app=angular.module("grader",["ui.router","general","courses","user"]);app.config(["$locationProvider",function($locationProvider){$locationProvider.html5Mode(!0)}])}(),function(){angular.module("user").controller("DashboardController",["$state","$http","CourseService","Session",function($state,$http,CourseService,Session){var root=this;root.newCourse={},root.courses=[],root.user=Session.user;var getCourses=function(){$http.get("/api/profile/courses").then(function(res){root.courses=res.data},function(res){})};this.createCourse=function(){CourseService.createCourse(root.newCourse).then(function(res){console.log(res)})},getCourses()}]),angular.module("user").controller("CourseController",["$state","$http","$stateParams",function($state,$http,$stateParams){alert($stateParams.courseCode)}])}(),function(){angular.module("user").config(["$stateProvider",function($stateProvider){$stateProvider.state("root.main.dashboard",{templateUrl:"/angular/courses/partials/dashboard.html",controller:"DashboardController",controllerAs:"dashboardCtrl"}),$stateProvider.state("root.course",{url:"/course/:courseCode",templateUrl:"/angular/courses/partials/course.html",controller:"CourseController",controllerAs:"courseCtrl"})}])}(),function(){angular.module("courses").factory("CourseService",["$http","Session",function($http,Session){var courseService={};return courseService.createCourse=function(newCourse){return $http.post("/api/course/create",newCourse).then(function(res){return res.data},function(res){return res.data})},courseService}])}(),function(){angular.module("general").controller("NavController",["$http","AuthService","AuthResolver","$state",function($http,AuthService,AuthResolver,$state){var root=this;this.$state=$state,this.bLoggedIn=null,AuthResolver.bIsResolved()?root.bLoggedIn=AuthService.isAuthenticated():AuthResolver.resolve().then(function(){root.bLoggedIn=AuthService.isAuthenticated()})}])}(),function(){angular.module("general").config(["$stateProvider",function($stateProvider){$stateProvider.state("root",{"abstract":!0,template:"<ui-view/>",resolve:{auth:["AuthResolver",function(AuthResolver){return AuthResolver.bIsResolved()===!0||AuthResolver.resolve()}]}}).state("root.main",{url:"/",template:"<ui-view/>",controller:["$state","AuthService",function($state,AuthService){console.log($state.current.name),console.log(AuthService.isAuthenticated()),AuthService.isAuthenticated()?$state.go("root.main.dashboard"):$state.go("root.main.public")}]}).state("root.main.public",{templateUrl:"/angular/general/partials/index.html",controller:function(){console.log("Hit public index")}})}])}(),function(){angular.module("user").controller("LoginController",["$state","$rootScope","AuthService",function($state,$rootScope,AuthService){var root=this;this.authMessage="",this.user={email:"",password:""},this.login=function(){AuthService.login(root.user).then(function(res){$state.go("root.main")},function(res){root.authMessage=res.data.userMessage})}}]),angular.module("user").controller("JoinController",["$state","$rootScope","AuthService",function($state,$rootScope,AuthService){var root=this;this.authMessage="",this.user={firstName:"",lastName:"",retypePassword:"",password:"",email:"",accountType:""},this.signup=function(){AuthService.signup(root.user).then(function(res){$state.go("root.main")},function(res){root.authMessage=res.data.userMessage})}}]),angular.module("user").controller("ProfileController",["$state","Session",function($state,Session){this.user=Session.user}])}(),function(){angular.module("user").config(["$stateProvider",function($stateProvider){$stateProvider.state("root.login",{url:"/login",templateUrl:"/angular/user/partials/login.html",controller:"LoginController",controllerAs:"loginCtrl"}),$stateProvider.state("root.join",{url:"/join",templateUrl:"/angular/user/partials/join.html",controller:"JoinController",controllerAs:"joinCtrl"}),$stateProvider.state("root.profile",{url:"/profile",templateUrl:"/angular/user/partials/profile.html",controller:"ProfileController",controllerAs:"profileCtrl"})}])}(),function(){angular.module("user").factory("AuthService",["$http","Session",function($http,Session){var authService={};return authService.login=function(credentials){return $http.post("/auth/local",credentials).then(function(res){return Session.create(res.data),res.data})},authService.signup=function(newUser){return $http.post("/api/user/join",newUser).then(function(res){return console.log(res.data),Session.create(res.data),res.data},function(res){return res.data})},authService.isAuthenticated=function(){return Session.live()},authService}]),angular.module("user").service("Session",["$rootScope",function($rootScope){var root=this;this.user={},this.live=function(){return Object.keys(root.user).length>0},this.setCurrentUser=function(user){$rootScope.currentUser=user,root.user=user},this.create=function(user){$rootScope.currentUser=user,root.user=user},this.destroy=function(){$rootScope.currentUser=null,root.user=null}}]),angular.module("user").factory("AuthResolver",["$q","$rootScope","$state",function($q,$rootScope,$state){var bIsResolved=!1;return{resolve:function(){var deferred=$q.defer(),unwatch=$rootScope.$watch("currentUser",function(currentUser){angular.isDefined(currentUser)&&(currentUser?deferred.resolve(currentUser):deferred.reject(),bIsResolved=!0,unwatch())});return deferred.promise},bIsResolved:function(){return bIsResolved}}}])}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvdXJzZXMvY291cnNlcy5tb2R1bGUuanMiLCJnZW5lcmFsL2dlbmVyYWwubW9kdWxlLmpzIiwidXNlci91c2VyLm1vZHVsZS5qcyIsIm1pc2Mvc2xpZGVhYmxlLm1vZHVsZS5qcyIsImNvcmUuanMiLCJjb3Vyc2VzL2NvdXJzZXMuY3RybC5qcyIsImNvdXJzZXMvY291cnNlcy5zdGF0ZXMuanMiLCJjb3Vyc2VzL2NvdXJzZXMuc3ZjLmpzIiwiZ2VuZXJhbC9nZW5lcmFsLmN0cmwuanMiLCJnZW5lcmFsL2dlbmVyYWwuc3RhdGVzLmpzIiwidXNlci91c2VyLmN0cmwuanMiLCJ1c2VyL3VzZXIuc3RhdGVzLmpzIiwidXNlci91c2VyLnN2Yy5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwicnVuIiwiJGh0dHAiLCJTZXNzaW9uIiwiZ2V0Iiwic3VjY2VzcyIsInJlcyIsImNyZWF0ZSIsImVycm9yIiwic2V0Q3VycmVudFVzZXIiLCJkaXJlY3RpdmUiLCJyZXN0cmljdCIsImNvbXBpbGUiLCJlbGVtZW50IiwiYXR0ciIsImNvbnRlbnRzIiwiaHRtbCIsInNjb3BlIiwiYXR0cnMiLCJkdXJhdGlvbiIsImVhc2luZyIsImNzcyIsIm92ZXJmbG93IiwiaGVpZ2h0IiwidHJhbnNpdGlvblByb3BlcnR5IiwidHJhbnNpdGlvbkR1cmF0aW9uIiwidHJhbnNpdGlvblRpbWluZ0Z1bmN0aW9uIiwibGluayIsInRhcmdldCIsImNvbnRlbnQiLCJleHBhbmRlZCIsImJpbmQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJzbGlkZVRvZ2dsZSIsInN0eWxlIiwiYm9yZGVyIiwieSIsImNsaWVudEhlaWdodCIsImFwcCIsImNvbmZpZyIsIiRsb2NhdGlvblByb3ZpZGVyIiwiaHRtbDVNb2RlIiwiY29udHJvbGxlciIsIiRzdGF0ZSIsIkNvdXJzZVNlcnZpY2UiLCJyb290IiwidGhpcyIsIm5ld0NvdXJzZSIsImNvdXJzZXMiLCJ1c2VyIiwiZ2V0Q291cnNlcyIsInRoZW4iLCJkYXRhIiwiY3JlYXRlQ291cnNlIiwiY29uc29sZSIsImxvZyIsIiRzdGF0ZVBhcmFtcyIsImFsZXJ0IiwiY291cnNlQ29kZSIsIiRzdGF0ZVByb3ZpZGVyIiwic3RhdGUiLCJ0ZW1wbGF0ZVVybCIsImNvbnRyb2xsZXJBcyIsInVybCIsImZhY3RvcnkiLCJjb3Vyc2VTZXJ2aWNlIiwicG9zdCIsIkF1dGhTZXJ2aWNlIiwiQXV0aFJlc29sdmVyIiwiYkxvZ2dlZEluIiwiYklzUmVzb2x2ZWQiLCJpc0F1dGhlbnRpY2F0ZWQiLCJyZXNvbHZlIiwiYWJzdHJhY3QiLCJ0ZW1wbGF0ZSIsImF1dGgiLCJjdXJyZW50IiwibmFtZSIsImdvIiwiJHJvb3RTY29wZSIsImF1dGhNZXNzYWdlIiwiZW1haWwiLCJwYXNzd29yZCIsImxvZ2luIiwidXNlck1lc3NhZ2UiLCJmaXJzdE5hbWUiLCJsYXN0TmFtZSIsInJldHlwZVBhc3N3b3JkIiwiYWNjb3VudFR5cGUiLCJzaWdudXAiLCJhdXRoU2VydmljZSIsImNyZWRlbnRpYWxzIiwibmV3VXNlciIsImxpdmUiLCJzZXJ2aWNlIiwiT2JqZWN0Iiwia2V5cyIsImxlbmd0aCIsImN1cnJlbnRVc2VyIiwiZGVzdHJveSIsIiRxIiwiZGVmZXJyZWQiLCJkZWZlciIsInVud2F0Y2giLCIkd2F0Y2giLCJpc0RlZmluZWQiLCJyZWplY3QiLCJwcm9taXNlIl0sIm1hcHBpbmdzIjoiQ0FBQSxXQUNBQSxRQUFBQyxPQUFBLGlCQ0RBLFdBQ0FELFFBQUFDLE9BQUEsaUJDREEsV0FDQUQsUUFBQUMsT0FBQSxXQUNBQyxLQUFBLFFBQUEsVUFBQSxTQUFBQyxNQUFBQyxTQUNBRCxNQUFBRSxJQUFBLGdCQUNBQyxRQUFBLFNBQUFDLEtBQ0FILFFBQUFJLE9BQUFELE9BRUFFLE1BQUEsU0FBQUYsS0FDQUgsUUFBQU0sMkJDUkFWLFFBQUFDLE9BQUEsd0JBQ0FVLFVBQUEsWUFBQSxXQUNBLE9BQ0FDLFNBQUEsSUFDQUMsUUFBQSxTQUFBQyxRQUFBQyxNQUVBLEdBQUFD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Z0QsT0FBQSxHQUdBbkQsS0FBQXRDLGVBQUEsU0FBQXlDLE1BQ0E4QixXQUFBbUIsWUFBQWpELEtBQ0FKLEtBQUFJLEtBQUFBLE1BR0FILEtBQUF4QyxPQUFBLFNBQUEyQyxNQUNBOEIsV0FBQW1CLFlBQUFqRCxLQUNBSixLQUFBSSxLQUFBQSxNQUdBSCxLQUFBcUQsUUFBQSxXQUNBcEIsV0FBQW1CLFlBQUEsS0FDQXJELEtBQUFJLEtBQUEsU0FJQW5ELFFBQUFDLE9BQUEsUUFBQWlFLFFBQUEsZ0JBQUEsS0FBQSxhQUFBLFNBQUEsU0FBQW9DLEdBQUFyQixXQUFBcEMsUUFDQSxHQUFBMkIsY0FBQSxDQUVBLFFBQ0FFLFFBQUEsV0FDQSxHQUFBNkIsVUFBQUQsR0FBQUUsUUFDQUMsUUFBQXhCLFdBQUF5QixPQUFBLGNBQUEsU0FBQU4sYUFDQXBHLFFBQUEyRyxVQUFBUCxlQUNBQSxZQUNBRyxTQUFBN0IsUUFBQTBCLGFBRUFHLFNBQUFLLFNBRUFwQyxhQUFBLEVBQ0FpQyxZQUdBLE9BQUFGLFVBQUFNLFNBR0FyQyxZQUFBLFdBQ0EsTUFBQUEiLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe1xyXG5cdHZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnY291cnNlcycsIFtdKTtcclxufSkoKTsiLCIoZnVuY3Rpb24oKXtcclxuXHR2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ2dlbmVyYWwnLCBbXSk7XHJcbn0pKCk7IiwiKGZ1bmN0aW9uKCl7XHJcblx0dmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCd1c2VyJywgW10pXHJcblx0LnJ1bihmdW5jdGlvbigkaHR0cCwgU2Vzc2lvbil7XHJcblx0XHQkaHR0cC5nZXQoJy9hcGkvcHJvZmlsZScpXHJcblx0XHQuc3VjY2VzcyhmdW5jdGlvbihyZXMpe1xyXG5cdFx0XHRTZXNzaW9uLmNyZWF0ZShyZXMpO1xyXG5cdFx0fSlcclxuXHRcdC5lcnJvcihmdW5jdGlvbihyZXMpe1xyXG5cdFx0XHRTZXNzaW9uLnNldEN1cnJlbnRVc2VyKHt9KTtcclxuXHRcdH0pO1xyXG5cdH0pO1xyXG59KSgpOyIsImFuZ3VsYXIubW9kdWxlKCdhbmd1bGFyU2xpZGVhYmxlcycsIFtdKVxyXG4uZGlyZWN0aXZlKCdzbGlkZWFibGUnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHJlc3RyaWN0OidDJyxcclxuICAgICAgICBjb21waWxlOiBmdW5jdGlvbiAoZWxlbWVudCwgYXR0cikge1xyXG4gICAgICAgICAgICAvLyB3cmFwIHRhZ1xyXG4gICAgICAgICAgICB2YXIgY29udGVudHMgPSBlbGVtZW50Lmh0bWwoKTtcclxuICAgICAgICAgICAgZWxlbWVudC5odG1sKCc8ZGl2IGNsYXNzPVwic2xpZGVhYmxlX2NvbnRlbnRcIiBzdHlsZT1cIm1hcmdpbjowICFpbXBvcnRhbnQ7IHBhZGRpbmc6MCAhaW1wb3J0YW50XCIgPicgKyBjb250ZW50cyArICc8L2Rpdj4nKTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiBwb3N0TGluayhzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcclxuICAgICAgICAgICAgICAgIC8vIGRlZmF1bHQgcHJvcGVydGllc1xyXG4gICAgICAgICAgICAgICAgYXR0cnMuZHVyYXRpb24gPSAoIWF0dHJzLmR1cmF0aW9uKSA/ICcxcycgOiBhdHRycy5kdXJhdGlvbjtcclxuICAgICAgICAgICAgICAgIGF0dHJzLmVhc2luZyA9ICghYXR0cnMuZWFzaW5nKSA/ICdlYXNlLWluLW91dCcgOiBhdHRycy5lYXNpbmc7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LmNzcyh7XHJcbiAgICAgICAgICAgICAgICAgICAgJ292ZXJmbG93JzogJ2hpZGRlbicsXHJcbiAgICAgICAgICAgICAgICAgICAgJ2hlaWdodCc6ICcwcHgnLFxyXG4gICAgICAgICAgICAgICAgICAgICd0cmFuc2l0aW9uUHJvcGVydHknOiAnaGVpZ2h0JyxcclxuICAgICAgICAgICAgICAgICAgICAndHJhbnNpdGlvbkR1cmF0aW9uJzogYXR0cnMuZHVyYXRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgJ3RyYW5zaXRpb25UaW1pbmdGdW5jdGlvbic6IGF0dHJzLmVhc2luZ1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufSlcclxuLmRpcmVjdGl2ZSgnc2xpZGVUb2dnbGUnLCBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgcmVzdHJpY3Q6ICdBJyxcclxuICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcclxuICAgICAgICAgICAgdmFyIHRhcmdldCwgY29udGVudDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGF0dHJzLmV4cGFuZGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBlbGVtZW50LmJpbmQoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRhcmdldCkgdGFyZ2V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdHRycy5zbGlkZVRvZ2dsZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWNvbnRlbnQpIGNvbnRlbnQgPSB0YXJnZXQucXVlcnlTZWxlY3RvcignLnNsaWRlYWJsZV9jb250ZW50Jyk7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGlmKCFhdHRycy5leHBhbmRlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQuc3R5bGUuYm9yZGVyID0gJzFweCBzb2xpZCByZ2JhKDAsMCwwLDApJztcclxuICAgICAgICAgICAgICAgICAgICB2YXIgeSA9IGNvbnRlbnQuY2xpZW50SGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQuc3R5bGUuYm9yZGVyID0gMDtcclxuICAgICAgICAgICAgICAgICAgICB0YXJnZXQuc3R5bGUuaGVpZ2h0ID0geSArICdweCc7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldC5zdHlsZS5oZWlnaHQgPSAnMHB4JztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGF0dHJzLmV4cGFuZGVkID0gIWF0dHJzLmV4cGFuZGVkO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0pOyIsIihmdW5jdGlvbigpe1xyXG5cdHZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnZ3JhZGVyJywgXHJcblx0XHRbXHJcblx0XHRcdCd1aS5yb3V0ZXInLFxyXG5cdFx0XHQnZ2VuZXJhbCcsXHJcblx0XHRcdCdjb3Vyc2VzJyxcclxuXHRcdFx0J3VzZXInXHJcblx0XHRdKTtcclxuXHJcblx0Ly9yZW1vdmUgdGhlIGhhc2hcclxuXHRhcHAuY29uZmlnKFsnJGxvY2F0aW9uUHJvdmlkZXInLCBmdW5jdGlvbigkbG9jYXRpb25Qcm92aWRlcil7XHJcblx0XHQkbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUodHJ1ZSk7XHJcblx0fV0pO1xyXG5cdFxyXG4vKlx0YXBwLnJ1bihmdW5jdGlvbiAoJHJvb3RTY29wZSwgQXV0aFNlcnZpY2UsIEF1dGhSZXNvbHZlcikge1xyXG4gIFx0XHQkcm9vdFNjb3BlLiRvbignJHN0YXRlQ2hhbmdlU3RhcnQnLCBmdW5jdGlvbiAoZXZlbnQsIG5leHQpIHtcclxuICBcdFx0XHRpZiAoQXV0aFJlc29sdmVyLmJJc1Jlc29sdmVkKCkpe1xyXG4gIFx0XHRcdFx0Y29uc29sZS5sb2coJ3N0YXRlQ2hhbmdlU3RhcnQgcmVzb2x2ZWQnKTtcclxuICBcdFx0XHRcdGNvbnNvbGUubG9nKCdhdXRoOiAnICsgQXV0aFNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCkpO1xyXG4gIFx0XHRcdH1lbHNle1xyXG4gIFx0XHRcdFx0QXV0aFJlc29sdmVyLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uKGRhdGEpe1xyXG4gIFx0XHRcdFx0XHRjb25zb2xlLmxvZygnc3RhdGVDaGFuZ2VTdGFydCBub3QgcmVzb2x2ZWQnKTtcclxuICBcdFx0XHRcdFx0Y29uc29sZS5sb2coJ2F1dGg6ICcgKyBBdXRoU2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKSk7XHJcbiAgXHRcdFx0XHR9KVxyXG4gIFx0XHRcdH1cclxuICBcdFx0fSk7XHJcblx0fSkqL1xyXG59KSgpOyIsIihmdW5jdGlvbigpe1xyXG5cdGFuZ3VsYXIubW9kdWxlKCd1c2VyJykuY29udHJvbGxlcignRGFzaGJvYXJkQ29udHJvbGxlcicsIGZ1bmN0aW9uKCRzdGF0ZSwgJGh0dHAsIENvdXJzZVNlcnZpY2UsIFNlc3Npb24pe1xyXG5cdFx0dmFyIHJvb3QgPSB0aGlzO1xyXG5cdFx0cm9vdC5uZXdDb3Vyc2UgPSB7fTtcclxuXHRcdHJvb3QuY291cnNlcyA9IFtdO1xyXG5cdFx0cm9vdC51c2VyID0gU2Vzc2lvbi51c2VyO1xyXG5cclxuXHRcdHZhciBnZXRDb3Vyc2VzID0gZnVuY3Rpb24oKXtcclxuXHRcdFx0JGh0dHBcclxuXHRcdFx0LmdldCgnL2FwaS9wcm9maWxlL2NvdXJzZXMnKVxyXG5cdFx0XHQudGhlbihmdW5jdGlvbiBTdWNjZXNzKHJlcyl7XHJcblx0XHRcdFx0cm9vdC5jb3Vyc2VzID0gcmVzLmRhdGE7XHJcblx0XHRcdH0sIGZ1bmN0aW9uIEZhaWx1cmUocmVzKXtcclxuXHRcdFx0fSk7XHJcblx0XHR9O1xyXG5cclxuXHRcdHRoaXMuY3JlYXRlQ291cnNlID0gZnVuY3Rpb24oKXtcclxuXHRcdFx0Q291cnNlU2VydmljZS5jcmVhdGVDb3Vyc2Uocm9vdC5uZXdDb3Vyc2UpLnRoZW4oZnVuY3Rpb24ocmVzKXtcclxuXHRcdFx0XHRjb25zb2xlLmxvZyhyZXMpO1xyXG5cdFx0XHR9KTtcclxuXHRcdH1cclxuXHJcblx0XHRnZXRDb3Vyc2VzKCk7XHJcblx0fSk7XHJcblxyXG5cdGFuZ3VsYXIubW9kdWxlKCd1c2VyJykuY29udHJvbGxlcignQ291cnNlQ29udHJvbGxlcicsIGZ1bmN0aW9uKCRzdGF0ZSwgJGh0dHAsICRzdGF0ZVBhcmFtcyl7XHJcblx0XHRhbGVydCgkc3RhdGVQYXJhbXMuY291cnNlQ29kZSk7XHJcblx0fSk7XHJcbn0pKCk7IiwiKGZ1bmN0aW9uKCl7XHJcblx0YW5ndWxhci5tb2R1bGUoJ3VzZXInKS5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uKCRzdGF0ZVByb3ZpZGVyKXtcclxuXHRcdCRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdyb290Lm1haW4uZGFzaGJvYXJkJywge1xyXG5cdFx0XHR0ZW1wbGF0ZVVybDogJy9hbmd1bGFyL2NvdXJzZXMvcGFydGlhbHMvZGFzaGJvYXJkLmh0bWwnLFxyXG5cdFx0XHRjb250cm9sbGVyOiAnRGFzaGJvYXJkQ29udHJvbGxlcicsXHJcblx0XHRcdGNvbnRyb2xsZXJBczogJ2Rhc2hib2FyZEN0cmwnXHJcblx0XHR9KTtcclxuXHJcblx0XHQkc3RhdGVQcm92aWRlci5zdGF0ZSgncm9vdC5jb3Vyc2UnLCB7XHJcblx0XHRcdHVybDogJy9jb3Vyc2UvOmNvdXJzZUNvZGUnLFxyXG5cdFx0XHR0ZW1wbGF0ZVVybDogJy9hbmd1bGFyL2NvdXJzZXMvcGFydGlhbHMvY291cnNlLmh0bWwnLFxyXG5cdFx0XHRjb250cm9sbGVyOiAnQ291cnNlQ29udHJvbGxlcicsXHJcblx0XHRcdGNvbnRyb2xsZXJBczogJ2NvdXJzZUN0cmwnXHJcblx0XHR9KTtcclxuXHR9XSk7XHJcbn0pKCk7IiwiKGZ1bmN0aW9uKCl7XHJcblx0YW5ndWxhci5tb2R1bGUoJ2NvdXJzZXMnKS5mYWN0b3J5KCdDb3Vyc2VTZXJ2aWNlJywgZnVuY3Rpb24gKCRodHRwLCBTZXNzaW9uKSB7XHJcblx0XHR2YXIgY291cnNlU2VydmljZSA9IHt9O1xyXG5cclxuXHRcdGNvdXJzZVNlcnZpY2UuY3JlYXRlQ291cnNlID0gZnVuY3Rpb24obmV3Q291cnNlKSB7XHJcblx0XHRcdHJldHVybiAkaHR0cFxyXG5cdFx0XHQucG9zdCgnL2FwaS9jb3Vyc2UvY3JlYXRlJywgbmV3Q291cnNlKVxyXG5cdFx0XHQudGhlbihmdW5jdGlvbiBTdWNjZXNzKHJlcykge1xyXG5cdFx0XHRcdHJldHVybiByZXMuZGF0YTtcclxuXHRcdFx0fSwgZnVuY3Rpb24gRmFpbHVyZShyZXMpe1xyXG5cdFx0XHRcdHJldHVybiByZXMuZGF0YTtcclxuXHRcdFx0fSk7XHJcblx0XHR9O1xyXG5cclxuXHRcdHJldHVybiBjb3Vyc2VTZXJ2aWNlO1xyXG5cdH0pO1xyXG59KSgpOyIsIihmdW5jdGlvbigpe1xyXG5cdGFuZ3VsYXIubW9kdWxlKCdnZW5lcmFsJykuY29udHJvbGxlcignTmF2Q29udHJvbGxlcicsIGZ1bmN0aW9uKCRodHRwLCBBdXRoU2VydmljZSwgQXV0aFJlc29sdmVyLCAkc3RhdGUpe1xyXG5cdFx0dmFyIHJvb3QgPSB0aGlzO1xyXG5cdFx0dGhpcy4kc3RhdGUgPSAkc3RhdGU7XHJcblx0XHR0aGlzLmJMb2dnZWRJbiA9IG51bGw7XHJcblx0XHRcclxuXHRcdGlmIChBdXRoUmVzb2x2ZXIuYklzUmVzb2x2ZWQoKSl7XHJcblx0XHRcdHJvb3QuYkxvZ2dlZEluID0gQXV0aFNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCk7XHJcblx0XHR9ZWxzZXtcclxuXHRcdFx0QXV0aFJlc29sdmVyLnJlc29sdmUoKS50aGVuKGZ1bmN0aW9uKCl7XHJcblx0XHRcdFx0cm9vdC5iTG9nZ2VkSW4gPSBBdXRoU2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKTtcclxuXHRcdFx0fSk7XHJcblx0XHR9XHJcblx0fSk7XHJcbn0pKCk7IiwiKGZ1bmN0aW9uKCl7XHJcblx0YW5ndWxhci5tb2R1bGUoJ2dlbmVyYWwnKS5jb25maWcoZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIpe1xyXG5cclxuXHRcdCRzdGF0ZVByb3ZpZGVyXHJcblx0XHQuc3RhdGUoJ3Jvb3QnLCB7XHJcblx0XHRcdGFic3RyYWN0OiB0cnVlLFxyXG5cdFx0XHR0ZW1wbGF0ZTogJzx1aS12aWV3Lz4nLFxyXG5cdFx0XHRyZXNvbHZlOiB7XHJcblx0XHRcdFx0YXV0aDogZnVuY3Rpb24gcmVzb2x2ZUF1dGhlbnRpY2F0aW9uKEF1dGhSZXNvbHZlcikgeyBcclxuXHRcdFx0XHRcdHJldHVybiAoQXV0aFJlc29sdmVyLmJJc1Jlc29sdmVkKCkgPT09IHRydWUgfHwgQXV0aFJlc29sdmVyLnJlc29sdmUoKSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9KVxyXG5cclxuXHRcdC5zdGF0ZSgncm9vdC5tYWluJywge1xyXG5cdFx0XHR1cmw6ICcvJyxcclxuXHRcdFx0dGVtcGxhdGU6ICc8dWktdmlldy8+JyxcclxuXHRcdFx0Y29udHJvbGxlcjogZnVuY3Rpb24oJHN0YXRlLCBBdXRoU2VydmljZSl7XHJcblx0XHRcdFx0Y29uc29sZS5sb2coJHN0YXRlLmN1cnJlbnQubmFtZSk7XHJcblx0XHRcdFx0Y29uc29sZS5sb2coQXV0aFNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCkpO1xyXG5cdFx0XHRcdGlmIChBdXRoU2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKSl7XHJcblx0XHRcdFx0XHQkc3RhdGUuZ28oJ3Jvb3QubWFpbi5kYXNoYm9hcmQnKTtcclxuXHRcdFx0XHR9ZWxzZXtcclxuXHRcdFx0XHRcdCRzdGF0ZS5nbygncm9vdC5tYWluLnB1YmxpYycpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSlcclxuXHJcblx0XHQuc3RhdGUoJ3Jvb3QubWFpbi5wdWJsaWMnLCB7XHJcblx0XHRcdHRlbXBsYXRlVXJsOiAnL2FuZ3VsYXIvZ2VuZXJhbC9wYXJ0aWFscy9pbmRleC5odG1sJyxcclxuXHRcdFx0Y29udHJvbGxlcjogZnVuY3Rpb24oKXtcclxuXHRcdFx0XHRjb25zb2xlLmxvZygnSGl0IHB1YmxpYyBpbmRleCcpO1xyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHR9KTtcclxufSkoKTsiLCIoZnVuY3Rpb24oKXtcclxuXHJcblx0YW5ndWxhci5tb2R1bGUoJ3VzZXInKS5jb250cm9sbGVyKCdMb2dpbkNvbnRyb2xsZXInLCBmdW5jdGlvbigkc3RhdGUsICRyb290U2NvcGUsIEF1dGhTZXJ2aWNlKXtcclxuXHRcdHZhciByb290ID0gdGhpcztcclxuXHRcdHRoaXMuYXV0aE1lc3NhZ2UgPSAnJztcclxuXHRcdHRoaXMudXNlciA9IHtcclxuXHRcdFx0ZW1haWw6ICcnLFxyXG5cdFx0XHRwYXNzd29yZDogJydcclxuXHRcdH07XHJcblxyXG5cdFx0dGhpcy5sb2dpbiA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRBdXRoU2VydmljZS5sb2dpbihyb290LnVzZXIpLnRoZW4oXHJcblx0XHRcdFx0ZnVuY3Rpb24ocmVzKXtcclxuXHRcdFx0XHRcdCRzdGF0ZS5nbygncm9vdC5tYWluJyk7XHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHRmdW5jdGlvbihyZXMpe1xyXG5cdFx0XHRcdFx0cm9vdC5hdXRoTWVzc2FnZSA9IHJlcy5kYXRhLnVzZXJNZXNzYWdlO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0fTtcclxuXHR9KTtcclxuXHRcclxuXHRhbmd1bGFyLm1vZHVsZSgndXNlcicpLmNvbnRyb2xsZXIoJ0pvaW5Db250cm9sbGVyJywgZnVuY3Rpb24oJHN0YXRlLCAkcm9vdFNjb3BlLCBBdXRoU2VydmljZSl7XHJcblx0XHR2YXIgcm9vdCA9IHRoaXM7XHJcblx0XHR0aGlzLmF1dGhNZXNzYWdlID0gJyc7XHJcblx0XHR0aGlzLnVzZXIgPSB7XHJcblx0XHRcdGZpcnN0TmFtZTogJycsXHJcblx0XHRcdGxhc3ROYW1lOiAnJyxcclxuXHRcdFx0cmV0eXBlUGFzc3dvcmQ6ICcnLCBcclxuXHRcdFx0cGFzc3dvcmQ6ICcnLFxyXG5cdFx0XHRlbWFpbDogJycsXHJcblx0XHRcdGFjY291bnRUeXBlOiAnJ1xyXG5cdFx0fTtcclxuXHJcblx0XHR0aGlzLnNpZ251cCA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRBdXRoU2VydmljZS5zaWdudXAocm9vdC51c2VyKS50aGVuKFxyXG5cdFx0XHRcdGZ1bmN0aW9uKHJlcyl7XHJcblx0XHRcdFx0XHQkc3RhdGUuZ28oJ3Jvb3QubWFpbicpO1xyXG5cdFx0XHRcdH0sXHJcblx0XHRcdFx0ZnVuY3Rpb24ocmVzKXtcclxuXHRcdFx0XHRcdHJvb3QuYXV0aE1lc3NhZ2UgPSByZXMuZGF0YS51c2VyTWVzc2FnZTtcclxuXHRcdFx0XHR9KTtcclxuXHRcdH07XHJcblx0fSk7XHJcblxyXG5cdGFuZ3VsYXIubW9kdWxlKCd1c2VyJykuY29udHJvbGxlcignUHJvZmlsZUNvbnRyb2xsZXInLCBmdW5jdGlvbigkc3RhdGUsIFNlc3Npb24pe1xyXG5cdFx0dGhpcy51c2VyID0gU2Vzc2lvbi51c2VyO1xyXG5cdH0pO1xyXG59KSgpOyIsIihmdW5jdGlvbigpe1xyXG5cdGFuZ3VsYXIubW9kdWxlKCd1c2VyJykuY29uZmlnKFsnJHN0YXRlUHJvdmlkZXInLCBmdW5jdGlvbigkc3RhdGVQcm92aWRlcil7XHJcblx0XHQkc3RhdGVQcm92aWRlci5zdGF0ZSgncm9vdC5sb2dpbicsIHtcclxuXHRcdFx0dXJsOiAnL2xvZ2luJyxcclxuXHRcdFx0dGVtcGxhdGVVcmw6ICcvYW5ndWxhci91c2VyL3BhcnRpYWxzL2xvZ2luLmh0bWwnLFxyXG5cdFx0XHRjb250cm9sbGVyOiAnTG9naW5Db250cm9sbGVyJyxcclxuXHRcdFx0Y29udHJvbGxlckFzOiAnbG9naW5DdHJsJ1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0JHN0YXRlUHJvdmlkZXIuc3RhdGUoJ3Jvb3Quam9pbicsIHtcclxuXHRcdFx0dXJsOiAnL2pvaW4nLFxyXG5cdFx0XHR0ZW1wbGF0ZVVybDogJy9hbmd1bGFyL3VzZXIvcGFydGlhbHMvam9pbi5odG1sJyxcclxuXHRcdFx0Y29udHJvbGxlcjogJ0pvaW5Db250cm9sbGVyJyxcclxuXHRcdFx0Y29udHJvbGxlckFzOiAnam9pbkN0cmwnXHJcblx0XHR9KTtcclxuXHRcdFxyXG5cdFx0JHN0YXRlUHJvdmlkZXIuc3RhdGUoJ3Jvb3QucHJvZmlsZScsIHtcclxuXHRcdFx0dXJsOiAnL3Byb2ZpbGUnLFxyXG5cdFx0XHR0ZW1wbGF0ZVVybDogJy9hbmd1bGFyL3VzZXIvcGFydGlhbHMvcHJvZmlsZS5odG1sJyxcclxuXHRcdFx0Y29udHJvbGxlcjogJ1Byb2ZpbGVDb250cm9sbGVyJyxcclxuXHRcdFx0Y29udHJvbGxlckFzOiAncHJvZmlsZUN0cmwnXHJcblx0XHR9KTtcclxuXHR9XSk7XHJcbn0pKCk7IiwiKGZ1bmN0aW9uKCl7XHJcblx0YW5ndWxhci5tb2R1bGUoJ3VzZXInKS5mYWN0b3J5KCdBdXRoU2VydmljZScsIGZ1bmN0aW9uICgkaHR0cCwgU2Vzc2lvbikge1xyXG5cdFx0dmFyIGF1dGhTZXJ2aWNlID0ge307XHJcblx0XHR2YXIgdXNlciA9IHt9O1xyXG5cclxuXHRcdGF1dGhTZXJ2aWNlLmxvZ2luID0gZnVuY3Rpb24oY3JlZGVudGlhbHMpIHtcclxuXHRcdFx0cmV0dXJuICRodHRwXHJcblx0XHRcdC5wb3N0KCcvYXV0aC9sb2NhbCcsIGNyZWRlbnRpYWxzKVxyXG5cdFx0XHQudGhlbihmdW5jdGlvbiAocmVzKSB7XHJcblx0XHRcdFx0U2Vzc2lvbi5jcmVhdGUocmVzLmRhdGEpO1xyXG5cdFx0XHRcdHJldHVybiByZXMuZGF0YTtcclxuXHRcdFx0fSk7XHJcblx0XHR9O1xyXG5cclxuXHRcdGF1dGhTZXJ2aWNlLnNpZ251cCA9IGZ1bmN0aW9uKG5ld1VzZXIpe1xyXG5cdFx0XHRyZXR1cm4gJGh0dHBcclxuXHRcdFx0LnBvc3QoJy9hcGkvdXNlci9qb2luJywgbmV3VXNlcilcclxuXHRcdFx0LnRoZW4oXHJcblx0XHRcdGZ1bmN0aW9uIFN1Y2Nlc3MocmVzKXtcclxuXHRcdFx0XHRjb25zb2xlLmxvZyhyZXMuZGF0YSk7XHJcblx0XHRcdFx0U2Vzc2lvbi5jcmVhdGUocmVzLmRhdGEpO1xyXG5cdFx0XHRcdHJldHVybiByZXMuZGF0YTtcclxuXHRcdFx0fSwgZnVuY3Rpb24gRmFpbHVyZShyZXMpe1xyXG5cdFx0XHRcdHJldHVybiByZXMuZGF0YTtcclxuXHRcdFx0fSk7XHJcblx0XHR9O1xyXG5cclxuXHRcdGF1dGhTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRyZXR1cm4gU2Vzc2lvbi5saXZlKCk7XHJcblx0XHR9O1xyXG5cclxuXHRcdHJldHVybiBhdXRoU2VydmljZTtcclxuXHR9KTtcclxuXHJcblx0YW5ndWxhci5tb2R1bGUoJ3VzZXInKS5zZXJ2aWNlKCdTZXNzaW9uJywgZnVuY3Rpb24gKCRyb290U2NvcGUpIHtcclxuXHRcdHZhciByb290ID0gdGhpcztcclxuXHRcdHRoaXMudXNlciA9IHt9O1xyXG5cclxuXHRcdHRoaXMubGl2ZSA9IGZ1bmN0aW9uKCl7XHJcblx0XHRcdHJldHVybiAoT2JqZWN0LmtleXMocm9vdC51c2VyKS5sZW5ndGggPiAwKTtcclxuXHRcdH1cclxuXHJcblx0XHR0aGlzLnNldEN1cnJlbnRVc2VyID0gZnVuY3Rpb24odXNlcil7XHJcblx0XHRcdCRyb290U2NvcGUuY3VycmVudFVzZXIgPSB1c2VyO1xyXG5cdFx0XHRyb290LnVzZXIgPSB1c2VyO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuY3JlYXRlID0gZnVuY3Rpb24odXNlcil7XHJcblx0XHRcdCRyb290U2NvcGUuY3VycmVudFVzZXIgPSB1c2VyO1xyXG5cdFx0XHRyb290LnVzZXIgPSB1c2VyO1xyXG5cdFx0fTtcclxuXHJcblx0XHR0aGlzLmRlc3Ryb3kgPSBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdCRyb290U2NvcGUuY3VycmVudFVzZXIgPSBudWxsO1xyXG5cdFx0XHRyb290LnVzZXIgPSBudWxsO1xyXG5cdFx0fTtcclxuXHR9KTtcclxuXHJcblx0YW5ndWxhci5tb2R1bGUoJ3VzZXInKS5mYWN0b3J5KCdBdXRoUmVzb2x2ZXInLCBmdW5jdGlvbigkcSwgJHJvb3RTY29wZSwgJHN0YXRlKSB7XHJcblx0XHR2YXIgYklzUmVzb2x2ZWQgPSBmYWxzZTtcclxuXHJcblx0XHRyZXR1cm4ge1xyXG5cdFx0XHRyZXNvbHZlOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdFx0dmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcclxuXHRcdFx0XHR2YXIgdW53YXRjaCA9ICRyb290U2NvcGUuJHdhdGNoKCdjdXJyZW50VXNlcicsIGZ1bmN0aW9uIChjdXJyZW50VXNlcikge1xyXG5cdFx0XHRcdFx0aWYgKGFuZ3VsYXIuaXNEZWZpbmVkKGN1cnJlbnRVc2VyKSkge1xyXG5cdFx0XHRcdFx0XHRpZiAoY3VycmVudFVzZXIpIHtcclxuXHRcdFx0XHRcdFx0XHRkZWZlcnJlZC5yZXNvbHZlKGN1cnJlbnRVc2VyKTtcclxuXHRcdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0XHRkZWZlcnJlZC5yZWplY3QoKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRiSXNSZXNvbHZlZCA9IHRydWU7XHJcblx0XHRcdFx0XHRcdHVud2F0Y2goKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0XHRyZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcclxuXHRcdFx0fSxcclxuXHJcblx0XHRcdGJJc1Jlc29sdmVkOiBmdW5jdGlvbigpe1xyXG5cdFx0XHRcdHJldHVybiBiSXNSZXNvbHZlZDtcclxuXHRcdFx0fVxyXG5cdFx0fTtcclxuXHR9KTtcclxufSkoKTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
