!function(){angular.module("courses",[])}(),function(){angular.module("general",[])}(),function(){angular.module("user",[]).run(["$http","Session",function($http,Session){$http.get("/api/profile").success(function(res){Session.create(res)}).error(function(res){Session.setCurrentUser({})})}])}(),angular.module("angularSlideables",[]).directive("slideable",function(){return{restrict:"C",compile:function(element,attr){var contents=element.html();return element.html('<div class="slideable_content" style="margin:0 !important; padding:0 !important" >'+contents+"</div>"),function(scope,element,attrs){attrs.duration=attrs.duration?attrs.duration:"1s",attrs.easing=attrs.easing?attrs.easing:"ease-in-out",element.css({overflow:"hidden",height:"0px",transitionProperty:"height",transitionDuration:attrs.duration,transitionTimingFunction:attrs.easing})}}}}).directive("slideToggle",function(){return{restrict:"A",link:function(scope,element,attrs){var target,content;attrs.expanded=!1,element.bind("click",function(){if(target||(target=document.querySelector(attrs.slideToggle)),content||(content=target.querySelector(".slideable_content")),attrs.expanded)target.style.height="0px";else{content.style.border="1px solid rgba(0,0,0,0)";var y=content.clientHeight;content.style.border=0,target.style.height=y+"px"}attrs.expanded=!attrs.expanded})}}}),function(){var app=angular.module("grader",["ui.router","general","courses","user"]);app.config(["$locationProvider",function($locationProvider){$locationProvider.html5Mode(!0)}]),app.run(["$rootScope","AuthService","AuthResolver",function($rootScope,AuthService,AuthResolver){$rootScope.$on("$stateChangeStart",function(event,next){AuthResolver.bIsResolved()?(console.log("stateChangeStart resolved"),console.log("auth: "+AuthService.isAuthenticated())):AuthResolver.resolve().then(function(data){console.log("stateChangeStart not resolved"),console.log("auth: "+AuthService.isAuthenticated())})})}])}(),function(){angular.module("user").controller("DashboardController",["$state","$http","CourseService","Session",function($state,$http,CourseService,Session){var root=this;root.newCourse={},root.courses=[],root.user=Session.user;var getCourses=function(){$http.get("/api/profile/courses").then(function(res){root.courses=res.data,console.log(res.data)})};this.createCourse=function(){CourseService.createCourse(root.newCourse).then(function(res){console.log(res)})},getCourses()}])}(),function(){angular.module("user").config(["$stateProvider",function($stateProvider){$stateProvider.state("root.dashboard",{templateUrl:"/angular/courses/partials/dashboard.html",controller:"DashboardController",controllerAs:"dashboardCtrl"})}])}(),function(){angular.module("courses").factory("CourseService",["$http","Session",function($http,Session){var courseService={};return courseService.createCourse=function(newCourse){return $http.post("/api/course/create",newCourse).then(function(res){return res.data},function(res){return res.data})},courseService}])}(),function(){angular.module("general").controller("NavController",["$http","AuthService","AuthResolver","$state",function($http,AuthService,AuthResolver,$state){var root=this;this.$state=$state,this.bLoggedIn=null,AuthResolver.bIsResolved()?root.bLoggedIn=AuthService.isAuthenticated():AuthResolver.resolve().then(function(){root.bLoggedIn=AuthService.isAuthenticated()})}])}(),function(){angular.module("general").config(["$stateProvider",function($stateProvider){$stateProvider.state("root",{"abstract":!0,template:"<ui-view/>",resolve:{auth:["AuthResolver",function(AuthResolver){return AuthResolver.bIsResolved()===!0||AuthResolver.resolve()}]}}).state("root.main",{url:"/",template:"<ui-view/>",controller:["$state","AuthService",function($state,AuthService){console.log("hi"),AuthService.isAuthenticated()?$state.go("root.dashboard"):$state.go("root.public")}]}).state("root.public",{templateUrl:"/angular/general/partials/index.html"})}])}(),function(){angular.module("user").controller("LoginController",["$state","$rootScope","AuthService",function($state,$rootScope,AuthService){var root=this;this.authMessage="",this.user={email:"",password:""},this.login=function(){AuthService.login(root.user).then(function(res){$state.go("root.main")},function(res){root.authMessage=res.data.userMessage})}}]),angular.module("user").controller("JoinController",["$state","$rootScope","AuthService",function($state,$rootScope,AuthService){var root=this;this.authMessage="",this.user={firstName:"",lastName:"",retypePassword:"",password:"",email:"",accountType:""},this.signup=function(){AuthService.signup(root.user).then(function(res){$state.go("root.main")},function(res){root.authMessage=res.data.userMessage})}}]),angular.module("user").controller("ProfileController",["$state","Session",function($state,Session){this.user=Session.user}])}(),function(){angular.module("user").config(["$stateProvider",function($stateProvider){$stateProvider.state("root.login",{url:"/login",templateUrl:"/angular/user/partials/login.html",controller:"LoginController",controllerAs:"loginCtrl"}),$stateProvider.state("root.join",{url:"/join",templateUrl:"/angular/user/partials/join.html",controller:"JoinController",controllerAs:"joinCtrl"}),$stateProvider.state("root.profile",{url:"/profile",templateUrl:"/angular/user/partials/profile.html",controller:"ProfileController",controllerAs:"profileCtrl"})}])}(),function(){angular.module("user").factory("AuthService",["$http","Session",function($http,Session){var authService={};return authService.login=function(credentials){return $http.post("/auth/local",credentials).then(function(res){return Session.create(res.data),res.data})},authService.signup=function(newUser){return $http.post("/api/user/join",newUser).then(function(res){return console.log(res.data),Session.create(res.data),res.data},function(res){return res.data})},authService.isAuthenticated=function(){return Session.live()},authService}]),angular.module("user").service("Session",["$rootScope",function($rootScope){var root=this;this.user={},this.live=function(){return Object.keys(root.user).length>0},this.setCurrentUser=function(user){$rootScope.currentUser=user,root.user=user},this.create=function(user){$rootScope.currentUser=user,root.user=user},this.destroy=function(){$rootScope.currentUser=null,root.user=null}}]),angular.module("user").factory("AuthResolver",["$q","$rootScope","$state",function($q,$rootScope,$state){var bIsResolved=!1;return{resolve:function(){var deferred=$q.defer(),unwatch=$rootScope.$watch("currentUser",function(currentUser){angular.isDefined(currentUser)&&(currentUser?deferred.resolve(currentUser):deferred.reject(),bIsResolved=!0,unwatch())});return deferred.promise},bIsResolved:function(){return bIsResolved}}}])}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvdXJzZXMvY291cnNlcy5tb2R1bGUuanMiLCJnZW5lcmFsL2dlbmVyYWwubW9kdWxlLmpzIiwidXNlci91c2VyLm1vZHVsZS5qcyIsIm1pc2Mvc2xpZGVhYmxlLm1vZHVsZS5qcyIsImNvcmUuanMiLCJjb3Vyc2VzL2NvdXJzZXMuY3RybC5qcyIsImNvdXJzZXMvY291cnNlcy5zdGF0ZXMuanMiLCJjb3Vyc2VzL2NvdXJzZXMuc3ZjLmpzIiwiZ2VuZXJhbC9nZW5lcmFsLmN0cmwuanMiLCJnZW5lcmFsL2dlbmVyYWwuc3RhdGVzLmpzIiwidXNlci91c2VyLmN0cmwuanMiLCJ1c2VyL3VzZXIuc3RhdGVzLmpzIiwidXNlci91c2VyLnN2Yy5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwicnVuIiwiJGh0dHAiLCJTZXNzaW9uIiwiZ2V0Iiwic3VjY2VzcyIsInJlcyIsImNyZWF0ZSIsImVycm9yIiwic2V0Q3VycmVudFVzZXIiLCJkaXJlY3RpdmUiLCJyZXN0cmljdCIsImNvbXBpbGUiLCJlbGVtZW50IiwiYXR0ciIsImNvbnRlbnRzIiwiaHRtbCIsInNjb3BlIiwiYXR0cnMiLCJkdXJhdGlvbiIsImVhc2luZyIsImNzcyIsIm92ZXJmbG93IiwiaGVpZ2h0IiwidHJhbnNpdGlvblByb3BlcnR5IiwidHJhbnNpdGlvbkR1cmF0aW9uIiwidHJhbnNpdGlvblRpbWluZ0Z1bmN0aW9uIiwibGluayIsInRhcmdldCIsImNvbnRlbnQiLCJleHBhbmRlZCIsImJpbmQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJzbGlkZVRvZ2dsZSIsInN0eWxlIiwiYm9yZGVyIiwieSIsImNsaWVudEhlaWdodCIsImFwcCIsImNvbmZpZyIsIiRsb2NhdGlvblByb3ZpZGVyIiwiaHRtbDVNb2RlIiwiJHJvb3RTY29wZSIsIkF1dGhTZXJ2aWNlIiwiQXV0aFJlc29sdmVyIiwiJG9uIiwiZXZlbnQiLCJuZXh0IiwiYklzUmVzb2x2ZWQiLCJjb25zb2xlIiwibG9nIiwiaXNBdXRoZW50aWNhdGVkIiwicmVzb2x2ZSIsInRoZW4iLCJkYXRhIiwiY29udHJvbGxlciIsIiRzdGF0ZSIsIkNvdXJzZVNlcnZpY2UiLCJyb290IiwidGhpcyIsIm5ld0NvdXJzZSIsImNvdXJzZXMiLCJ1c2VyIiwiZ2V0Q291cnNlcyIsImNyZWF0ZUNvdXJzZSIsIiRzdGF0ZVByb3ZpZGVyIiwic3RhdGUiLCJ0ZW1wbGF0ZVVybCIsImNvbnRyb2xsZXJBcyIsImZhY3RvcnkiLCJjb3Vyc2VTZXJ2aWNlIiwicG9zdCIsImJMb2dnZWRJbiIsImFic3RyYWN0IiwidGVtcGxhdGUiLCJhdXRoIiwidXJsIiwiZ28iLCJhdXRoTWVzc2FnZSIsImVtYWlsIiwicGFzc3dvcmQiLCJsb2dpbiIsInVzZXJNZXNzYWdlIiwiZmlyc3ROYW1lIiwibGFzdE5hbWUiLCJyZXR5cGVQYXNzd29yZCIsImFjY291bnRUeXBlIiwic2lnbnVwIiwiYXV0aFNlcnZpY2UiLCJjcmVkZW50aWFscyIsIm5ld1VzZXIiLCJsaXZlIiwic2VydmljZSIsIk9iamVjdCIsImtleXMiLCJsZW5ndGgiLCJjdXJyZW50VXNlciIsImRlc3Ryb3kiLCIkcSIsImRlZmVycmVkIiwiZGVmZXIiLCJ1bndhdGNoIiwiJHdhdGNoIiwiaXNEZWZpbmVkIiwicmVqZWN0IiwicHJvbWlzZSJdLCJtYXBwaW5ncyI6IkNBQUEsV0FDQUEsUUFBQUMsT0FBQSxpQkNEQSxXQUNBRCxRQUFBQyxPQUFBLGlCQ0RBLFdBQ0FELFFBQUFDLE9BQUEsV0FDQUMsS0FBQSxRQUFBLFVBQUEsU0FBQUMsTUFBQUMsU0FDQUQsTUFBQUUsSUFBQSxnQkFDQUMsUUFBQSxTQUFBQyxLQUNBSCxRQUFBSSxPQUFBRCxPQUVBRSxNQUFBLFNBQUFGLEtBQ0FILFFBQUFNLDJCQ1JBVixRQUFBQyxPQUFBLHdCQUNBVSxVQUFBLFlBQUEsV0FDQSxPQUNBQyxTQUFBLElBQ0FDLFFBQUEsU0FBQUMsUUFBQUMsTUFFQSxHQUFBQyxVQUFBRixRQUFBRyxNQUdBLE9BRkFILFNBQUFHLEtB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Q0FwQixXQUFBc0QsWUFBQWxDLEtBQ0FKLEtBQUFJLEtBQUFBLE1BR0FILEtBQUFyRCxPQUFBLFNBQUF3RCxNQUNBcEIsV0FBQXNELFlBQUFsQyxLQUNBSixLQUFBSSxLQUFBQSxNQUdBSCxLQUFBc0MsUUFBQSxXQUNBdkQsV0FBQXNELFlBQUEsS0FDQXRDLEtBQUFJLEtBQUEsU0FJQWhFLFFBQUFDLE9BQUEsUUFBQXNFLFFBQUEsZ0JBQUEsS0FBQSxhQUFBLFNBQUEsU0FBQTZCLEdBQUF4RCxXQUFBYyxRQUNBLEdBQUFSLGNBQUEsQ0FFQSxRQUNBSSxRQUFBLFdBQ0EsR0FBQStDLFVBQUFELEdBQUFFLFFBQ0FDLFFBQUEzRCxXQUFBNEQsT0FBQSxjQUFBLFNBQUFOLGFBQ0FsRyxRQUFBeUcsVUFBQVAsZUFDQUEsWUFDQUcsU0FBQS9DLFFBQUE0QyxhQUVBRyxTQUFBSyxTQUVBeEQsYUFBQSxFQUNBcUQsWUFHQSxPQUFBRixVQUFBTSxTQUdBekQsWUFBQSxXQUNBLE1BQUFBIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXtcclxuXHR2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ2NvdXJzZXMnLCBbXSlcclxufSkoKTsiLCIoZnVuY3Rpb24oKXtcclxuXHR2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ2dlbmVyYWwnLCBbXSk7XHJcbn0pKCk7IiwiKGZ1bmN0aW9uKCl7XHJcblx0dmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCd1c2VyJywgW10pXHJcblx0LnJ1bihmdW5jdGlvbigkaHR0cCwgU2Vzc2lvbil7XHJcblx0XHQkaHR0cC5nZXQoJy9hcGkvcHJvZmlsZScpXHJcblx0XHQuc3VjY2VzcyhmdW5jdGlvbihyZXMpe1xyXG5cdFx0XHRTZXNzaW9uLmNyZWF0ZShyZXMpO1xyXG5cdFx0fSlcclxuXHRcdC5lcnJvcihmdW5jdGlvbihyZXMpe1xyXG5cdFx0XHRTZXNzaW9uLnNldEN1cnJlbnRVc2VyKHt9KTtcclxuXHRcdH0pO1xyXG5cdH0pO1xyXG59KSgpOyIsImFuZ3VsYXIubW9kdWxlKCdhbmd1bGFyU2xpZGVhYmxlcycsIFtdKVxyXG4uZGlyZWN0aXZlKCdzbGlkZWFibGUnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHJlc3RyaWN0OidDJyxcclxuICAgICAgICBjb21waWxlOiBmdW5jdGlvbiAoZWxlbWVudCwgYXR0cikge1xyXG4gICAgICAgICAgICAvLyB3cmFwIHRhZ1xyXG4gICAgICAgICAgICB2YXIgY29udGVudHMgPSBlbGVtZW50Lmh0bWwoKTtcclxuICAgICAgICAgICAgZWxlbWVudC5odG1sKCc8ZGl2IGNsYXNzPVwic2xpZGVhYmxlX2NvbnRlbnRcIiBzdHlsZT1cIm1hcmdpbjowICFpbXBvcnRhbnQ7IHBhZGRpbmc6MCAhaW1wb3J0YW50XCIgPicgKyBjb250ZW50cyArICc8L2Rpdj4nKTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiBwb3N0TGluayhzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcclxuICAgICAgICAgICAgICAgIC8vIGRlZmF1bHQgcHJvcGVydGllc1xyXG4gICAgICAgICAgICAgICAgYXR0cnMuZHVyYXRpb24gPSAoIWF0dHJzLmR1cmF0aW9uKSA/ICcxcycgOiBhdHRycy5kdXJhdGlvbjtcclxuICAgICAgICAgICAgICAgIGF0dHJzLmVhc2luZyA9ICghYXR0cnMuZWFzaW5nKSA/ICdlYXNlLWluLW91dCcgOiBhdHRycy5lYXNpbmc7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50LmNzcyh7XHJcbiAgICAgICAgICAgICAgICAgICAgJ292ZXJmbG93JzogJ2hpZGRlbicsXHJcbiAgICAgICAgICAgICAgICAgICAgJ2hlaWdodCc6ICcwcHgnLFxyXG4gICAgICAgICAgICAgICAgICAgICd0cmFuc2l0aW9uUHJvcGVydHknOiAnaGVpZ2h0JyxcclxuICAgICAgICAgICAgICAgICAgICAndHJhbnNpdGlvbkR1cmF0aW9uJzogYXR0cnMuZHVyYXRpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgJ3RyYW5zaXRpb25UaW1pbmdGdW5jdGlvbic6IGF0dHJzLmVhc2luZ1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufSlcclxuLmRpcmVjdGl2ZSgnc2xpZGVUb2dnbGUnLCBmdW5jdGlvbigpIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgcmVzdHJpY3Q6ICdBJyxcclxuICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcclxuICAgICAgICAgICAgdmFyIHRhcmdldCwgY29udGVudDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGF0dHJzLmV4cGFuZGVkID0gZmFsc2U7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBlbGVtZW50LmJpbmQoJ2NsaWNrJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIXRhcmdldCkgdGFyZ2V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdHRycy5zbGlkZVRvZ2dsZSk7XHJcbiAgICAgICAgICAgICAgICBpZiAoIWNvbnRlbnQpIGNvbnRlbnQgPSB0YXJnZXQucXVlcnlTZWxlY3RvcignLnNsaWRlYWJsZV9jb250ZW50Jyk7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGlmKCFhdHRycy5leHBhbmRlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQuc3R5bGUuYm9yZGVyID0gJzFweCBzb2xpZCByZ2JhKDAsMCwwLDApJztcclxuICAgICAgICAgICAgICAgICAgICB2YXIgeSA9IGNvbnRlbnQuY2xpZW50SGVpZ2h0O1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRlbnQuc3R5bGUuYm9yZGVyID0gMDtcclxuICAgICAgICAgICAgICAgICAgICB0YXJnZXQuc3R5bGUuaGVpZ2h0ID0geSArICdweCc7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIHRhcmdldC5zdHlsZS5oZWlnaHQgPSAnMHB4JztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGF0dHJzLmV4cGFuZGVkID0gIWF0dHJzLmV4cGFuZGVkO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0pOyIsIihmdW5jdGlvbigpe1xyXG5cdHZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnZ3JhZGVyJywgXHJcblx0XHRbXHJcblx0XHRcdCd1aS5yb3V0ZXInLFxyXG5cdFx0XHQnZ2VuZXJhbCcsXHJcblx0XHRcdCdjb3Vyc2VzJyxcclxuXHRcdFx0J3VzZXInXHJcblx0XHRdKTtcclxuXHJcblx0Ly9yZW1vdmUgdGhlIGhhc2hcclxuXHRhcHAuY29uZmlnKFsnJGxvY2F0aW9uUHJvdmlkZXInLCBmdW5jdGlvbigkbG9jYXRpb25Qcm92aWRlcil7XHJcblx0XHQkbG9jYXRpb25Qcm92aWRlci5odG1sNU1vZGUodHJ1ZSk7XHJcblx0fV0pO1xyXG5cdFxyXG5cdGFwcC5ydW4oZnVuY3Rpb24gKCRyb290U2NvcGUsIEF1dGhTZXJ2aWNlLCBBdXRoUmVzb2x2ZXIpIHtcclxuICBcdFx0JHJvb3RTY29wZS4kb24oJyRzdGF0ZUNoYW5nZVN0YXJ0JywgZnVuY3Rpb24gKGV2ZW50LCBuZXh0KSB7XHJcbiAgXHRcdFx0aWYgKEF1dGhSZXNvbHZlci5iSXNSZXNvbHZlZCgpKXtcclxuICBcdFx0XHRcdGNvbnNvbGUubG9nKCdzdGF0ZUNoYW5nZVN0YXJ0IHJlc29sdmVkJyk7XHJcbiAgXHRcdFx0XHRjb25zb2xlLmxvZygnYXV0aDogJyArIEF1dGhTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCgpKTtcclxuICBcdFx0XHR9ZWxzZXtcclxuICBcdFx0XHRcdEF1dGhSZXNvbHZlci5yZXNvbHZlKCkudGhlbihmdW5jdGlvbihkYXRhKXtcclxuICBcdFx0XHRcdFx0Y29uc29sZS5sb2coJ3N0YXRlQ2hhbmdlU3RhcnQgbm90IHJlc29sdmVkJyk7XHJcbiAgXHRcdFx0XHRcdGNvbnNvbGUubG9nKCdhdXRoOiAnICsgQXV0aFNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCkpO1xyXG4gIFx0XHRcdFx0fSlcclxuICBcdFx0XHR9XHJcbiAgXHRcdH0pO1xyXG5cdH0pXHJcblxyXG59KSgpOyIsIihmdW5jdGlvbigpe1xyXG5cdGFuZ3VsYXIubW9kdWxlKCd1c2VyJykuY29udHJvbGxlcignRGFzaGJvYXJkQ29udHJvbGxlcicsIGZ1bmN0aW9uKCRzdGF0ZSwgJGh0dHAsIENvdXJzZVNlcnZpY2UsIFNlc3Npb24pe1xyXG5cdFx0dmFyIHJvb3QgPSB0aGlzO1xyXG5cdFx0cm9vdC5uZXdDb3Vyc2UgPSB7fTtcclxuXHRcdHJvb3QuY291cnNlcyA9IFtdO1xyXG5cdFx0cm9vdC51c2VyID0gU2Vzc2lvbi51c2VyO1xyXG5cclxuXHRcdHZhciBnZXRDb3Vyc2VzID0gZnVuY3Rpb24oKXtcclxuXHRcdFx0JGh0dHBcclxuXHRcdFx0LmdldCgnL2FwaS9wcm9maWxlL2NvdXJzZXMnKVxyXG5cdFx0XHQudGhlbihmdW5jdGlvbihyZXMpe1xyXG5cdFx0XHRcdHJvb3QuY291cnNlcyA9IHJlcy5kYXRhO1xyXG5cdFx0XHRcdGNvbnNvbGUubG9nKHJlcy5kYXRhKTtcclxuXHRcdFx0fSk7XHJcblx0XHR9O1xyXG5cclxuXHRcdHRoaXMuY3JlYXRlQ291cnNlID0gZnVuY3Rpb24oKXtcclxuXHRcdFx0Q291cnNlU2VydmljZS5jcmVhdGVDb3Vyc2Uocm9vdC5uZXdDb3Vyc2UpLnRoZW4oZnVuY3Rpb24ocmVzKXtcclxuXHRcdFx0XHRjb25zb2xlLmxvZyhyZXMpO1xyXG5cdFx0XHR9KTtcclxuXHRcdH1cclxuXHJcblx0XHRnZXRDb3Vyc2VzKCk7XHJcblx0fSk7XHJcbn0pKCk7IiwiKGZ1bmN0aW9uKCl7XHJcblx0YW5ndWxhci5tb2R1bGUoJ3VzZXInKS5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uKCRzdGF0ZVByb3ZpZGVyKXtcclxuXHRcdCRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdyb290LmRhc2hib2FyZCcsIHtcclxuXHRcdFx0dGVtcGxhdGVVcmw6ICcvYW5ndWxhci9jb3Vyc2VzL3BhcnRpYWxzL2Rhc2hib2FyZC5odG1sJyxcclxuXHRcdFx0Y29udHJvbGxlcjogJ0Rhc2hib2FyZENvbnRyb2xsZXInLFxyXG5cdFx0XHRjb250cm9sbGVyQXM6ICdkYXNoYm9hcmRDdHJsJ1xyXG5cdFx0fSk7XHJcblx0fV0pO1xyXG59KSgpOyIsIihmdW5jdGlvbigpe1xyXG5cdGFuZ3VsYXIubW9kdWxlKCdjb3Vyc2VzJykuZmFjdG9yeSgnQ291cnNlU2VydmljZScsIGZ1bmN0aW9uICgkaHR0cCwgU2Vzc2lvbikge1xyXG5cdFx0dmFyIGNvdXJzZVNlcnZpY2UgPSB7fTtcclxuXHJcblx0XHRjb3Vyc2VTZXJ2aWNlLmNyZWF0ZUNvdXJzZSA9IGZ1bmN0aW9uKG5ld0NvdXJzZSkge1xyXG5cdFx0XHRyZXR1cm4gJGh0dHBcclxuXHRcdFx0LnBvc3QoJy9hcGkvY291cnNlL2NyZWF0ZScsIG5ld0NvdXJzZSlcclxuXHRcdFx0LnRoZW4oZnVuY3Rpb24gU3VjY2VzcyhyZXMpIHtcclxuXHRcdFx0XHRyZXR1cm4gcmVzLmRhdGE7XHJcblx0XHRcdH0sIGZ1bmN0aW9uIEZhaWx1cmUocmVzKXtcclxuXHRcdFx0XHRyZXR1cm4gcmVzLmRhdGE7XHJcblx0XHRcdH0pO1xyXG5cdFx0fTtcclxuXHJcblx0XHRyZXR1cm4gY291cnNlU2VydmljZTtcclxuXHR9KTtcclxufSkoKTsiLCIoZnVuY3Rpb24oKXtcclxuXHRhbmd1bGFyLm1vZHVsZSgnZ2VuZXJhbCcpLmNvbnRyb2xsZXIoJ05hdkNvbnRyb2xsZXInLCBmdW5jdGlvbigkaHR0cCwgQXV0aFNlcnZpY2UsIEF1dGhSZXNvbHZlciwgJHN0YXRlKXtcclxuXHRcdHZhciByb290ID0gdGhpcztcclxuXHRcdHRoaXMuJHN0YXRlID0gJHN0YXRlO1xyXG5cdFx0dGhpcy5iTG9nZ2VkSW4gPSBudWxsO1xyXG5cdFx0XHJcblx0XHRpZiAoQXV0aFJlc29sdmVyLmJJc1Jlc29sdmVkKCkpe1xyXG5cdFx0XHRyb290LmJMb2dnZWRJbiA9IEF1dGhTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCgpO1xyXG5cdFx0fWVsc2V7XHJcblx0XHRcdEF1dGhSZXNvbHZlci5yZXNvbHZlKCkudGhlbihmdW5jdGlvbigpe1xyXG5cdFx0XHRcdHJvb3QuYkxvZ2dlZEluID0gQXV0aFNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCk7XHJcblx0XHRcdH0pO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG59KSgpOyIsIihmdW5jdGlvbigpe1xyXG5cdGFuZ3VsYXIubW9kdWxlKCdnZW5lcmFsJykuY29uZmlnKGZ1bmN0aW9uKCRzdGF0ZVByb3ZpZGVyKXtcclxuXHJcblx0XHQkc3RhdGVQcm92aWRlclxyXG5cdFx0LnN0YXRlKCdyb290Jywge1xyXG5cdFx0XHRhYnN0cmFjdDogdHJ1ZSxcclxuXHRcdFx0dGVtcGxhdGU6ICc8dWktdmlldy8+JyxcclxuXHRcdFx0cmVzb2x2ZToge1xyXG5cdFx0XHRcdGF1dGg6IGZ1bmN0aW9uIHJlc29sdmVBdXRoZW50aWNhdGlvbihBdXRoUmVzb2x2ZXIpIHsgXHJcblx0XHRcdFx0XHRyZXR1cm4gKEF1dGhSZXNvbHZlci5iSXNSZXNvbHZlZCgpID09PSB0cnVlIHx8IEF1dGhSZXNvbHZlci5yZXNvbHZlKCkpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0fSlcclxuXHJcblx0XHQuc3RhdGUoJ3Jvb3QubWFpbicsIHtcclxuXHRcdFx0dXJsOiAnLycsXHJcblx0XHRcdHRlbXBsYXRlOiAnPHVpLXZpZXcvPicsXHJcblx0XHRcdGNvbnRyb2xsZXI6IGZ1bmN0aW9uKCRzdGF0ZSwgQXV0aFNlcnZpY2Upe1xyXG5cdFx0XHRcdGNvbnNvbGUubG9nKCdoaScpO1xyXG5cdFx0XHRcdGlmIChBdXRoU2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKSl7XHJcblx0XHRcdFx0XHQkc3RhdGUuZ28oJ3Jvb3QuZGFzaGJvYXJkJyk7XHJcblx0XHRcdFx0fWVsc2V7XHJcblx0XHRcdFx0XHQkc3RhdGUuZ28oJ3Jvb3QucHVibGljJyk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9KVxyXG5cclxuXHRcdC5zdGF0ZSgncm9vdC5wdWJsaWMnLCB7XHJcblx0XHRcdHRlbXBsYXRlVXJsOiAnL2FuZ3VsYXIvZ2VuZXJhbC9wYXJ0aWFscy9pbmRleC5odG1sJ1xyXG5cdFx0fSk7XHJcblxyXG5cdH0pO1xyXG59KSgpOyIsIihmdW5jdGlvbigpe1xyXG5cclxuXHRhbmd1bGFyLm1vZHVsZSgndXNlcicpLmNvbnRyb2xsZXIoJ0xvZ2luQ29udHJvbGxlcicsIGZ1bmN0aW9uKCRzdGF0ZSwgJHJvb3RTY29wZSwgQXV0aFNlcnZpY2Upe1xyXG5cdFx0dmFyIHJvb3QgPSB0aGlzO1xyXG5cdFx0dGhpcy5hdXRoTWVzc2FnZSA9ICcnO1xyXG5cdFx0dGhpcy51c2VyID0ge1xyXG5cdFx0XHRlbWFpbDogJycsXHJcblx0XHRcdHBhc3N3b3JkOiAnJ1xyXG5cdFx0fTtcclxuXHJcblx0XHR0aGlzLmxvZ2luID0gZnVuY3Rpb24oKSB7XHJcblx0XHRcdEF1dGhTZXJ2aWNlLmxvZ2luKHJvb3QudXNlcikudGhlbihcclxuXHRcdFx0XHRmdW5jdGlvbihyZXMpe1xyXG5cdFx0XHRcdFx0JHN0YXRlLmdvKCdyb290Lm1haW4nKTtcclxuXHRcdFx0XHR9LFxyXG5cdFx0XHRcdGZ1bmN0aW9uKHJlcyl7XHJcblx0XHRcdFx0XHRyb290LmF1dGhNZXNzYWdlID0gcmVzLmRhdGEudXNlck1lc3NhZ2U7XHJcblx0XHRcdFx0fSk7XHJcblx0XHR9O1xyXG5cdH0pO1xyXG5cdFxyXG5cdGFuZ3VsYXIubW9kdWxlKCd1c2VyJykuY29udHJvbGxlcignSm9pbkNvbnRyb2xsZXInLCBmdW5jdGlvbigkc3RhdGUsICRyb290U2NvcGUsIEF1dGhTZXJ2aWNlKXtcclxuXHRcdHZhciByb290ID0gdGhpcztcclxuXHRcdHRoaXMuYXV0aE1lc3NhZ2UgPSAnJztcclxuXHRcdHRoaXMudXNlciA9IHtcclxuXHRcdFx0Zmlyc3ROYW1lOiAnJyxcclxuXHRcdFx0bGFzdE5hbWU6ICcnLFxyXG5cdFx0XHRyZXR5cGVQYXNzd29yZDogJycsIFxyXG5cdFx0XHRwYXNzd29yZDogJycsXHJcblx0XHRcdGVtYWlsOiAnJyxcclxuXHRcdFx0YWNjb3VudFR5cGU6ICcnXHJcblx0XHR9O1xyXG5cclxuXHRcdHRoaXMuc2lnbnVwID0gZnVuY3Rpb24oKSB7XHJcblx0XHRcdEF1dGhTZXJ2aWNlLnNpZ251cChyb290LnVzZXIpLnRoZW4oXHJcblx0XHRcdFx0ZnVuY3Rpb24ocmVzKXtcclxuXHRcdFx0XHRcdCRzdGF0ZS5nbygncm9vdC5tYWluJyk7XHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHRmdW5jdGlvbihyZXMpe1xyXG5cdFx0XHRcdFx0cm9vdC5hdXRoTWVzc2FnZSA9IHJlcy5kYXRhLnVzZXJNZXNzYWdlO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0fTtcclxuXHR9KTtcclxuXHJcblx0YW5ndWxhci5tb2R1bGUoJ3VzZXInKS5jb250cm9sbGVyKCdQcm9maWxlQ29udHJvbGxlcicsIGZ1bmN0aW9uKCRzdGF0ZSwgU2Vzc2lvbil7XHJcblx0XHR0aGlzLnVzZXIgPSBTZXNzaW9uLnVzZXI7XHJcblx0fSk7XHJcbn0pKCk7IiwiKGZ1bmN0aW9uKCl7XHJcblx0YW5ndWxhci5tb2R1bGUoJ3VzZXInKS5jb25maWcoWyckc3RhdGVQcm92aWRlcicsIGZ1bmN0aW9uKCRzdGF0ZVByb3ZpZGVyKXtcclxuXHRcdCRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdyb290LmxvZ2luJywge1xyXG5cdFx0XHR1cmw6ICcvbG9naW4nLFxyXG5cdFx0XHR0ZW1wbGF0ZVVybDogJy9hbmd1bGFyL3VzZXIvcGFydGlhbHMvbG9naW4uaHRtbCcsXHJcblx0XHRcdGNvbnRyb2xsZXI6ICdMb2dpbkNvbnRyb2xsZXInLFxyXG5cdFx0XHRjb250cm9sbGVyQXM6ICdsb2dpbkN0cmwnXHJcblx0XHR9KTtcclxuXHJcblx0XHQkc3RhdGVQcm92aWRlci5zdGF0ZSgncm9vdC5qb2luJywge1xyXG5cdFx0XHR1cmw6ICcvam9pbicsXHJcblx0XHRcdHRlbXBsYXRlVXJsOiAnL2FuZ3VsYXIvdXNlci9wYXJ0aWFscy9qb2luLmh0bWwnLFxyXG5cdFx0XHRjb250cm9sbGVyOiAnSm9pbkNvbnRyb2xsZXInLFxyXG5cdFx0XHRjb250cm9sbGVyQXM6ICdqb2luQ3RybCdcclxuXHRcdH0pO1xyXG5cdFx0XHJcblx0XHQkc3RhdGVQcm92aWRlci5zdGF0ZSgncm9vdC5wcm9maWxlJywge1xyXG5cdFx0XHR1cmw6ICcvcHJvZmlsZScsXHJcblx0XHRcdHRlbXBsYXRlVXJsOiAnL2FuZ3VsYXIvdXNlci9wYXJ0aWFscy9wcm9maWxlLmh0bWwnLFxyXG5cdFx0XHRjb250cm9sbGVyOiAnUHJvZmlsZUNvbnRyb2xsZXInLFxyXG5cdFx0XHRjb250cm9sbGVyQXM6ICdwcm9maWxlQ3RybCdcclxuXHRcdH0pO1xyXG5cdH1dKTtcclxufSkoKTsiLCIoZnVuY3Rpb24oKXtcclxuXHRhbmd1bGFyLm1vZHVsZSgndXNlcicpLmZhY3RvcnkoJ0F1dGhTZXJ2aWNlJywgZnVuY3Rpb24gKCRodHRwLCBTZXNzaW9uKSB7XHJcblx0XHR2YXIgYXV0aFNlcnZpY2UgPSB7fTtcclxuXHRcdHZhciB1c2VyID0ge307XHJcblxyXG5cdFx0YXV0aFNlcnZpY2UubG9naW4gPSBmdW5jdGlvbihjcmVkZW50aWFscykge1xyXG5cdFx0XHRyZXR1cm4gJGh0dHBcclxuXHRcdFx0LnBvc3QoJy9hdXRoL2xvY2FsJywgY3JlZGVudGlhbHMpXHJcblx0XHRcdC50aGVuKGZ1bmN0aW9uIChyZXMpIHtcclxuXHRcdFx0XHRTZXNzaW9uLmNyZWF0ZShyZXMuZGF0YSk7XHJcblx0XHRcdFx0cmV0dXJuIHJlcy5kYXRhO1xyXG5cdFx0XHR9KTtcclxuXHRcdH07XHJcblxyXG5cdFx0YXV0aFNlcnZpY2Uuc2lnbnVwID0gZnVuY3Rpb24obmV3VXNlcil7XHJcblx0XHRcdHJldHVybiAkaHR0cFxyXG5cdFx0XHQucG9zdCgnL2FwaS91c2VyL2pvaW4nLCBuZXdVc2VyKVxyXG5cdFx0XHQudGhlbihcclxuXHRcdFx0ZnVuY3Rpb24gU3VjY2VzcyhyZXMpe1xyXG5cdFx0XHRcdGNvbnNvbGUubG9nKHJlcy5kYXRhKTtcclxuXHRcdFx0XHRTZXNzaW9uLmNyZWF0ZShyZXMuZGF0YSk7XHJcblx0XHRcdFx0cmV0dXJuIHJlcy5kYXRhO1xyXG5cdFx0XHR9LCBmdW5jdGlvbiBGYWlsdXJlKHJlcyl7XHJcblx0XHRcdFx0cmV0dXJuIHJlcy5kYXRhO1xyXG5cdFx0XHR9KTtcclxuXHRcdH07XHJcblxyXG5cdFx0YXV0aFNlcnZpY2UuaXNBdXRoZW50aWNhdGVkID0gZnVuY3Rpb24oKSB7XHJcblx0XHRcdHJldHVybiBTZXNzaW9uLmxpdmUoKTtcclxuXHRcdH07XHJcblxyXG5cdFx0cmV0dXJuIGF1dGhTZXJ2aWNlO1xyXG5cdH0pO1xyXG5cclxuXHRhbmd1bGFyLm1vZHVsZSgndXNlcicpLnNlcnZpY2UoJ1Nlc3Npb24nLCBmdW5jdGlvbiAoJHJvb3RTY29wZSkge1xyXG5cdFx0dmFyIHJvb3QgPSB0aGlzO1xyXG5cdFx0dGhpcy51c2VyID0ge307XHJcblxyXG5cdFx0dGhpcy5saXZlID0gZnVuY3Rpb24oKXtcclxuXHRcdFx0cmV0dXJuIChPYmplY3Qua2V5cyhyb290LnVzZXIpLmxlbmd0aCA+IDApO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuc2V0Q3VycmVudFVzZXIgPSBmdW5jdGlvbih1c2VyKXtcclxuXHRcdFx0JHJvb3RTY29wZS5jdXJyZW50VXNlciA9IHVzZXI7XHJcblx0XHRcdHJvb3QudXNlciA9IHVzZXI7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5jcmVhdGUgPSBmdW5jdGlvbih1c2VyKXtcclxuXHRcdFx0JHJvb3RTY29wZS5jdXJyZW50VXNlciA9IHVzZXI7XHJcblx0XHRcdHJvb3QudXNlciA9IHVzZXI7XHJcblx0XHR9O1xyXG5cclxuXHRcdHRoaXMuZGVzdHJveSA9IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0JHJvb3RTY29wZS5jdXJyZW50VXNlciA9IG51bGw7XHJcblx0XHRcdHJvb3QudXNlciA9IG51bGw7XHJcblx0XHR9O1xyXG5cdH0pO1xyXG5cclxuXHRhbmd1bGFyLm1vZHVsZSgndXNlcicpLmZhY3RvcnkoJ0F1dGhSZXNvbHZlcicsIGZ1bmN0aW9uKCRxLCAkcm9vdFNjb3BlLCAkc3RhdGUpIHtcclxuXHRcdHZhciBiSXNSZXNvbHZlZCA9IGZhbHNlO1xyXG5cclxuXHRcdHJldHVybiB7XHJcblx0XHRcdHJlc29sdmU6IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0XHR2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xyXG5cdFx0XHRcdHZhciB1bndhdGNoID0gJHJvb3RTY29wZS4kd2F0Y2goJ2N1cnJlbnRVc2VyJywgZnVuY3Rpb24gKGN1cnJlbnRVc2VyKSB7XHJcblx0XHRcdFx0XHRpZiAoYW5ndWxhci5pc0RlZmluZWQoY3VycmVudFVzZXIpKSB7XHJcblx0XHRcdFx0XHRcdGlmIChjdXJyZW50VXNlcikge1xyXG5cdFx0XHRcdFx0XHRcdGRlZmVycmVkLnJlc29sdmUoY3VycmVudFVzZXIpO1xyXG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xyXG5cdFx0XHRcdFx0XHRcdGRlZmVycmVkLnJlamVjdCgpO1xyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdGJJc1Jlc29sdmVkID0gdHJ1ZTtcclxuXHRcdFx0XHRcdFx0dW53YXRjaCgpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH0pO1xyXG5cdFx0XHRcdHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xyXG5cdFx0XHR9LFxyXG5cclxuXHRcdFx0YklzUmVzb2x2ZWQ6IGZ1bmN0aW9uKCl7XHJcblx0XHRcdFx0cmV0dXJuIGJJc1Jlc29sdmVkO1xyXG5cdFx0XHR9XHJcblx0XHR9O1xyXG5cdH0pO1xyXG59KSgpOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
