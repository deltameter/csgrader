!function(){angular.module("general",[])}(),function(){angular.module("user",[]).run(["$http","Session",function($http,Session){$http.get("/api/profile").success(function(res){Session.create(res)}).error(function(res){Session.setCurrentUser({})})}])}(),function(){var app=angular.module("grader",["ui.router","general","user"]);app.config(["$locationProvider",function($locationProvider){$locationProvider.html5Mode(!0)}]),app.run(["$rootScope","AuthService","AuthResolver",function($rootScope,AuthService,AuthResolver){$rootScope.$on("$stateChangeStart",function(event,next){AuthResolver.bIsResolved()?(console.log("stateChangeStart resolved"),console.log("auth: "+AuthService.isAuthenticated())):AuthResolver.resolve().then(function(data){console.log("stateChangeStart not resolved"),console.log("auth: "+AuthService.isAuthenticated())})})}])}(),function(){angular.module("general").controller("NavController",["$http","AuthService",function($http,AuthService){this.bLoggedIn=AuthService.isAuthenticated()}])}(),function(){angular.module("general").config(["$stateProvider",function($stateProvider){$stateProvider.state("root",{"abstract":!0,template:"<ui-view/>",resolve:{auth:["AuthResolver",function(AuthResolver){return AuthResolver.bIsResolved()===!0||AuthResolver.resolve()}]}}).state("root.main",{url:"/",template:"<ui-view/>",controller:["$state","AuthService",function($state,AuthService){AuthService.isAuthenticated()?$state.go("root.dashboard"):$state.go("root.main.public")}]}).state("root.main.public",{templateUrl:"/angular/general/partials/index.general.html"})}])}(),function(){angular.module("user").controller("LoginController",["$state","$rootScope","AuthService",function($state,$rootScope,AuthService){var root=this;this.authMessage="",this.user={username:"",password:""},this.login=function(){AuthService.login(root.user).then(function(res){$state.go("root.profile")},function(res){root.authMessage=res.data.userMessage})}}]),angular.module("user").controller("DashboardController",["$state","Session",function($state,Session){this.user=Session.user}]),angular.module("user").controller("ProfileController",["$state","Session",function($state,Session){this.user=Session.user}])}(),function(){angular.module("user").config(["$stateProvider",function($stateProvider){$stateProvider.state("root.auth",{url:"/auth",templateUrl:"/angular/user/partials/auth.user.html",controller:"LoginController",controllerAs:"loginCtrl"}),$stateProvider.state("root.dashboard",{templateUrl:"/angular/user/partials/dashboard.html",controller:"DashboardController",controllerAs:"dashboardCtrl"}),$stateProvider.state("root.profile",{url:"/profile",templateUrl:"/angular/user/partials/profile.user.html",controller:"ProfileController",controllerAs:"profileCtrl"})}])}(),function(){angular.module("user").factory("AuthService",["$http","Session",function($http,Session){var authService={};return authService.login=function(credentials){return $http.post("/auth/local",credentials).then(function(res){return Session.create(res.data),res.data})},authService.isAuthenticated=function(){return Session.live()},authService}]),angular.module("user").service("Session",["$rootScope",function($rootScope){var root=this;this.user={},this.live=function(){return Object.keys(root.user).length>0},this.setCurrentUser=function(user){$rootScope.currentUser=user},this.create=function(user){$rootScope.currentUser=user,root.user=user},this.destroy=function(){$rootScope.currentUser=null,root.user=null}}]),angular.module("user").factory("AuthResolver",["$q","$rootScope","$state",function($q,$rootScope,$state){var bIsResolved=!1;return{resolve:function(){var deferred=$q.defer(),unwatch=$rootScope.$watch("currentUser",function(currentUser){angular.isDefined(currentUser)&&(currentUser?deferred.resolve(currentUser):deferred.reject(),bIsResolved=!0,unwatch())});return deferred.promise},bIsResolved:function(){return bIsResolved}}}])}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdlbmVyYWwvZ2VuZXJhbC5tb2R1bGUuanMiLCJ1c2VyL3VzZXIubW9kdWxlLmpzIiwiY29yZS5qcyIsImdlbmVyYWwvZ2VuZXJhbC5jdHJsLmpzIiwiZ2VuZXJhbC9nZW5lcmFsLnJvdXRlcy5qcyIsInVzZXIvdXNlci5jdHJsLmpzIiwidXNlci91c2VyLnJvdXRlcy5qcyIsInVzZXIvdXNlci5zdmMuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsInJ1biIsIiRodHRwIiwiU2Vzc2lvbiIsImdldCIsInN1Y2Nlc3MiLCJyZXMiLCJjcmVhdGUiLCJlcnJvciIsInNldEN1cnJlbnRVc2VyIiwiYXBwIiwiY29uZmlnIiwiJGxvY2F0aW9uUHJvdmlkZXIiLCJodG1sNU1vZGUiLCIkcm9vdFNjb3BlIiwiQXV0aFNlcnZpY2UiLCJBdXRoUmVzb2x2ZXIiLCIkb24iLCJldmVudCIsIm5leHQiLCJiSXNSZXNvbHZlZCIsImNvbnNvbGUiLCJsb2ciLCJpc0F1dGhlbnRpY2F0ZWQiLCJyZXNvbHZlIiwidGhlbiIsImRhdGEiLCJjb250cm9sbGVyIiwidGhpcyIsImJMb2dnZWRJbiIsIiRzdGF0ZVByb3ZpZGVyIiwic3RhdGUiLCJhYnN0cmFjdCIsInRlbXBsYXRlIiwiYXV0aCIsInVybCIsIiRzdGF0ZSIsImdvIiwidGVtcGxhdGVVcmwiLCJyb290IiwiYXV0aE1lc3NhZ2UiLCJ1c2VyIiwidXNlcm5hbWUiLCJwYXNzd29yZCIsImxvZ2luIiwidXNlck1lc3NhZ2UiLCJjb250cm9sbGVyQXMiLCJmYWN0b3J5IiwiYXV0aFNlcnZpY2UiLCJjcmVkZW50aWFscyIsInBvc3QiLCJsaXZlIiwic2VydmljZSIsIk9iamVjdCIsImtleXMiLCJsZW5ndGgiLCJjdXJyZW50VXNlciIsImRlc3Ryb3kiLCIkcSIsImRlZmVycmVkIiwiZGVmZXIiLCJ1bndhdGNoIiwiJHdhdGNoIiwiaXNEZWZpbmVkIiwicmVqZWN0IiwicHJvbWlzZSJdLCJtYXBwaW5ncyI6IkNBQUEs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QW9ELFFBQUEsV0FBQSxhQUFBLFNBQUF0QyxZQUNBLEdBQUF5QixNQUFBWCxJQUNBQSxNQUFBYSxRQUVBYixLQUFBdUIsS0FBQSxXQUNBLE1BQUFFLFFBQUFDLEtBQUFmLEtBQUFFLE1BQUFjLE9BQUEsR0FHQTNCLEtBQUFuQixlQUFBLFNBQUFnQyxNQUNBM0IsV0FBQTBDLFlBQUFmLE1BR0FiLEtBQUFyQixPQUFBLFNBQUFrQyxNQUNBM0IsV0FBQTBDLFlBQUFmLEtBQ0FGLEtBQUFFLEtBQUFBLE1BRUFiLEtBQUE2QixRQUFBLFdBQ0EzQyxXQUFBMEMsWUFBQSxLQUNBakIsS0FBQUUsS0FBQSxTQUlBMUMsUUFBQUMsT0FBQSxRQUFBK0MsUUFBQSxnQkFBQSxLQUFBLGFBQUEsU0FBQSxTQUFBVyxHQUFBNUMsV0FBQXNCLFFBQ0EsR0FBQWhCLGNBQUEsQ0FFQSxRQUNBSSxRQUFBLFdBQ0EsR0FBQW1DLFVBQUFELEdBQUFFLFFBQ0FDLFFBQUEvQyxXQUFBZ0QsT0FBQSxjQUFBLFNBQUFOLGFBQ0F6RCxRQUFBZ0UsVUFBQVAsZUFDQUEsWUFDQUcsU0FBQW5DLFFBQUFnQyxhQUVBRyxTQUFBSyxTQUVBNUMsYUFBQSxFQUNBeUMsWUFHQSxPQUFBRixVQUFBTSxTQUdBN0MsWUFBQSxXQUNBLE1BQUFBIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXtcclxuXHR2YXIgYXBwID0gYW5ndWxhci5tb2R1bGUoJ2dlbmVyYWwnLCBbXSk7XHJcbn0pKCk7IiwiKGZ1bmN0aW9uKCl7XHJcblx0dmFyIGFwcCA9IGFuZ3VsYXIubW9kdWxlKCd1c2VyJywgW10pXHJcblx0LnJ1bihmdW5jdGlvbigkaHR0cCwgU2Vzc2lvbil7XHJcblx0XHQkaHR0cC5nZXQoJy9hcGkvcHJvZmlsZScpXHJcblx0XHQuc3VjY2VzcyhmdW5jdGlvbihyZXMpe1xyXG5cdFx0XHRTZXNzaW9uLmNyZWF0ZShyZXMpO1xyXG5cdFx0fSlcclxuXHRcdC5lcnJvcihmdW5jdGlvbihyZXMpe1xyXG5cdFx0XHRTZXNzaW9uLnNldEN1cnJlbnRVc2VyKHt9KTtcclxuXHRcdH0pO1xyXG5cdH0pO1xyXG59KSgpOyIsIihmdW5jdGlvbigpe1xyXG5cdHZhciBhcHAgPSBhbmd1bGFyLm1vZHVsZSgnZ3JhZGVyJywgXHJcblx0XHRbXHJcblx0XHRcdCd1aS5yb3V0ZXInLFxyXG5cdFx0XHQnZ2VuZXJhbCcsXHJcblx0XHRcdCd1c2VyJ1xyXG5cdFx0XSk7XHJcblxyXG5cdC8vcmVtb3ZlIHRoZSBoYXNoXHJcblx0YXBwLmNvbmZpZyhbJyRsb2NhdGlvblByb3ZpZGVyJywgZnVuY3Rpb24oJGxvY2F0aW9uUHJvdmlkZXIpe1xyXG5cdFx0JGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xyXG5cdH1dKTtcclxuXHRcclxuXHRhcHAucnVuKGZ1bmN0aW9uICgkcm9vdFNjb3BlLCBBdXRoU2VydmljZSwgQXV0aFJlc29sdmVyKSB7XHJcbiAgXHRcdCRyb290U2NvcGUuJG9uKCckc3RhdGVDaGFuZ2VTdGFydCcsIGZ1bmN0aW9uIChldmVudCwgbmV4dCkge1xyXG4gIFx0XHRcdGlmIChBdXRoUmVzb2x2ZXIuYklzUmVzb2x2ZWQoKSl7XHJcbiAgXHRcdFx0XHRjb25zb2xlLmxvZygnc3RhdGVDaGFuZ2VTdGFydCByZXNvbHZlZCcpO1xyXG4gIFx0XHRcdFx0Y29uc29sZS5sb2coJ2F1dGg6ICcgKyBBdXRoU2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKSk7XHJcbiAgXHRcdFx0fWVsc2V7XHJcbiAgXHRcdFx0XHRBdXRoUmVzb2x2ZXIucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24oZGF0YSl7XHJcbiAgXHRcdFx0XHRcdGNvbnNvbGUubG9nKCdzdGF0ZUNoYW5nZVN0YXJ0IG5vdCByZXNvbHZlZCcpO1xyXG4gIFx0XHRcdFx0XHRjb25zb2xlLmxvZygnYXV0aDogJyArIEF1dGhTZXJ2aWNlLmlzQXV0aGVudGljYXRlZCgpKTtcclxuICBcdFx0XHRcdH0pXHJcbiAgXHRcdFx0fVxyXG4gIFx0XHR9KTtcclxuXHR9KVxyXG5cclxufSkoKTsiLCIoZnVuY3Rpb24oKXtcclxuXHRhbmd1bGFyLm1vZHVsZSgnZ2VuZXJhbCcpLmNvbnRyb2xsZXIoJ05hdkNvbnRyb2xsZXInLCBmdW5jdGlvbigkaHR0cCwgQXV0aFNlcnZpY2Upe1xyXG5cdFx0dmFyIHJvb3QgPSB0aGlzO1xyXG5cdFx0dGhpcy5iTG9nZ2VkSW4gPSBBdXRoU2VydmljZS5pc0F1dGhlbnRpY2F0ZWQoKTtcclxuXHR9KTtcclxufSkoKTsiLCIoZnVuY3Rpb24oKXtcclxuXHRhbmd1bGFyLm1vZHVsZSgnZ2VuZXJhbCcpLmNvbmZpZyhmdW5jdGlvbigkc3RhdGVQcm92aWRlcil7XHJcblxyXG5cdFx0JHN0YXRlUHJvdmlkZXJcclxuXHRcdC5zdGF0ZSgncm9vdCcsIHtcclxuXHRcdFx0YWJzdHJhY3Q6IHRydWUsXHJcblx0XHRcdHRlbXBsYXRlOiAnPHVpLXZpZXcvPicsXHJcblx0XHRcdHJlc29sdmU6IHtcclxuXHRcdFx0XHRhdXRoOiBmdW5jdGlvbiByZXNvbHZlQXV0aGVudGljYXRpb24oQXV0aFJlc29sdmVyKSB7IFxyXG5cdFx0XHRcdFx0cmV0dXJuIChBdXRoUmVzb2x2ZXIuYklzUmVzb2x2ZWQoKSA9PT0gdHJ1ZSB8fCBBdXRoUmVzb2x2ZXIucmVzb2x2ZSgpKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0pXHJcblxyXG5cdFx0LnN0YXRlKCdyb290Lm1haW4nLCB7XHJcblx0XHRcdHVybDogJy8nLFxyXG5cdFx0XHR0ZW1wbGF0ZTogJzx1aS12aWV3Lz4nLFxyXG5cdFx0XHRjb250cm9sbGVyOiBmdW5jdGlvbigkc3RhdGUsIEF1dGhTZXJ2aWNlKXtcclxuXHRcdFx0XHRpZiAoQXV0aFNlcnZpY2UuaXNBdXRoZW50aWNhdGVkKCkpe1xyXG5cdFx0XHRcdFx0JHN0YXRlLmdvKCdyb290LmRhc2hib2FyZCcpO1xyXG5cdFx0XHRcdH1lbHNle1xyXG5cdFx0XHRcdFx0JHN0YXRlLmdvKCdyb290Lm1haW4ucHVibGljJyk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9KVxyXG5cclxuXHRcdC5zdGF0ZSgncm9vdC5tYWluLnB1YmxpYycsIHtcclxuXHRcdFx0dGVtcGxhdGVVcmw6ICcvYW5ndWxhci9nZW5lcmFsL3BhcnRpYWxzL2luZGV4LmdlbmVyYWwuaHRtbCdcclxuXHRcdH0pO1xyXG5cclxuXHR9KTtcclxufSkoKTsiLCIoZnVuY3Rpb24oKXtcclxuXHJcblx0YW5ndWxhci5tb2R1bGUoJ3VzZXInKS5jb250cm9sbGVyKCdMb2dpbkNvbnRyb2xsZXInLCBmdW5jdGlvbigkc3RhdGUsICRyb290U2NvcGUsIEF1dGhTZXJ2aWNlKXtcclxuXHRcdHZhciByb290ID0gdGhpcztcclxuXHRcdHRoaXMuYXV0aE1lc3NhZ2UgPSAnJztcclxuXHRcdHRoaXMudXNlciA9IHtcclxuXHRcdFx0dXNlcm5hbWU6ICcnLFxyXG5cdFx0XHRwYXNzd29yZDogJydcclxuXHRcdH07XHJcblxyXG5cdFx0dGhpcy5sb2dpbiA9IGZ1bmN0aW9uKCkge1xyXG5cdFx0XHRBdXRoU2VydmljZS5sb2dpbihyb290LnVzZXIpLnRoZW4oXHJcblx0XHRcdFx0ZnVuY3Rpb24ocmVzKXtcclxuXHRcdFx0XHRcdCRzdGF0ZS5nbygncm9vdC5wcm9maWxlJyk7XHJcblx0XHRcdFx0fSxcclxuXHRcdFx0XHRmdW5jdGlvbihyZXMpe1xyXG5cdFx0XHRcdFx0cm9vdC5hdXRoTWVzc2FnZSA9IHJlcy5kYXRhLnVzZXJNZXNzYWdlO1xyXG5cdFx0XHRcdH0pO1xyXG5cdFx0fTtcclxuXHR9KTtcclxuXHRcclxuXHRhbmd1bGFyLm1vZHVsZSgndXNlcicpLmNvbnRyb2xsZXIoJ0Rhc2hib2FyZENvbnRyb2xsZXInLCBmdW5jdGlvbigkc3RhdGUsIFNlc3Npb24pe1xyXG5cdFx0dGhpcy51c2VyID0gU2Vzc2lvbi51c2VyO1xyXG5cdH0pO1xyXG5cclxuXHRhbmd1bGFyLm1vZHVsZSgndXNlcicpLmNvbnRyb2xsZXIoJ1Byb2ZpbGVDb250cm9sbGVyJywgZnVuY3Rpb24oJHN0YXRlLCBTZXNzaW9uKXtcclxuXHRcdHRoaXMudXNlciA9IFNlc3Npb24udXNlcjtcclxuXHR9KTtcclxufSkoKTsiLCIoZnVuY3Rpb24oKXtcclxuXHRhbmd1bGFyLm1vZHVsZSgndXNlcicpLmNvbmZpZyhbJyRzdGF0ZVByb3ZpZGVyJywgZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIpe1xyXG5cdFx0JHN0YXRlUHJvdmlkZXIuc3RhdGUoJ3Jvb3QuYXV0aCcsIHtcclxuXHRcdFx0dXJsOiAnL2F1dGgnLFxyXG5cdFx0XHR0ZW1wbGF0ZVVybDogJy9hbmd1bGFyL3VzZXIvcGFydGlhbHMvYXV0aC51c2VyLmh0bWwnLFxyXG5cdFx0XHRjb250cm9sbGVyOiAnTG9naW5Db250cm9sbGVyJyxcclxuXHRcdFx0Y29udHJvbGxlckFzOiAnbG9naW5DdHJsJ1xyXG5cdFx0fSk7XHJcblxyXG5cdFx0JHN0YXRlUHJvdmlkZXIuc3RhdGUoJ3Jvb3QuZGFzaGJvYXJkJywge1xyXG5cdFx0XHR0ZW1wbGF0ZVVybDogJy9hbmd1bGFyL3VzZXIvcGFydGlhbHMvZGFzaGJvYXJkLmh0bWwnLFxyXG5cdFx0XHRjb250cm9sbGVyOiAnRGFzaGJvYXJkQ29udHJvbGxlcicsXHJcblx0XHRcdGNvbnRyb2xsZXJBczogJ2Rhc2hib2FyZEN0cmwnXHJcblx0XHR9KTtcclxuXHJcblx0XHQkc3RhdGVQcm92aWRlci5zdGF0ZSgncm9vdC5wcm9maWxlJywge1xyXG5cdFx0XHR1cmw6ICcvcHJvZmlsZScsXHJcblx0XHRcdHRlbXBsYXRlVXJsOiAnL2FuZ3VsYXIvdXNlci9wYXJ0aWFscy9wcm9maWxlLnVzZXIuaHRtbCcsXHJcblx0XHRcdGNvbnRyb2xsZXI6ICdQcm9maWxlQ29udHJvbGxlcicsXHJcblx0XHRcdGNvbnRyb2xsZXJBczogJ3Byb2ZpbGVDdHJsJ1xyXG5cdFx0fSk7XHJcblx0fV0pO1xyXG59KSgpOyIsIihmdW5jdGlvbigpe1xyXG5cdGFuZ3VsYXIubW9kdWxlKCd1c2VyJykuZmFjdG9yeSgnQXV0aFNlcnZpY2UnLCBmdW5jdGlvbiAoJGh0dHAsIFNlc3Npb24pIHtcclxuXHRcdHZhciBhdXRoU2VydmljZSA9IHt9O1xyXG5cclxuXHRcdGF1dGhTZXJ2aWNlLmxvZ2luID0gZnVuY3Rpb24gKGNyZWRlbnRpYWxzKSB7XHJcblx0XHRcdHJldHVybiAkaHR0cFxyXG5cdFx0XHQucG9zdCgnL2F1dGgvbG9jYWwnLCBjcmVkZW50aWFscylcclxuXHRcdFx0LnRoZW4oZnVuY3Rpb24gKHJlcykge1xyXG5cdFx0XHRcdFNlc3Npb24uY3JlYXRlKHJlcy5kYXRhKTtcclxuXHRcdFx0XHRyZXR1cm4gcmVzLmRhdGE7XHJcblx0XHRcdH0pO1xyXG5cdFx0fTtcclxuXHJcblx0XHRhdXRoU2VydmljZS5pc0F1dGhlbnRpY2F0ZWQgPSBmdW5jdGlvbiAoKSB7XHJcblx0XHRcdHJldHVybiBTZXNzaW9uLmxpdmUoKTtcclxuXHRcdH07XHJcblxyXG5cdFx0cmV0dXJuIGF1dGhTZXJ2aWNlO1xyXG5cdH0pO1xyXG5cclxuXHRhbmd1bGFyLm1vZHVsZSgndXNlcicpLnNlcnZpY2UoJ1Nlc3Npb24nLCBmdW5jdGlvbiAoJHJvb3RTY29wZSkge1xyXG5cdFx0dmFyIHJvb3QgPSB0aGlzO1xyXG5cdFx0dGhpcy51c2VyID0ge307XHJcblxyXG5cdFx0dGhpcy5saXZlID0gZnVuY3Rpb24oKXtcclxuXHRcdFx0cmV0dXJuIChPYmplY3Qua2V5cyhyb290LnVzZXIpLmxlbmd0aCA+IDApO1xyXG5cdFx0fVxyXG5cclxuXHRcdHRoaXMuc2V0Q3VycmVudFVzZXIgPSBmdW5jdGlvbih1c2VyKXtcclxuXHRcdFx0JHJvb3RTY29wZS5jdXJyZW50VXNlciA9IHVzZXI7XHJcblx0XHR9XHJcblxyXG5cdFx0dGhpcy5jcmVhdGUgPSBmdW5jdGlvbih1c2VyKXtcclxuXHRcdFx0JHJvb3RTY29wZS5jdXJyZW50VXNlciA9IHVzZXI7XHJcblx0XHRcdHJvb3QudXNlciA9IHVzZXI7XHJcblx0XHR9O1xyXG5cdFx0dGhpcy5kZXN0cm95ID0gZnVuY3Rpb24gKCkge1xyXG5cdFx0XHQkcm9vdFNjb3BlLmN1cnJlbnRVc2VyID0gbnVsbDtcclxuXHRcdFx0cm9vdC51c2VyID0gbnVsbDtcclxuXHRcdH07XHJcblx0fSk7XHJcblxyXG5cdGFuZ3VsYXIubW9kdWxlKCd1c2VyJykuZmFjdG9yeSgnQXV0aFJlc29sdmVyJywgZnVuY3Rpb24oJHEsICRyb290U2NvcGUsICRzdGF0ZSkge1xyXG5cdFx0dmFyIGJJc1Jlc29sdmVkID0gZmFsc2U7XHJcblxyXG5cdFx0cmV0dXJuIHtcclxuXHRcdFx0cmVzb2x2ZTogZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRcdHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XHJcblx0XHRcdFx0dmFyIHVud2F0Y2ggPSAkcm9vdFNjb3BlLiR3YXRjaCgnY3VycmVudFVzZXInLCBmdW5jdGlvbiAoY3VycmVudFVzZXIpIHtcclxuXHRcdFx0XHRcdGlmIChhbmd1bGFyLmlzRGVmaW5lZChjdXJyZW50VXNlcikpIHtcclxuXHRcdFx0XHRcdFx0aWYgKGN1cnJlbnRVc2VyKSB7XHJcblx0XHRcdFx0XHRcdFx0ZGVmZXJyZWQucmVzb2x2ZShjdXJyZW50VXNlcik7XHJcblx0XHRcdFx0XHRcdH0gZWxzZSB7XHJcblx0XHRcdFx0XHRcdFx0ZGVmZXJyZWQucmVqZWN0KCk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0YklzUmVzb2x2ZWQgPSB0cnVlO1xyXG5cdFx0XHRcdFx0XHR1bndhdGNoKCk7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdFx0cmV0dXJuIGRlZmVycmVkLnByb21pc2U7XHJcblx0XHRcdH0sXHJcblxyXG5cdFx0XHRiSXNSZXNvbHZlZDogZnVuY3Rpb24oKXtcclxuXHRcdFx0XHRyZXR1cm4gYklzUmVzb2x2ZWQ7XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblx0fSk7XHJcbn0pKCk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
