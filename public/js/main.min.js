!function(e,n){"use strict";var r=["ng","oc.lazyLoad"],o={},t=[],i=[],a=[],s=[],u=e.noop,c={},l=[],d=e.module("oc.lazyLoad",["ng"]);d.provider("$ocLazyLoad",["$controllerProvider","$provide","$compileProvider","$filterProvider","$injector","$animateProvider",function(d,f,p,m,v,y){function L(n,o,t){if(o){var i,s,d,f=[];for(i=o.length-1;i>=0;i--)if(s=o[i],e.isString(s)||(s=E(s)),s&&-1===l.indexOf(s)&&(!w[s]||-1!==a.indexOf(s))){var h=-1===r.indexOf(s);if(d=g(s),h&&(r.push(s),L(n,d.requires,t)),d._runBlocks.length>0)for(c[s]=[];d._runBlocks.length>0;)c[s].push(d._runBlocks.shift());e.isDefined(c[s])&&(h||t.rerun)&&(f=f.concat(c[s])),j(n,d._invokeQueue,s,t.reconfig),j(n,d._configBlocks,s,t.reconfig),u(h?"ocLazyLoad.moduleLoaded":"ocLazyLoad.moduleReloaded",s),o.pop(),l.push(s)}var p=n.getInstanceInjector();e.forEach(f,function(e){p.invoke(e)})}}function $(n,r){function t(n,r){var o,t=!0;return r.length&&(o=i(n),e.forEach(r,function(e){t=t&&i(e)!==o})),t}function i(n){return e.isArray(n)?M(n.toString()):e.isObject(n)?M(S(n)):e.isDefined(n)&&null!==n?M(n.toString()):n}var a=n[2][0],s=n[1],c=!1;e.isUndefined(o[r])&&(o[r]={}),e.isUndefined(o[r][s])&&(o[r][s]={});var l=function(e,n){o[r][s].hasOwnProperty(e)||(o[r][s][e]=[]),t(n,o[r][s][e])&&(c=!0,o[r][s][e].push(n),u("ocLazyLoad.componentLoaded",[r,s,e]))};if(e.isString(a))l(a,n[2][1]);else{if(!e.isObject(a))return!1;e.forEach(a,function(n,r){e.isString(n)?l(n,a[1]):l(r,n)})}return c}function j(n,r,o,i){if(r){var a,s,u,c;for(a=0,s=r.length;s>a;a++)if(u=r[a],e.isArray(u)){if(null!==n){if(!n.hasOwnProperty(u[0]))throw new Error("unsupported provider "+u[0]);c=n[u[0]]}var l=$(u,o);if("invoke"!==u[1])l&&e.isDefined(c)&&c[u[1]].apply(c,u[2]);else{var d=function(n){var r=t.indexOf(o+"-"+n);(-1===r||i)&&(-1===r&&t.push(o+"-"+n),e.isDefined(c)&&c[u[1]].apply(c,u[2]))};if(e.isFunction(u[2][0]))d(u[2][0]);else if(e.isArray(u[2][0]))for(var f=0,h=u[2][0].length;h>f;f++)e.isFunction(u[2][0][f])&&d(u[2][0][f])}}}}function E(n){var r=null;return e.isString(n)?r=n:e.isObject(n)&&n.hasOwnProperty("name")&&e.isString(n.name)&&(r=n.name),r}function _(n){if(!e.isString(n))return!1;try{return g(n)}catch(r){if(/No module/.test(r)||r.message.indexOf("$injector:nomod")>-1)return!1}}var w={},O={$controllerProvider:d,$compileProvider:p,$filterProvider:m,$provide:f,$injector:v,$animateProvider:y},x=!1,b=!1,z=[],D={};z.push=function(e){-1===this.indexOf(e)&&Array.prototype.push.apply(this,arguments)},this.config=function(n){e.isDefined(n.modules)&&(e.isArray(n.modules)?e.forEach(n.modules,function(e){w[e.name]=e}):w[n.modules.name]=n.modules),e.isDefined(n.debug)&&(x=n.debug),e.isDefined(n.events)&&(b=n.events)},this._init=function(o){if(0===i.length){var t=[o],a=["ng:app","ng-app","x-ng-app","data-ng-app"],u=/\sng[:\-]app(:\s*([\w\d_]+);?)?\s/,c=function(e){return e&&t.push(e)};e.forEach(a,function(n){a[n]=!0,c(document.getElementById(n)),n=n.replace(":","\\:"),"undefined"!=typeof o[0]&&o[0].querySelectorAll&&(e.forEach(o[0].querySelectorAll("."+n),c),e.forEach(o[0].querySelectorAll("."+n+"\\:"),c),e.forEach(o[0].querySelectorAll("["+n+"]"),c))}),e.forEach(t,function(n){if(0===i.length){var r=" "+o.className+" ",t=u.exec(r);t?i.push((t[2]||"").replace(/\s+/g,",")):e.forEach(n.attributes,function(e){0===i.length&&a[e.name]&&i.push(e.value)})}})}0!==i.length||(n.jasmine||n.mocha)&&e.isDefined(e.mock)||console.error("No module found during bootstrap, unable to init ocLazyLoad. You should always use the ng-app directive or angular.boostrap when you use ocLazyLoad.");var l=function d(n){if(-1===r.indexOf(n)){r.push(n);var o=e.module(n);j(null,o._invokeQueue,n),j(null,o._configBlocks,n),e.forEach(o.requires,d)}};e.forEach(i,function(e){l(e)}),i=[],s.pop()};var S=function(n){try{return JSON.stringify(n)}catch(r){var o=[];return JSON.stringify(n,function(n,r){if(e.isObject(r)&&null!==r){if(-1!==o.indexOf(r))return;o.push(r)}return r})}},M=function(e){var n,r,o,t=0;if(0==e.length)return t;for(n=0,o=e.length;o>n;n++)r=e.charCodeAt(n),t=(t<<5)-t+r,t|=0;return t};this.$get=["$log","$rootElement","$rootScope","$cacheFactory","$q",function(n,t,a,c,d){function f(e){var r=d.defer();return n.error(e.message),r.reject(e),r.promise}var p,m=c("ocLazyLoad");return x||(n={},n.error=e.noop,n.warn=e.noop,n.info=e.noop),O.getInstanceInjector=function(){return p?p:p=t.data("$injector")||e.injector()},u=function(e,r){b&&a.$broadcast(e,r),x&&n.info(e,r)},{_broadcast:u,_$log:n,_getFilesCache:function(){return m},toggleWatch:function(e){e?s.push(!0):s.pop()},getModuleConfig:function(n){if(!e.isString(n))throw new Error("You need to give the name of the module to get");return w[n]?e.copy(w[n]):null},setModuleConfig:function(n){if(!e.isObject(n))throw new Error("You need to give the module config object to set");return w[n.name]=n,n},getModules:function(){return r},isLoaded:function(n){var o=function(e){var n=r.indexOf(e)>-1;return n||(n=!!_(e)),n};if(e.isString(n)&&(n=[n]),e.isArray(n)){var t,i;for(t=0,i=n.length;i>t;t++)if(!o(n[t]))return!1;return!0}throw new Error("You need to define the module(s) name(s)")},_getModuleName:E,_getModule:function(e){try{return g(e)}catch(n){throw(/No module/.test(n)||n.message.indexOf("$injector:nomod")>-1)&&(n.message='The module "'+S(e)+'" that you are trying to load does not exist. '+n.message),n}},moduleExists:_,_loadDependencies:function(n,r){var o,t,i,a=[],s=this;if(n=s._getModuleName(n),null===n)return d.when();try{o=s._getModule(n)}catch(u){return f(u)}return t=s.getRequires(o),e.forEach(t,function(o){if(e.isString(o)){var t=s.getModuleConfig(o);if(null===t)return void z.push(o);o=t,t.name=void 0}if(s.moduleExists(o.name))return i=o.files.filter(function(e){return s.getModuleConfig(o.name).files.indexOf(e)<0}),0!==i.length&&s._$log.warn('Module "',n,'" attempted to redefine configuration for dependency. "',o.name,'"\n Additional Files Loaded:',i),e.isDefined(s.filesLoader)?void a.push(s.filesLoader(o,r).then(function(){return s._loadDependencies(o)})):f(new Error("Error: New dependencies need to be loaded from external files ("+o.files+"), but no loader has been defined."));if(e.isArray(o)){var u=[];e.forEach(o,function(e){var n=s.getModuleConfig(e);null===n?u.push(e):n.files&&(u=u.concat(n.files))}),u.length>0&&(o={files:u})}else e.isObject(o)&&o.hasOwnProperty("name")&&o.name&&(s.setModuleConfig(o),z.push(o.name));if(e.isDefined(o.files)&&0!==o.files.length){if(!e.isDefined(s.filesLoader))return f(new Error('Error: the module "'+o.name+'" is defined in external files ('+o.files+"), but no loader has been defined."));a.push(s.filesLoader(o,r).then(function(){return s._loadDependencies(o)}))}}),d.all(a)},inject:function(n){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],o=arguments.length<=2||void 0===arguments[2]?!1:arguments[2],t=this,a=d.defer();if(e.isDefined(n)&&null!==n){if(e.isArray(n)){var s=[];return e.forEach(n,function(e){s.push(t.inject(e,r,o))}),d.all(s)}t._addToLoadList(t._getModuleName(n),!0,o)}if(i.length>0){var u=i.slice(),c=function f(e){z.push(e),D[e]=a.promise,t._loadDependencies(e,r).then(function(){try{l=[],L(O,z,r)}catch(e){return t._$log.error(e.message),void a.reject(e)}i.length>0?f(i.shift()):a.resolve(u)},function(e){a.reject(e)})};c(i.shift())}else{if(r&&r.name&&D[r.name])return D[r.name];a.resolve()}return a.promise},getRequires:function(n){var o=[];return e.forEach(n.requires,function(e){-1===r.indexOf(e)&&o.push(e)}),o},_invokeQueue:j,_registerInvokeList:$,_register:L,_addToLoadList:h,_unregister:function(n){e.isDefined(n)&&e.isArray(n)&&e.forEach(n,function(e){o[e]=void 0})}}}],this._init(e.element(n.document))}]);var f=e.bootstrap;e.bootstrap=function(n,r,o){return e.forEach(r.slice(),function(e){h(e,!0,!0)}),f(n,r,o)};var h=function(n,r,o){(s.length>0||r)&&e.isString(n)&&-1===i.indexOf(n)&&(i.push(n),o&&a.push(n))},g=e.module;e.module=function(e,n,r){return h(e,!1,!0),g(e,n,r)},"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="oc.lazyLoad")}(angular,window),function(e){"use strict";e.module("oc.lazyLoad").directive("ocLazyLoad",["$ocLazyLoad","$compile","$animate","$parse","$timeout",function(n,r,o,t,i){return{restrict:"A",terminal:!0,priority:1e3,compile:function(i,a){var s=i[0].innerHTML;return i.html(""),function(i,a,u){var c=t(u.ocLazyLoad);i.$watch(function(){return c(i)||u.ocLazyLoad},function(t){e.isDefined(t)&&n.load(t).then(function(){o.enter(s,a),r(a.contents())(i)})},!0)}}}}])}(angular),function(e){"use strict";e.module("oc.lazyLoad").config(["$provide",function(n){n.decorator("$ocLazyLoad",["$delegate","$q","$window","$interval",function(n,r,o,t){var i=!1,a=!1,s=o.document.getElementsByTagName("head")[0]||o.document.getElementsByTagName("body")[0];return n.buildElement=function(u,c,l){var d,f,h=r.defer(),g=n._getFilesCache(),p=function(e){var n=(new Date).getTime();return e.indexOf("?")>=0?"&"===e.substring(0,e.length-1)?e+"_dc="+n:e+"&_dc="+n:e+"?_dc="+n};switch(e.isUndefined(g.get(c))&&g.put(c,h.promise),u){case"css":d=o.document.createElement("link"),d.type="text/css",d.rel="stylesheet",d.href=l.cache===!1?p(c):c;break;case"js":d=o.document.createElement("script"),d.src=l.cache===!1?p(c):c;break;default:g.remove(c),h.reject(new Error('Requested type "'+u+'" is not known. Could not inject "'+c+'"'))}d.onload=d.onreadystatechange=function(e){d.readyState&&!/^c|loade/.test(d.readyState)||f||(d.onload=d.onreadystatechange=null,f=1,n._broadcast("ocLazyLoad.fileLoaded",c),h.resolve())},d.onerror=function(){g.remove(c),h.reject(new Error("Unable to load "+c))},d.async=l.serie?0:1;var m=s.lastChild;if(l.insertBefore){var v=e.element(e.isDefined(window.jQuery)?l.insertBefore:document.querySelector(l.insertBefore));v&&v.length>0&&(m=v[0])}if(m.parentNode.insertBefore(d,m),"css"==u){if(!i){var y=o.navigator.userAgent.toLowerCase();if(/iP(hone|od|ad)/.test(o.navigator.platform)){var L=o.navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),$=parseFloat([parseInt(L[1],10),parseInt(L[2],10),parseInt(L[3]||0,10)].join("."));a=6>$}else if(y.indexOf("android")>-1){var j=parseFloat(y.slice(y.indexOf("android")+8));a=4.4>j}else if(y.indexOf("safari")>-1){var E=y.match(/version\/([\.\d]+)/i);a=E&&E[1]&&parseFloat(E[1])<6}}if(a)var _=1e3,w=t(function(){try{d.sheet.cssRules,t.cancel(w),d.onload()}catch(e){--_<=0&&d.onerror()}},20)}return h.promise},n}])}])}(angular),function(e){"use strict";e.module("oc.lazyLoad").config(["$provide",function(n){n.decorator("$ocLazyLoad",["$delegate","$q",function(n,r){return n.filesLoader=function(o){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=[],a=[],s=[],u=[],c=null,l=n._getFilesCache();n.toggleWatch(!0),e.extend(t,o);var d=function(r){var o,d=null;if(e.isObject(r)&&(d=r.type,r=r.path),c=l.get(r),e.isUndefined(c)||t.cache===!1){if(null!==(o=/^(css|less|html|htm|js)?(?=!)/.exec(r))&&(d=o[1],r=r.substr(o[1].length+1,r.length)),!d)if(null!==(o=/[.](css|less|html|htm|js)?((\?|#).*)?$/.exec(r)))d=o[1];else{if(n.jsLoader.hasOwnProperty("ocLazyLoadLoader")||!n.jsLoader.hasOwnProperty("requirejs"))return void n._$log.error("File type could not be determined. "+r);d="js"}"css"!==d&&"less"!==d||-1!==i.indexOf(r)?"html"!==d&&"htm"!==d||-1!==a.indexOf(r)?"js"===d||-1===s.indexOf(r)?s.push(r):n._$log.error("File type is not valid. "+r):a.push(r):i.push(r)}else c&&u.push(c)};if(t.serie?d(t.files.shift()):e.forEach(t.files,function(e){d(e)}),i.length>0){var f=r.defer();n.cssLoader(i,function(r){e.isDefined(r)&&n.cssLoader.hasOwnProperty("ocLazyLoadLoader")?(n._$log.error(r),f.reject(r)):f.resolve()},t),u.push(f.promise)}if(a.length>0){var h=r.defer();n.templatesLoader(a,function(r){e.isDefined(r)&&n.templatesLoader.hasOwnProperty("ocLazyLoadLoader")?(n._$log.error(r),h.reject(r)):h.resolve()},t),u.push(h.promise)}if(s.length>0){var g=r.defer();n.jsLoader(s,function(r){e.isDefined(r)&&(n.jsLoader.hasOwnProperty("ocLazyLoadLoader")||n.jsLoader.hasOwnProperty("requirejs"))?(n._$log.error(r),g.reject(r)):g.resolve()},t),u.push(g.promise)}if(0===u.length){var p=r.defer(),m="Error: no file to load has been found, if you're trying to load an existing module you should use the 'inject' method instead of 'load'.";return n._$log.error(m),p.reject(m),p.promise}return t.serie&&t.files.length>0?r.all(u).then(function(){return n.filesLoader(o,t)}):r.all(u)["finally"](function(e){return n.toggleWatch(!1),e})},n.load=function(o){var t,i=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],a=this,s=null,u=[],c=r.defer(),l=e.copy(o),d=e.copy(i);if(e.isArray(l))return e.forEach(l,function(e){u.push(a.load(e,d))}),r.all(u).then(function(e){c.resolve(e)},function(e){c.reject(e)}),c.promise;if(e.isString(l)?(s=a.getModuleConfig(l),s||(s={files:[l]})):e.isObject(l)&&(s=e.isDefined(l.path)&&e.isDefined(l.type)?{files:[l]}:a.setModuleConfig(l)),null===s){var f=a._getModuleName(l);return t='Module "'+(f||"unknown")+'" is not configured, cannot load.',n._$log.error(t),c.reject(new Error(t)),c.promise}e.isDefined(s.template)&&(e.isUndefined(s.files)&&(s.files=[]),e.isString(s.template)?s.files.push(s.template):e.isArray(s.template)&&s.files.concat(s.template));var h=e.extend({},d,s);return e.isUndefined(s.files)&&e.isDefined(s.name)&&n.moduleExists(s.name)?n.inject(s.name,h,!0):(n.filesLoader(s,h).then(function(){n.inject(null,h).then(function(e){c.resolve(e)},function(e){c.reject(e)})},function(e){c.reject(e)}),c.promise)},n}])}])}(angular),function(e){"use strict";e.module("oc.lazyLoad").config(["$provide",function(n){n.decorator("$ocLazyLoad",["$delegate","$q",function(n,r){return n.cssLoader=function(o,t,i){var a=[];e.forEach(o,function(e){a.push(n.buildElement("css",e,i))}),r.all(a).then(function(){t()},function(e){t(e)})},n.cssLoader.ocLazyLoadLoader=!0,n}])}])}(angular),function(e){"use strict";e.module("oc.lazyLoad").config(["$provide",function(n){n.decorator("$ocLazyLoad",["$delegate","$q",function(n,r){return n.jsLoader=function(o,t,i){var a=[];e.forEach(o,function(e){a.push(n.buildElement("js",e,i))}),r.all(a).then(function(){t()},function(e){t(e)})},n.jsLoader.ocLazyLoadLoader=!0,n}])}])}(angular),function(e){"use strict";e.module("oc.lazyLoad").config(["$provide",function(n){n.decorator("$ocLazyLoad",["$delegate","$templateCache","$q","$http",function(n,r,o,t){return n.templatesLoader=function(i,a,s){var u=[],c=n._getFilesCache();return e.forEach(i,function(n){var i=o.defer();u.push(i.promise),t.get(n,s).success(function(o){e.isString(o)&&o.length>0&&e.forEach(e.element(o),function(e){"SCRIPT"===e.nodeName&&"text/ng-template"===e.type&&r.put(e.id,e.innerHTML)}),e.isUndefined(c.get(n))&&c.put(n,!0),i.resolve()}).error(function(e){i.reject(new Error('Unable to load template file "'+n+'": '+e))})}),o.all(u).then(function(){a()},function(e){a(e)})},n.templatesLoader.ocLazyLoadLoader=!0,n}])}])}(angular),Array.prototype.indexOf||(Array.prototype.indexOf=function(e,n){var r;if(null==this)throw new TypeError('"this" is null or not defined');var o=Object(this),t=o.length>>>0;if(0===t)return-1;var i=+n||0;if(Math.abs(i)===1/0&&(i=0),i>=t)return-1;for(r=Math.max(i>=0?i:t-Math.abs(i),0);t>r;){if(r in o&&o[r]===e)return r;r++}return-1}),!function(e){function n(r){if(t[r])return t[r].exports;var o=t[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}var t={};return n.m=e,n.c=t,n.p="",n(0)}([function(e,n){"use strict";!function(){var e=angular.module("angularModalService",[]);e.factory("ModalService",["$animate","$document","$compile","$controller","$http","$rootScope","$q","$templateRequest","$timeout",function(e,n,t,r,o,l,c,u,a){function i(){var o=this,i=function(e,n){var t=c.defer();return e?t.resolve(e):n?u(n,!0).then(function(e){t.resolve(e)},function(e){t.reject(e)}):t.reject("No template or templateUrl has been specified."),t.promise},s=function(n,t){var r=n.children();return r.length>0?e.enter(t,n,r[r.length-1]):e.enter(t,n)};o.showModal=function(o){var u=angular.element(n[0].body),p=c.defer(),d=o.controller;return d?(i(o.template,o.templateUrl).then(function(n){function i(n){m.resolve(n),e.leave(g).then(function(){v.resolve(n),d.$destroy(),$.close=null,p=null,m=null,S=null,$=null,g=null,d=null}),f&&f()}var d=(o.scope||l).$new(),f=l.$on("$locationChangeSuccess",i),m=c.defer(),v=c.defer(),$={$scope:d,close:function(e,n){void 0!==n&&null!==n||(n=0),a(function(){i(e)},n)}};o.inputs&&angular.extend($,o.inputs);var h=t(n),g=h(d);$.$element=g;var x=d[o.controllerAs],j=r(o.controller,$,!1,o.controllerAs);o.controllerAs&&x&&angular.extend(j,x),o.appendElement?s(o.appendElement,g):s(u,g);var S={controller:j,scope:d,element:g,close:m.promise,closed:v.promise};p.resolve(S)}).then(null,function(e){p.reject(e)}),p.promise):(p.reject("No controller has been specified."),p.promise)}}return new i}])}()}]),function(){angular.module("assignments",[])}(),function(){angular.module("classrooms",[])}(),function(){angular.module("courses",[])}(),function(){angular.module("general",[])}(),function(){var app=angular.module("misc",[]);app.filter("trustAsHTML",["$sce",function($sce){return $sce.trustAsHtml}])}(),function(){angular.module("submissions",[])}(),function(){angular.module("user",[]).run(["$http","AuthService",function($http,AuthService){AuthService.retrieveProfile()}])}(),function(){var app=angular.module("grader",["oc.lazyLoad","ui.router","angularModalService","general","courses","classrooms","user","assignments","submissions","misc"]);app.config(["$locationProvider",function($locationProvider){$locationProvider.html5Mode(!0)}]),app.run(["$rootScope","$state","AuthService","AuthResolver",function($rootScope,$state,AuthService,AuthResolver){$rootScope.$on("$stateChangeStart",function(event,next){var ensureAuth=function(event,bIsLoggedIn){bIsLoggedIn||"undefined"!=typeof next.data&&next.data.bIsPublic===!0||(event.preventDefault(),$state.go("root.login"))};AuthResolver.bIsResolved()?ensureAuth(event,AuthService.isAuthenticated()):AuthResolver.resolve().then(function(data){ensureAuth(event,AuthService.isAuthenticated())})})}]),app.factory("Config",function(){return{graderTestFile:"Main"}})}(),function(){"use strict";function choosePanelClass(classes,role,bIsFinished,bIsCorrect,bIsAttempted){return bIsFinished&&"teacher"===role?classes.success:bIsCorrect&&"student"===role?classes.success:bIsAttempted&&"student"===role?classes.warning:classes.normal}function scrollToElement(element,offset){var el=angular.element(element)[0],top=0;do top+=el.offsetTop||0,el=el.offsetParent;while(el);window.scrollTo(0,top-offset)}angular.module("assignments").controller("AssignmentsController",["$scope","$stateParams","$state","ModalService","AssignmentFactory",function($scope,$stateParams,$state,ModalService,AssignmentFactory){var vm=this;vm.courseCode=$stateParams.courseCode,vm.searchAssignments=[],vm.assignmentsShownLength=5,vm.listPage=0,vm.maxListPage=0,vm.currentListAssignments=[],vm.listAssignments=[],vm.currentFindType="search",$scope.range=function(num){for(var arr=[],i=0;num>i;i++)arr.push(i);return arr},this.showAssignmentCreationModal=function(){ModalService.showModal({templateUrl:"/partials/assignments/createAssignmentModal.html",controller:"mCreateAssignmentController",controllerAs:"createAssignmentCtrl"}).then(function(modal){modal.element.modal(),modal.close.then(function(assignment){if(assignment){const params={courseCode:vm.courseCode,assignmentID:assignment.assignmentID};console.log(params),$state.go("root.assignment",params)}})})},this.search=function(){vm.searchAssignments=[],AssignmentFactory.search(vm.courseCode,vm.searchTerms).then(function(assignments){vm.currentFindType="search",vm.searchAssignments=assignments})},this.getAll=function(){AssignmentFactory.getAll(vm.courseCode).then(function(assignments){vm.currentFindType="all",vm.listAssignments=assignments,vm.listPage=0,vm.currentListAssignments=assignments.slice(0,vm.assignmentsShownLength),vm.maxListPage=Math.floor(assignments.length/vm.assignmentsShownLength)})},this.changePageNum=function(bIncreasingPage){bIncreasingPage&&vm.listPage!==vm.maxListPage?vm.listPage++:bIncreasingPage||0===vm.listPage||vm.listPage--;var pageIndex=vm.listPage*vm.assignmentsShownLength;vm.currentListAssignments=vm.listAssignments.slice(pageIndex,pageIndex+vm.assignmentsShownLength)}}]).controller("mCreateAssignmentController",["$stateParams","$element","close","AssignmentFactory",function($stateParams,$element,close,AssignmentFactory){var vm=this;$element.on("hidden.bs.modal",function(){return vm.closed?void 0:close(null,500)}),this.create=function(){AssignmentFactory.createAssignment($stateParams.courseCode,vm.newAssignment).then(function(assignment){"undefined"!=typeof assignment.userMessages?vm.userMessages=assignment.userMessages:($element.modal("hide"),vm.closed=!0,close(assignment,500))})}}]).controller("AssignmentController",["$scope","$stateParams","$ocLazyLoad","ModalService","UserInfo","AssignmentFactory","QuestionFactory","ExerciseFactory",function($scope,$stateParams,$ocLazyLoad,ModalService,UserInfo,AssignmentFactory,QuestionFactory,ExerciseFactory){var vm=this;vm.user=UserInfo.getUser(),vm.courseCode=$stateParams.courseCode,vm.assignmentID=$stateParams.assignmentID,vm.assignment={},vm.openInfo={deadlineType:"select"};var init=function(){AssignmentFactory.getAssignment(vm.courseCode,vm.assignmentID).then(function(assignment){vm.assignment=assignment})};$scope.$on("POINTS_EARNED",function(event,points){vm.assignment.pointsEarned+=points}),this.getProgressBarWidth=function(){return(100*vm.assignment.pointsEarned/vm.assignment.pointsWorth).toString()+"%"},this.hasContent=function(){return Object.keys(vm.assignment).length>0&&(vm.assignment.exercises.length>0||vm.assignment.questions.length>0)},this.showOpenModal=function(){$ocLazyLoad.load(["/stylesheets/datepicker.min.css","/js/vendor/moment/moment.js","/js/vendor/angular-datepicker/dist/angular-datepicker.min.js"]).then(function(){ModalService.showModal({templateUrl:"/partials/assignments/openAssignmentModal.html",controller:"mOpenAssignmentController",controllerAs:"openAssignmentCtrl"}).then(function(modal){modal.element.modal(),modal.close.then(function(result){result&&(vm.assignment.bIsOpen=!0,vm.assignment.pointsWorth=AssignmentFactory.calculateTotalPoints(vm.assignment),vm.assignment.dueDate=result.dueDate,vm.assignment.deadlineType=result.deadlineType,vm.assignment.pointLoss=result.pointLoss)})})})},this.showCloseModal=function(){ModalService.showModal({templateUrl:"/partials/assignments/closeAssignmentModal.html",controller:"mCloseAssignmentController",controllerAs:"closeAssignmentCtrl"}).then(function(modal){modal.element.modal(),modal.close.then(function(result){result&&(vm.assignment.bIsOpen=!1)})})},this.addQuestion=function(){QuestionFactory.addQuestion(vm.courseCode,vm.assignmentID).then(function(newQuestion){newQuestion.questionIndex=vm.assignment.questions.length,vm.assignment.content.push(newQuestion),vm.assignment.questions.push(newQuestion)})},this.deleteQuestion=function(contentOrderIndex,questionIndex,questionID){QuestionFactory.deleteQuestion(vm.courseCode,vm.assignmentID,questionID).then(function(){vm.assignment.content.splice(contentOrderIndex,1),vm.assignment.questions.splice(questionIndex,1),$scope.$broadcast("QUESTION_DELETE",questionIndex)})},this.addExercise=function(){ExerciseFactory.addExercise(vm.courseCode,vm.assignmentID).then(function(newExercise){newExercise.exerciseIndex=vm.assignment.exercises.length,vm.assignment.content.push(newExercise),vm.assignment.exercises.push(newExercise)})},this.deleteExercise=function(contentOrderIndex,exerciseIndex,exerciseID){ExerciseFactory.deleteExercise(vm.courseCode,vm.assignmentID,exerciseID).then(function(){vm.assignment.content.splice(contentOrderIndex,1),vm.assignment.exercises.splice(exerciseIndex,1),$scope.$broadcast("EXERCISE_DELETE",exerciseIndex)})},init()}]).controller("mOpenAssignmentController",["$scope","$stateParams","$compile","$element","close","AssignmentFactory",function($scope,$stateParams,$compile,$element,close,AssignmentFactory){var vm=this;$element.on("hidden.bs.modal",function(){return vm.closed?void 0:close(null,500)}),this.openAssignment=function(){AssignmentFactory.openAssignment($stateParams.courseCode,$stateParams.assignmentID,vm.openInfo).then(function(data){"undefined"!=typeof data.userMessages?vm.userMessages=data.userMessages:($element.modal("hide"),vm.closed=!0,close(vm.openInfo,500))})}}]).controller("mCloseAssignmentController",["$scope","$stateParams","$element","close","AssignmentFactory",function($scope,$stateParams,$element,close,AssignmentFactory){var vm=this;$element.on("hidden.bs.modal",function(){return vm.closed?void 0:close(null,500)}),this.close=function(){AssignmentFactory.closeAssignment($stateParams.courseCode,$stateParams.assignmentID,vm.password).then(function(data){"undefined"!=typeof data.userMessages?vm.userMessages=data.userMessages:($element.modal("hide"),vm.closed=!0,close(!0,500))})}}]).controller("QuestionController",["$state","$scope","$stateParams","$timeout","$element","UserInfo","QuestionFactory",function($state,$scope,$stateParams,$timeout,$element,UserInfo,QuestionFactory){var vm=this;vm.state=$state,vm.courseCode=$stateParams.courseCode,vm.assignmentID=$stateParams.assignmentID,vm.question=$scope.$parent.content;const panelClasses={panel:{success:"panel-success",warning:"panel-warning",normal:"panel-default"},button:{success:"btn-default",warning:"btn-default",normal:"btn-info"}};this.getPanelClass=function(type){const bIsCorrect=vm.question.bIsCorrect||"frq"===vm.question.questionType&&vm.question.tries>0;return choosePanelClass(panelClasses[type],UserInfo.getUser().role,vm.question.bIsFinished,bIsCorrect,vm.question.tries>0)},this.submitQuestion=function(){var submitTime=Date.now();vm.bBackendComputing=!0,QuestionFactory.submitQuestion(vm.courseCode,vm.assignmentID,vm.question._id,vm.question.studentAnswer).then(function(res){vm.question.tries++,res.data.bIsCorrect&&(vm.question.bIsCorrect=!0,("frq"!=vm.question.questionType||vm.question.bIsHomework)&&(vm.question.pointsEarned=vm.question.pointsWorth,$scope.$emit("POINTS_EARNED",vm.question.pointsEarned))),$timeout(function(){vm.bBackendComputing=!1},Math.max(50,300+submitTime-Date.now()))})},$scope.$watch("bShowNormal",function(bShowNormal,old){bShowNormal&&!old&&$timeout(function(){scrollToElement($element,70)},50)}),this.toggleEdit=function(){$scope.$parent.bIsEditing=!0;var scopeParent=$scope.$parent;$timeout(function(){scopeParent.bShowEdit=!0,scopeParent.bIsNormal=!1,scopeParent.bShowNormal=!1},250)}}]).controller("QuestionEditController",["$scope","$stateParams","$timeout","$element","QuestionFactory",function($scope,$stateParams,$timeout,$element,QuestionFactory){var vm=this;vm.courseCode=$stateParams.courseCode,vm.assignmentID=$stateParams.assignmentID,vm.question=$scope.$parent.content,vm.questionSnapshot=JSON.parse(JSON.stringify(vm.question)),$scope.tinymceOptions={inline:!1,plugins:"autolink link image code",toolbar:"undo redo | bold italic | alignleft aligncenter alignright | image link code",skin:"lightgray",theme:"modern"},$scope.$on("QUESTION_DELETE",function(event,questionIndex){vm.question.questionIndex>questionIndex&&vm.question.questionIndex--}),this.addAnswer=function(){vm.question.answers.push("")},this.deleteAnswer=function(index){vm.question.answers.splice(index,1)},$scope.$watch("bShowEdit",function(bShowEdit,old){bShowEdit&&!old&&$timeout(function(){scrollToElement($element,70)},50)});var toggleEdit=function(){$scope.$parent.bIsNormal=!0;var scopeParent=$scope.$parent;$timeout(function(){scopeParent.bIsEditing=!1,scopeParent.bShowEdit=!1,scopeParent.bShowNormal=!0},250)};this.editQuestion=function(){angular.equals(vm.question,vm.questionSnapshot)?toggleEdit():QuestionFactory.editQuestion(vm.courseCode,vm.assignmentID,vm.question).then(function(res){vm.question.bIsFinished=res.data.bIsFinished,toggleEdit()})}}]).controller("ExerciseBaseController",["$scope","$stateParams","Config","UserInfo","ExerciseFactory",function($scope,$stateParams,Config,UserInfo,ExerciseFactory){var vm=this;vm.courseCode=$stateParams.courseCode,vm.assignmentID=$stateParams.assignmentID,vm.exercise=$scope.$parent.content,vm.editing=!1,vm.compilationInfo={},vm.focusFileType="tests",vm.focusedFileIndex=0,vm.aceOptions={onLoad:function(aceEditor){aceEditor.$blockScrolling=1/0,vm.aceEditor=aceEditor}},$scope.$on("EXERCISE_DELETE",function(event,exerciseIndex){vm.exercise.exerciseIndex>exerciseIndex&&vm.exercise.exerciseIndex--}),this.resetExercise=function(){this.compilationInfo={}},this.swapFocusFileType=function(){this.focusFileType="tests"===this.focusFileType?"code":"tests",this.focusedFileIndex=0},this.focusFile=function(index){this.focusedFileIndex=index},this.addFile=function(){if("undefined"!=typeof this.newFileName&&0!==this.newFileName.length){var newFile=ExerciseFactory.createNewFile(this.newFileName,this.exercise);newFile!==!1&&(this.exercise[this.focusFileType].push(newFile),this.newFileName="")}},this.deleteFile=function(index){this.exercise[this.focusFileType].splice(index,1)}}]).controller("ExerciseController",["$state","$scope","$controller","$timeout","UserInfo","$element","ExerciseFactory",function($state,$scope,$controller,$timeout,UserInfo,$element,ExerciseFactory){var vm=this;vm.state=$state,angular.extend(vm,$controller("ExerciseBaseController",{$scope:$scope})),"teacher"===UserInfo.getUser().role?vm.focusFileType="solutionCode":vm.focusFileType="code";const panelClasses={panel:{success:"panel-success",warning:"panel-warning",normal:"panel-default"},button:{success:"btn-default",warning:"btn-default",normal:"btn-info"}};this.getPanelClass=function(type){return choosePanelClass(panelClasses[type],UserInfo.getUser().role,vm.exercise.bIsFinished&&vm.exercise.bIsTested,vm.exercise.bIsCorrect,vm.exercise.tries>0)},this.testExercise=function(){vm.bBackendComputing=!0,ExerciseFactory.testExercise(this.courseCode,vm.assignmentID,vm.exercise._id,vm.exercise.solutionCode).then(function(res){vm.exercise.bIsTested=res.data.bIsCorrect,vm.compilationInfo.testResults=res.data.testResults,vm.compilationInfo.errors=res.data.errors,vm.bBackendComputing=!1})},this.submitExercise=function(){vm.bBackendComputing=!0,ExerciseFactory.submitExercise(vm.courseCode,vm.assignmentID,vm.exercise._id,vm.exercise.code).then(function(res){var compilationResults=res.data;console.log("pointsearned: "+compilationResults.pointsEarned),vm.compilationInfo.testResults=compilationResults.testResults,vm.compilationInfo.errors=compilationResults.errors,vm.exercise.tries++,$scope.$emit("POINTS_EARNED",compilationResults.pointsEarned-vm.exercise.pointsEarned),vm.exercise.pointsEarned=compilationResults.pointsEarned,vm.exercise.bIsCorrect=compilationResults.bIsCorrect,vm.bBackendComputing=!1})},$scope.$watch("bShowNormal",function(bShowNormal,old){bShowNormal&&!old&&$timeout(function(){scrollToElement($element,70)},50)}),this.toggleEdit=function(){$scope.$parent.bIsEditing=!0;var scopeParent=$scope.$parent;$timeout(function(){scopeParent.bShowEdit=!0,scopeParent.bIsNormal=!1,scopeParent.bShowNormal=!1},250)}}]).controller("ExerciseEditController",["$scope","$controller","$timeout","$element","ExerciseFactory",function($scope,$controller,$timeout,$element,ExerciseFactory){var vm=this;angular.extend(vm,$controller("ExerciseBaseController",{$scope:$scope})),vm.exerciseSnapshot=JSON.parse(JSON.stringify(vm.exercise)),$scope.onlyNumbers=/^\d+$/,this.editExercise=function(){angular.equals(vm.exercise,vm.exerciseSnapshot)?vm.toggleEdit():ExerciseFactory.editExercise(vm.courseCode,vm.assignmentID,vm.exercise).then(function(res){vm.exercise.bIsFinished=res.data.bIsFinished,vm.toggleEdit()})},$scope.$watch("bShowEdit",function(bShowEdit,old){bShowEdit&&!old&&$timeout(function(){scrollToElement($element,70)},50)}),this.toggleEdit=function(){$scope.$parent.bIsNormal=!0;var scopeParent=$scope.$parent;$timeout(function(){scopeParent.bIsEditing=!1,scopeParent.bShowEdit=!1,
scopeParent.bShowNormal=!0},250)},this.recalculateTotalPoints=function(){var totalPoints=0;vm.exercise.tests.forEach(function(test){"undefined"!=typeof test.pointsWorth&&"number"==typeof parseInt(test.pointsWorth)&&(totalPoints+=parseInt(test.pointsWorth))}),vm.exercise.pointsWorth=totalPoints}}])}(),function(){"use strict";angular.module("assignments").directive("question",function(){return{restrict:"E",templateUrl:"/partials/assignments/question.html",controller:"QuestionController",controllerAs:"questionCtrl"}}).directive("questionEdit",function(){return{restrict:"E",templateUrl:"/partials/assignments/questionEdit.html",controller:"QuestionEditController",controllerAs:"questionEditCtrl"}}).directive("exercise",function(){return{restrict:"E",templateUrl:"/partials/assignments/exercise.html",controller:"ExerciseController",controllerAs:"exerciseCtrl"}}).directive("exerciseEdit",function(){return{restrict:"E",templateUrl:"/partials/assignments/exerciseEdit.html",controller:"ExerciseEditController",controllerAs:"exerciseEditCtrl"}})}(),function(){"use strict";angular.module("assignments").config(["$stateProvider",function($stateProvider){$stateProvider.state("root.assignments",{url:"/course/:courseCode/assignment",templateUrl:"/partials/assignments/assignments.html",controller:"AssignmentsController",controllerAs:"assignmentsCtrl"}).state("root.assignment",{url:"/course/:courseCode/assignment/:assignmentID",templateUrl:"/partials/assignments/assignment.html",controller:"AssignmentController",controllerAs:"assignmentCtrl"})}])}(),function(){"use strict";function arrayObjectIndexOf(myArray,property,searchTerm){for(var i=0,len=myArray.length;len>i;i++)if(myArray[i][property]===searchTerm)return i;return-1}angular.module("assignments").factory("AssignmentFactory",["$http",function($http){function parseAssignment(assignment,submission){if(assignment.content=new Array(assignment.questions.length+assignment.exercises.length),submission){assignment.pointsEarned=0;for(var i=0;i<assignment.questions.length;i++)"mc"===assignment.questions[i].questionType&&(submission.questionAnswers[i]=parseInt(submission.questionAnswers[i])),assignment.pointsEarned+=submission.questionPoints[i],assignment.questions[i].studentAnswer=submission.questionAnswers[i],assignment.questions[i].tries=submission.questionTries[i],assignment.questions[i].pointsEarned=submission.questionPoints[i],assignment.questions[i].bIsCorrect=submission.questionsCorrect[i];for(var i=0;i<assignment.exercises.length;i++)assignment.pointsEarned+=submission.exercisePoints[i],assignment.exercises[i].code=submission.exerciseAnswers[i],assignment.exercises[i].tries=submission.exerciseTries[i],assignment.exercises[i].pointsEarned=submission.exercisePoints[i],assignment.exercises[i].bIsCorrect=submission.exercisesCorrect[i];for(var i=0;i<submission.teacherComments.length;i++){const comment=submission.teacherComments[i],property=comment.contentType+"s",index=assignment[property].map(function(content){return content._id}).indexOf(comment.contentID);assignment[property][index].teacherCommentText=comment.text}}for(var i=0;i<assignment.contentOrder.length;i++)if(0===assignment.contentOrder[i].indexOf("exercise")){var id=assignment.contentOrder[i].split("exercise")[1],location=arrayObjectIndexOf(assignment.exercises,"_id",id);assignment.content[i]=assignment.exercises[location],assignment.content[i].type="exercise",assignment.content[i].exerciseIndex=location}else if(0===assignment.contentOrder[i].indexOf("question")){var id=assignment.contentOrder[i].split("question")[1],location=arrayObjectIndexOf(assignment.questions,"_id",id);assignment.content[i]=assignment.questions[location],assignment.content[i].type="question",assignment.content[i].questionIndex=location}return assignment}function getAssignment(courseCode,assignmentID){return $http.get("/api/course/"+courseCode+"/assignment/"+assignmentID).then(function(res){return parseAssignment(res.data.assignment,res.data.submission)})}function getAssignmentToGrade(courseCode,assignmentID,submissionID){const submissionRoute="/api/course/"+courseCode+"/assignment/"+assignmentID+"/submission/"+submissionID;return $http.get(submissionRoute).then(function(res){return parseAssignment(res.data.assignment,res.data.submission)})}function getAll(courseCode){return $http.get("/api/course/"+courseCode+"/assignment").then(function(res){return res.data.assignments})}function search(courseCode,searchTerms){var search={searchTerms:searchTerms};return $http.get("/api/course/"+courseCode+"/assignment",{params:search}).then(function(res){return res.data.assignments})}function createAssignment(courseCode,newAssignment){return $http.post("/api/course/"+courseCode+"/assignment/create",newAssignment).then(function(res){return res.data},function(res){return res.data})}function openAssignment(courseCode,assignmentID,openInfo){return $http.put("/api/course/"+courseCode+"/assignment/"+assignmentID+"/open",openInfo).then(function(res){return res.data},function(res){return res.data})}function closeAssignment(courseCode,assignmentID,password){return $http.put("/api/course/"+courseCode+"/assignment/"+assignmentID+"/close",{password:password}).then(function(res){return res.data},function(res){return res.data})}function calculateTotalPoints(assignment){var totalPoints=0;return assignment.exercises.forEach(function(exercise){totalPoints+=exercise.pointsWorth}),assignment.questions.forEach(function(question){totalPoints+=question.pointsWorth}),totalPoints}return{getAssignment:getAssignment,getAssignmentToGrade:getAssignmentToGrade,getAll:getAll,search:search,createAssignment:createAssignment,openAssignment:openAssignment,closeAssignment:closeAssignment,calculateTotalPoints:calculateTotalPoints}}]).factory("QuestionFactory",["$http",function($http){function addQuestion(courseCode,assignmentID){return $http.post("/api/course/"+courseCode+"/assignment/"+assignmentID+"/question/create").then(function(res){var newQuestion=res.data;return newQuestion.type="question",newQuestion})}function editQuestion(courseCode,assignmentID,question){var questionEdit=angular.copy(question);return questionEdit.questionID=question._id,delete questionEdit._id,$http.put("/api/course/"+courseCode+"/assignment/"+assignmentID+"/question/edit",questionEdit)}function deleteQuestion(courseCode,assignmentID,questionID){var requestInfo={url:"/api/course/"+courseCode+"/assignment/"+assignmentID+"/question/delete",method:"DELETE",data:{questionID:questionID},headers:{"Content-Type":"application/json;charset=utf-8"}};return $http(requestInfo)}function submitQuestion(courseCode,assignmentID,questionID,answer){var questionAnswer={answer:answer,questionID:questionID};return $http.put("/api/course/"+courseCode+"/assignment/"+assignmentID+"/question/submit",questionAnswer)}return{addQuestion:addQuestion,editQuestion:editQuestion,deleteQuestion:deleteQuestion,submitQuestion:submitQuestion}}]).factory("ExerciseFactory",["$http",function($http){function addExercise(courseCode,assignmentID){var exercise={title:"My Exercise",language:"Java"};return $http.post("/api/course/"+courseCode+"/assignment/"+assignmentID+"/exercise/create",exercise).then(function(res){var newExercise=res.data;return newExercise.type="exercise",newExercise})}function editExercise(courseCode,assignmentID,exercise){var exerciseEdit={exerciseID:exercise._id,title:exercise.title,context:exercise.context,code:exercise.code,tests:exercise.tests,triesAllowed:exercise.triesAllowed,pointsWorth:exercise.pointsWorth};return $http.put("/api/course/"+courseCode+"/assignment/"+assignmentID+"/exercise/edit",exerciseEdit)}function testExercise(courseCode,assignmentID,exerciseID,code){var exerciseTest={exerciseID:exerciseID,code:code};return $http.post("/api/course/"+courseCode+"/assignment/"+assignmentID+"/exercise/test",exerciseTest)}function submitExercise(courseCode,assignmentID,exerciseID,code){var submission={exerciseID:exerciseID,code:code};return $http.put("/api/course/"+courseCode+"/assignment/"+assignmentID+"/exercise/submit",submission)}function deleteExercise(courseCode,assignmentID,exerciseID){var requestInfo={url:"/api/course/"+courseCode+"/assignment/"+assignmentID+"/exercise/delete",method:"DELETE",data:{exerciseID:exerciseID},headers:{"Content-Type":"application/json;charset=utf-8"}};return $http(requestInfo)}function createNewFile(filename,exercise){"undefined"==typeof filename.split(".")[1]&&(filename+=exercise.language.fileExt);const bDistinctCodeName=-1===exercise.code.map(function(code){return code.name}).indexOf(filename),bDistinctTestName="undefined"==typeof exercise.tests||-1===exercise.tests.map(function(test){return test.name}).indexOf(filename);return bDistinctCodeName&&bDistinctTestName?{name:filename,code:"//"+filename}:!1}function deleteFile(files,filename){for(var index=-1,i=0;i<files.length;i++)if(files[i].name===filename){index=i;break}return files.splice(index,1),index}return{addExercise:addExercise,editExercise:editExercise,testExercise:testExercise,submitExercise:submitExercise,deleteExercise:deleteExercise,createNewFile:createNewFile,deleteFile:deleteFile}}])}(),function(){"use strict";angular.module("classrooms").controller("ClassroomsController",["$stateParams","$state","ModalService","ClassroomFactory",function($stateParams,$state,ModalService,ClassroomFactory){var vm=this;vm.courseCode=$stateParams.courseCode,vm.classrooms=[];var getClassrooms=function(){ClassroomFactory.getClassrooms($stateParams.courseCode).then(function(res){vm.classrooms=res})};this.openCreateClassroomModal=function(){ModalService.showModal({templateUrl:"/partials/classrooms/createClassroomModal.html",controller:"mCreateClassroomController",controllerAs:"createClassroomCtrl"}).then(function(modal){modal.element.modal(),modal.close.then(function(result){console.log(result),result&&$state.go("root.classroom",{courseCode:vm.courseCode,classCode:result.classCode})})})},getClassrooms()}]).controller("mCreateClassroomController",["$stateParams","$element","close","ClassroomFactory",function($stateParams,$element,close,ClassroomFactory){var vm=this;$element.on("hidden.bs.modal",function(){return vm.closed?void 0:close(null,500)}),this.create=function(){ClassroomFactory.createClassroom($stateParams.courseCode,vm.newClassroomName).then(function(data){console.log(data.userMessages),"undefined"!=typeof data.userMessages?vm.userMessages=data.userMessages:($element.modal("hide"),vm.closed=!0,close(data,500))})}}]).controller("ClassroomController",["$stateParams","$state","ModalService","StudentFactory","ClassroomFactory",function($stateParams,$state,ModalService,StudentFactory,ClassroomFactory){var vm=this;vm.courseCode=$stateParams.courseCode,vm.classroom={},vm.newStudent={};var getClassroom=function(){ClassroomFactory.getClassroom($stateParams.courseCode,$stateParams.classCode).then(function(res){vm.classroom=res})};this.createStudent=function(){StudentFactory.createStudent($stateParams.courseCode,$stateParams.classCode,vm.newStudent).then(function(res){vm.classroom.students.push(res),vm.newStudent={}})},this.importStudents=function(){StudentFactory.importStudents($stateParams.courseCode,$stateParams.classCode,vm.importFile).then(function(students){console.log(students),vm.classroom.students=vm.classroom.students.concat(students),vm.importFile=null})},this.editStudent=function(student,form){StudentFactory.editStudent($stateParams.courseCode,$stateParams.classCode,student).then(function(res){form.$setPristine()})},this.deleteStudent=function(studentID){StudentFactory.deleteStudent($stateParams.courseCode,$stateParams.classCode,studentID).then(function(res){for(var i=0;i<vm.classroom.students.length;i++)if(vm.classroom.students[i]._id===studentID){vm.classroom.students.splice(i,1);break}})},this.openDeleteClassroomModal=function(){ModalService.showModal({templateUrl:"/partials/classrooms/deleteClassroomModal.html",controller:"mDeleteClassroomController",controllerAs:"deleteClassroomCtrl"}).then(function(modal){modal.element.modal(),modal.close.then(function(result){result&&$state.go("root.classrooms",{courseCode:vm.courseCode})})})},getClassroom()}]).controller("mDeleteClassroomController",["$stateParams","$element","close","ClassroomFactory",function($stateParams,$element,close,ClassroomFactory){var vm=this;$element.on("hidden.bs.modal",function(){return vm.closed?void 0:close(null,500)}),this["delete"]=function(){ClassroomFactory.deleteClassroom($stateParams.courseCode,$stateParams.classCode,vm.password).then(function(data){"undefined"!=typeof data.userMessages?vm.userMessages=data.userMessages:($element.modal("hide"),vm.closed=!0,close(data,500))})}}])}(),function(){"use strict";angular.module("classrooms").config(["$stateProvider",function($stateProvider){$stateProvider.state("root.classrooms",{url:"/course/:courseCode/classroom",templateUrl:"/partials/classrooms/classrooms.html",controller:"ClassroomsController",controllerAs:"classroomsCtrl"}).state("root.classroom",{url:"/course/:courseCode/classroom/:classCode",templateUrl:"/partials/classrooms/classroom.html",controller:"ClassroomController",controllerAs:"classroomCtrl"})}])}(),function(){"use strict";angular.module("classrooms").factory("ClassroomFactory",["$http",function($http){function createClassroom(courseCode,className){var newClassroom={name:className};return $http.post("/api/course/"+courseCode+"/classroom/create",newClassroom).then(function(res){return res.data})}function getClassroom(courseCode,classCode){return $http.get("/api/course/"+courseCode+"/classroom/"+classCode).then(function(res){return res.data})}function getClassrooms(courseCode){return $http.get("/api/course/"+courseCode+"/classroom").then(function(res){return res.data})}function deleteClassroom(courseCode,classCode,password){var requestInfo={url:"/api/course/"+courseCode+"/classroom/"+classCode,method:"DELETE",data:{password:password},headers:{"Content-Type":"application/json;charset=utf-8"}};return $http(requestInfo).then(function(res){return res.data},function(res){return res.data})}return{createClassroom:createClassroom,getClassroom:getClassroom,getClassrooms:getClassrooms,deleteClassroom:deleteClassroom}}]).factory("StudentFactory",["$http","$injector",function($http,$injector){function createStudent(courseCode,classCode,newStudent){return $http.post("/api/course/"+courseCode+"/classroom/"+classCode+"/student/create",newStudent).then(function(res){return res.data})}function importStudents(courseCode,classCode,file){var Upload=$injector.get("Upload");return file.upload=Upload.upload({url:"/api/course/"+courseCode+"/classroom/"+classCode+"/student/import",data:{students:file}}),file.upload.then(function(res){return res.data})}function editStudent(courseCode,classCode,student){var studentInfo={studentClassID:student._id,firstName:student.firstName,lastName:student.lastName,gradebookID:student.gradebookID};return $http.put("/api/course/"+courseCode+"/classroom/"+classCode+"/student/edit",studentInfo).then(function(res){return res.data})}function deleteStudent(courseCode,classCode,studentID){return $http["delete"]("/api/course/"+courseCode+"/classroom/"+classCode+"/student/delete/"+studentID).then(function(res){return res.data},function(res){console.log(res)})}return{createStudent:createStudent,importStudents:importStudents,editStudent:editStudent,deleteStudent:deleteStudent}}])}(),function(){"use strict";angular.module("user").controller("DashboardController",["$state","ModalService","CourseFactory","UserInfo",function($state,ModalService,CourseFactory,UserInfo){var vm=this;this.newCourse={},this.courses=null,this.user=UserInfo.getUser();var getCourses=function(){CourseFactory.getCourses().then(function(res){vm.courses=res.data})};this.showCourseCreationModal=function(){ModalService.showModal({templateUrl:"/partials/courses/courseCreationModal.html",controller:"mCourseCreationController",controllerAs:"courseCreationCtrl"}).then(function(modal){modal.element.modal(),modal.close.then(function(res){res&&$state.go("root.course",{courseCode:res.courseCode})})})},this.showRegistrationModal=function(){ModalService.showModal({templateUrl:"/partials/courses/registrationModal.html",controller:"mRegistrationController",controllerAs:"registrationCtrl"}).then(function(modal){modal.element.modal(),modal.close.then(function(res){res&&$state.go("root.course",{courseCode:res.courseCode})})})},getCourses()}]).controller("mCourseCreationController",["$element","close","CourseFactory",function($element,close,CourseFactory){var vm=this;$element.on("hidden.bs.modal",function(){return vm.closed?void 0:close(null,500)}),this.create=function(){CourseFactory.createCourse(vm.newCourse).then(function(data){"undefined"!=typeof data.userMessages?vm.userMessages=data.userMessages:($element.modal("hide"),vm.closed=!0,close(vm.newCourse,500))})}}]).controller("mRegistrationController",["$element","close","UserFactory",function($element,close,UserFactory){var vm=this;$element.on("hidden.bs.modal",function(){return vm.closed?void 0:close(null,500)}),this.register=function(){UserFactory.registerForCourse(vm.regInfo).then(function(data){"undefined"!=typeof data.userMessages?vm.userMessages=data.userMessages:($element.modal("hide"),vm.closed=!0,close(data,500))})}}]).controller("CourseController",["$state","$http","$stateParams","ModalService","UserInfo","CourseFactory","AssignmentFactory",function($state,$http,$stateParams,ModalService,UserInfo,CourseFactory,AssignmentFactory){var vm=this;vm.course=null,vm.user=UserInfo.getUser(),vm.newAssignment={};var getCourse=function(){CourseFactory.getCourse($stateParams.courseCode).then(function(res){vm.course=res.data})};this.showDeleteCourseModal=function(){ModalService.showModal({templateUrl:"/partials/courses/deleteCourseModal.html",controller:"mCourseDeletionController",controllerAs:"courseDeletionCtrl"}).then(function(modal){modal.element.modal(),modal.close.then(function(res){res&&$state.go("root.main.dashboard")})})},getCourse()}]).controller("mCourseDeletionController",["$stateParams","$element","close","CourseFactory",function($stateParams,$element,close,CourseFactory){var vm=this;$element.on("hidden.bs.modal",function(){return vm.closed?void 0:close(null,500)}),this["delete"]=function(){CourseFactory.deleteCourse($stateParams.courseCode,vm.password).then(function(data){"undefined"!=typeof data.userMessages?vm.userMessages=data.userMessages:($element.modal("hide"),vm.closed=!0,close(!0,500))})}}])}(),function(){"use strict";angular.module("user").config(["$stateProvider",function($stateProvider){$stateProvider.state("root.main.dashboard",{templateUrl:"/partials/courses/dashboard.html",controller:"DashboardController",controllerAs:"dashboardCtrl"}),$stateProvider.state("root.course",{url:"/course/:courseCode",templateUrl:"/partials/courses/course.html",controller:"CourseController",controllerAs:"courseCtrl"})}])}(),function(){"use strict";angular.module("courses").factory("CourseFactory",["$http",function($http){function getCourse(courseCode){return $http.get("/api/course/"+courseCode)}function getCourses(){return $http.get("/api/course")}function createCourse(newCourse){return $http.post("/api/course/create",newCourse).then(function(res){return res.data},function(res){return res.data})}function deleteCourse(courseCode,password){var requestInfo={url:"/api/course/"+courseCode,method:"DELETE",data:{password:password},headers:{"Content-Type":"application/json;charset=utf-8"}};return $http(requestInfo).then(function(res){return res.data},function(res){return res.data})}return{getCourse:getCourse,getCourses:getCourses,createCourse:createCourse,deleteCourse:deleteCourse}}])}(),function(){"use strict";angular.module("general").controller("NavController",["$rootScope","$scope","$http","AuthService","AuthResolver","$state",function($rootScope,$scope,$http,AuthService,AuthResolver,$state){var vm=this;vm.$state=$state,vm.bLoggedIn=null;var checkAuth=function(){AuthResolver.bIsResolved()?vm.bLoggedIn=AuthService.isAuthenticated():AuthResolver.resolve().then(function(){vm.bLoggedIn=AuthService.isAuthenticated()})};$rootScope.$watch("currentUser",function(){checkAuth()}),checkAuth()}])}(),function(){"use strict";angular.module("general").directive("navbar",function(){return{restrict:"E",templateUrl:"/partials/general/navbar.html",controller:"NavController",controllerAs:"navCtrl"}})}(),function(){"use strict";angular.module("general").config(["$stateProvider",function($stateProvider){$stateProvider.state("root",{"abstract":!0,template:"<div ui-view></div>",resolve:{auth:["AuthResolver",function(AuthResolver){return AuthResolver.bIsResolved()===!0||AuthResolver.resolve()}]}}).state("root.main",{url:"/",template:"<div ui-view></div>",data:{bIsPublic:!0},controller:["$state","AuthService",function($state,AuthService){AuthService.isAuthenticated()?$state.go("root.main.dashboard"):$state.go("root.main.public")}]}).state("root.main.public",{templateUrl:"/partials/general/index.html",data:{bIsPublic:!0},controller:function(){console.log("Hit public index")}})}])}(),function(){"use strict";function clickOutside($document,$parse,$timeout){return{restrict:"A",link:function($scope,elem,attr){console.log("hi"),$timeout(function(){function eventHandler(e){if(!angular.element(elem).hasClass("ng-hide")){var element,i=0;if(e&&e.target){for(element=e.target;element;element=element.parentNode){var id=element.id,classNames=element.className,l=classList.length;for(classNames&&void 0!==classNames.baseVal&&(classNames=classNames.baseVal),i=0;l>i;i++)if(void 0!==id&&id===classList[i]||classNames&&classNames===classList[i])return}return $scope.$apply(function(){return(fn=$parse(attr.clickOutside))($scope)})}}}function _hasTouch(){return"ontouchstart"in window||navigator.maxTouchPoints}var fn,classList=void 0!==attr.outsideIfNot?attr.outsideIfNot.replace(", ",",").split(","):[];void 0!==attr.id&&classList.push(attr.id),_hasTouch()&&$document.on("touchstart",eventHandler),$document.on("click",eventHandler),$scope.$on("$destroy",function(){_hasTouch()&&$document.off("touchstart",eventHandler),$document.off("click",eventHandler)})})}}}clickOutside.$inject=["$document","$parse","$timeout"],angular.module("misc").directive("clickOutside",clickOutside)}(),function(){"use strict";function doubleClick($document){return{restrict:"A",scope:{doubleClick:"&"},link:function($scope,elem,attr){var classes=attr.doubleClickClass.split(" "),warningClass=classes[0],dangerClass=classes[1],bIsTargeted=!1;elem.addClass(warningClass);var checkClick=function(event){var clickedOnThis=elem[0].contains(event.target),leftClicked=0==event.button;clickedOnThis&&leftClicked?(bIsTargeted&&($scope.doubleClick(),$scope.$apply()),bIsTargeted=!0,elem.removeClass(bIsTargeted?warningClass:dangerClass),elem.addClass(bIsTargeted?dangerClass:warningClass)):bIsTargeted&&(elem.removeClass(dangerClass),elem.addClass(warningClass),bIsTargeted=!1)};$document.on("click",checkClick),$scope.$on("$destroy",function(){$document.off("click",checkClick)})}}}doubleClick.$inject=["$document"],angular.module("misc").directive("doubleClick",doubleClick)}(),function(){"use strict";angular.module("submissions").controller("SubmissionsController",["$stateParams","SubmissionsFactory",function($stateParams,SubmissionsFactory){var vm=this;vm.courseCode=$stateParams.courseCode,vm.assignmentID=$stateParams.assignmentID;var init=function(){SubmissionsFactory.setParams(vm.courseCode,$stateParams.assignmentID),SubmissionsFactory.getClassesWithProgress().then(function(classrooms){vm.classrooms=classrooms})};this.getSubmissions=function(classCode){SubmissionsFactory.getSubmissions(classCode).then(function(data){vm.currentClassroom=classCode,vm.submissions=data.submissions,vm.assignment=data.assignment})},this.exportGrades=function(){SubmissionsFactory.exportGrades().then(function(data){vm.exportedGrades=data.csv})},init()}]).controller("SubmissionController",["$stateParams","$timeout","AssignmentFactory","SubmissionFactory",function($stateParams,$timeout,AssignmentFactory,SubmissionFactory){var vm=this;vm.courseCode=$stateParams.courseCode,vm.assignmentID=$stateParams.assignmentID,vm.submissionID=$stateParams.submissionID,vm.bBackendComputing=!1;var init=function(){SubmissionFactory.setParams(vm.courseCode,vm.assignmentID,vm.submissionID),AssignmentFactory.getAssignmentToGrade(vm.courseCode,vm.assignmentID,vm.submissionID).then(function(assignment){vm.assignment=assignment})};this.saveComment=function(contentType,contentID,text){vm.bBackendComputing=!0,SubmissionFactory.saveComment(contentType,contentID,text).then(function(res){$timeout(function(){vm.bBackendComputing=!1},200)})},this.gradeContent=function(contentType,contentIndex,points){SubmissionFactory.gradeContent(contentType,contentIndex,points)},init()}])}(),function(){"use strict";angular.module("submissions").config(["$stateProvider",function($stateProvider){$stateProvider.state("root.submissions",{url:"/course/:courseCode/assignment/:assignmentID/submission",templateUrl:"/partials/submissions/submissions.html",controller:"SubmissionsController",controllerAs:"submissionsCtrl"}).state("root.submission",{url:"/course/:courseCode/assignment/:assignmentID/submission/:submissionID",templateUrl:"/partials/submissions/submission.html",controller:"SubmissionController",controllerAs:"submissionCtrl"})}])}(),function(){"use strict";angular.module("submissions").factory("SubmissionsFactory",["$http",function($http){function setParams(setCourseCode,setAssignmentID){courseCode=setCourseCode,assignmentID=setAssignmentID}function getClassesWithProgress(){return $http.get("/api/course/"+courseCode+"/assignment/"+assignmentID+"/submission").then(function(res){return res.data})}function getSubmissions(classCode){return currentClassCode=classCode,$http.get("/api/course/"+courseCode+"/assignment/"+assignmentID+"/submission/classroom/"+classCode).then(function(res){return res.data})}function exportGrades(){const exportURL="/api/course/"+courseCode+"/assignment/"+assignmentID+"/submission/classroom/"+currentClassCode+"/export";return $http.get(exportURL).then(function(res){return res.data})}var courseCode="",assignmentID="",currentClassCode="";return{setParams:setParams,getClassesWithProgress:getClassesWithProgress,getSubmissions:getSubmissions,exportGrades:exportGrades}}]).factory("SubmissionFactory",["$http",function($http){function setParams(setCourseCode,setAssignmentID,setSubmissionID){courseCode=setCourseCode,assignmentID=setAssignmentID,submissionID=setSubmissionID}function saveComment(contentType,contentID,text){const comment={contentType:contentType,contentID:contentID,text:text},commentURL="/api/course/"+courseCode+"/assignment/"+assignmentID+"/submission/"+submissionID+"/comment";return $http.put(commentURL,comment).then(function(res){return res.data})}function gradeContent(contentType,contentIndex,points){const grade={contentType:contentType,contentIndex:contentIndex,points:points},commentURL="/api/course/"+courseCode+"/assignment/"+assignmentID+"/submission/"+submissionID+"/grade";return $http.put(commentURL,grade).then(function(res){return res.data})}var courseCode="",assignmentID="",submissionID="";return{setParams:setParams,saveComment:saveComment,gradeContent:gradeContent}}])}(),function(){angular.module("user").controller("LoginController",["$state","$rootScope","AuthService",function($state,$rootScope,AuthService){var vm=this;vm.authMessage="",vm.user={email:"",password:""},this.login=function(){AuthService.login(vm.user).then(function(res){$state.go("root.main")},function(res){vm.authMessage=res.data.userMessages})}}]).controller("LogoutController",["$http","$state","UserInfo",function($http,$state,UserInfo){$http.post("/api/user/logout").then(function(){UserInfo.destroyUser(),$state.go("root.main.public")})}]).controller("JoinController",["$state","$rootScope","AuthService",function($state,$rootScope,AuthService){var vm=this;vm.authMessage="",vm.user={firstName:"",lastName:"",retypePassword:"",password:"",email:"",role:""},this.signup=function(){AuthService.signup(vm.user).then(function(res){$state.go("root.main")},function(res){vm.authMessage=res.data.userMessages})}}]).controller("RegistrationController",["$state","UserFactory",function($state,UserFactory){var vm=this;vm.regInfo={},vm.userMessages="",this.registerForCourse=function(){UserFactory.registerForCourse(vm.regInfo).then(function(res){$state.go("root.course",{courseCode:res.courseCode})},function(res){vm.userMessages=res.data.userMessages})}}]).controller("ProfileController",["$state","UserInfo",function($state,UserInfo){this.user=UserInfo.getUser()}])}(),function(){angular.module("user").directive("registration",function(){return{restrict:"E",templateUrl:"/partials/user/registration.html",controller:"RegistrationController",controllerAs:"registrationCtrl"}})}(),function(){angular.module("user").config(["$stateProvider",function($stateProvider){$stateProvider.state("root.login",{url:"/login",templateUrl:"/partials/user/login.html",data:{bIsPublic:!0},controller:"LoginController",controllerAs:"loginCtrl"}),$stateProvider.state("root.logout",{url:"/logout",controller:"LogoutController"}),$stateProvider.state("root.join",{url:"/join",templateUrl:"/partials/user/join.html",data:{bIsPublic:!0},controller:"JoinController",controllerAs:"joinCtrl"}),$stateProvider.state("root.profile",{url:"/profile",templateUrl:"/partials/user/profile.html",controller:"ProfileController",controllerAs:"profileCtrl"})}])}(),function(){angular.module("user").factory("UserFactory",["$http",function($http){function registerForCourse(regInfo){return $http.put("/api/course/register",regInfo).then(function(res){return res.data},function(res){return res.data})}return{registerForCourse:registerForCourse}}]).factory("AuthService",["$http","UserInfo",function($http,UserInfo){function login(credentials){return $http.post("/auth/local",credentials).then(function(res){return UserInfo.setUser(res.data),res.data})}function signup(newUser){return $http.post("/api/user/join",newUser).then(function(res){return UserInfo.setUser(res.data),res.data})}function retrieveProfile(){$http.get("/api/user").then(function(res){UserInfo.setUser(res.data)},function(res){UserInfo.setUser({})})}function isAuthenticated(){return UserInfo.live()}return{login:login,signup:signup,isAuthenticated:isAuthenticated,retrieveProfile:retrieveProfile}}]).factory("UserInfo",["$rootScope",function($rootScope){function live(){return Object.keys($rootScope.currentUser).length>0}function setUser(user){$rootScope.currentUser=user}function getUser(){return $rootScope.currentUser}function destroyUser(){$rootScope.currentUser={}}return{live:live,setUser:setUser,getUser:getUser,destroyUser:destroyUser}}]).factory("AuthResolver",["$q","$rootScope","$state",function($q,$rootScope,$state){var bIsResolved=!1;return{resolve:function(){var deferred=$q.defer(),unwatch=$rootScope.$watch("currentUser",function(currentUser){angular.isDefined(currentUser)&&(currentUser?deferred.resolve(currentUser):deferred.reject(),bIsResolved=!0,unwatch())});return deferred.promise},bIsResolved:function(){return bIsResolved}}}])}();